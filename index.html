<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>index.utf8</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  { color: #cccccc; background-color: #303030; }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ffcfaf; } /* Alert */
code span.an { color: #7f9f7f; font-weight: bold; } /* Annotation */
code span.at { } /* Attribute */
code span.bn { color: #dca3a3; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #f0dfaf; } /* ControlFlow */
code span.ch { color: #dca3a3; } /* Char */
code span.cn { color: #dca3a3; font-weight: bold; } /* Constant */
code span.co { color: #7f9f7f; } /* Comment */
code span.cv { color: #7f9f7f; font-weight: bold; } /* CommentVar */
code span.do { color: #7f9f7f; } /* Documentation */
code span.dt { color: #dfdfbf; } /* DataType */
code span.dv { color: #dcdccc; } /* DecVal */
code span.er { color: #c3bf9f; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #c0bed1; } /* Float */
code span.fu { color: #efef8f; } /* Function */
code span.im { } /* Import */
code span.in { color: #7f9f7f; font-weight: bold; } /* Information */
code span.kw { color: #f0dfaf; } /* Keyword */
code span.op { color: #f0efd0; } /* Operator */
code span.ot { color: #efef8f; } /* Other */
code span.pp { color: #ffcfaf; font-weight: bold; } /* Preprocessor */
code span.sc { color: #dca3a3; } /* SpecialChar */
code span.ss { color: #cc9393; } /* SpecialString */
code span.st { color: #cc9393; } /* String */
code span.va { } /* Variable */
code span.vs { color: #cc9393; } /* VerbatimString */
code span.wa { color: #7f9f7f; font-weight: bold; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 60px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h2 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h3 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h4 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h5 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h6 {
  padding-top: 65px;
  margin-top: -65px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Pollinator Mediated Interactions of Foundation Plants in the Mojave Desert</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown-header">by Jenna L. Braun</li>
<li>
  <a href="index.html">Home</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">




</div>


<div id="disentangling-the-drivers-and-trade-offs-of-pollinator-mediated-interactions-between-the-foundation-shrub-creosote-bush-larrea-tridentata-and-the-annual-desert-dandelion-malacothrix-glabrata" class="section level1">
<h1>Disentangling the drivers and trade-offs of pollinator-mediated interactions between the foundation shrub Creosote bush (Larrea tridentata) and the annual desert dandelion (Malacothrix glabrata)</h1>

<hr />

<div id="overview" class="section level2">
<h2>Overview</h2>
<p>In arid ecosystems shrub facilitation is a critical process driving plant community structure and assembly, which leads to concentrations of annuals beneath the shrub canopies. Pollinator-mediated interactions have fitness consequences for their participants but are a largely unexplored indirect consequence of shrub-annual facilitation. We tested the capacity of the geographically widespread Creosote bush Larrea tridentata to influence the pollination of its annual understory during its phenological shift into spring flowering. In this system, we found that L. tridentata had a positive ecological effect on annual plant cover, as well as the abundance and richness of the arthropod community but that it also had indirect negative effects on pollinator visitation to a representative flowering annual plant which intensified when L. tridentata bloomed. These finding suggest that the net outcome of association with foundation plant species can be positive or negative depending on both the life-history stage of the protégé species tested and on the phenology of the foundation species. There is the capacity for these trade-offs to be widespread and an increasing focus on further documenting these trade-offs will advance both facilitation theory and assessment of selection processes that can drive co-evolutionary relationships between shrubs, annual plants, and pollinators.</p>

<hr />

<p><img src="Images/site.jpg" width="1000" /></p>
<hr />
<p>#Statistics and modelling</p>
</div>
<div id="pollinator-visitation" class="section level2">
<h2>Pollinator visitation</h2>
<div id="visitation-modelling" class="section level3">
<h3>Visitation modelling</h3>
<p>Hypothesis testing for visitation. GLMM are computationally difficult so workflow is: Base hypothesis model to test for additive vs. interactive effects of predictors. Then add each covariate the best base model. RTU specific responses require a different dataframe so those analyses are done separately. Very full models are not tractable. AllFit.R started throwing an error so moving from lme4 to glmmTMBB. Support for car::Anova in glmmTMB is in the development version.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1">byrep &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;Output Data/byrep_cleaned.csv&quot;</span>)</a>
<a class="sourceLine" id="cb1-2" title="2">byrep<span class="op">$</span>repID &lt;-<span class="st"> </span><span class="kw">paste</span>(byrep<span class="op">$</span>PlantID, byrep<span class="op">$</span>treatment)</a>
<a class="sourceLine" id="cb1-3" title="3">byrep<span class="op">$</span>treatment &lt;-<span class="st"> </span><span class="kw">relevel</span>(byrep<span class="op">$</span>treatment, <span class="st">&quot;open&quot;</span>)</a>
<a class="sourceLine" id="cb1-4" title="4">byrep<span class="op">$</span>flowering &lt;-<span class="st"> </span><span class="kw">relevel</span>(byrep<span class="op">$</span>flowering, <span class="st">&quot;pre&quot;</span>)</a>
<a class="sourceLine" id="cb1-5" title="5"></a>
<a class="sourceLine" id="cb1-6" title="6"><span class="kw">count</span>(byrep, Date)</a></code></pre></div>
<pre><code>## # A tibble: 20 x 2
##    Date          n
##    &lt;fct&gt;     &lt;int&gt;
##  1 4.10.2017    11
##  2 4.11.2017    10
##  3 4.12.2017    12
##  4 4.13.2017    12
##  5 4.14.2017    12
##  6 4.15.2017    12
##  7 4.16.2017    11
##  8 4.18.2017    12
##  9 4.19.2017    12
## 10 4.20.2017    12
## 11 4.21.2017    12
## 12 4.22.2017    12
## 13 4.23.2017    12
## 14 4.25.2017    12
## 15 4.26.2017    12
## 16 4.27.2017    12
## 17 4.29.2017    12
## 18 4.30.2017    12
## 19 5.1.2017     12
## 20 5.2.2017     11</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1">dates &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;Clean Data/dates.csv&quot;</span>)</a>
<a class="sourceLine" id="cb3-2" title="2">dates<span class="op">$</span>Dates &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;</span><span class="ch">\\</span><span class="st">s+&#39;</span>, <span class="st">&quot;&quot;</span>, dates<span class="op">$</span>Dates)</a>
<a class="sourceLine" id="cb3-3" title="3"></a>
<a class="sourceLine" id="cb3-4" title="4"></a>
<a class="sourceLine" id="cb3-5" title="5">dates<span class="op">$</span>Date &lt;-<span class="st"> </span>dates<span class="op">$</span>Dates</a>
<a class="sourceLine" id="cb3-6" title="6">byrep &lt;-<span class="st"> </span><span class="kw">left_join</span>(byrep, dates, <span class="dt">by =</span> <span class="st">&quot;Date&quot;</span>)</a></code></pre></div>
<pre><code>## Warning: Column `Date` joining factor and character vector, coercing into
## character vector</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1"><span class="co">#calculate mean video length</span></a>
<a class="sourceLine" id="cb5-2" title="2"><span class="kw">mean</span>(byrep<span class="op">$</span>dec.Length)</a></code></pre></div>
<pre><code>## [1] 1.324978</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1"><span class="co">#calculate total flower visits and total foraging instances</span></a>
<a class="sourceLine" id="cb7-2" title="2"><span class="kw">sum</span>(byrep<span class="op">$</span>total.flowers)</a></code></pre></div>
<pre><code>## [1] 925</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1"><span class="kw">sum</span>(byrep<span class="op">$</span>total.visits)</a></code></pre></div>
<pre><code>## [1] 697</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1"><span class="co">#should be 925 and 697 - not 930 and 701.</span></a></code></pre></div>
<p>Flower visits</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1"><span class="co">#base hypothesis testing model</span></a>
<a class="sourceLine" id="cb12-2" title="2"><span class="co">#additive</span></a>
<a class="sourceLine" id="cb12-3" title="3">m1 &lt;-<span class="st"> </span><span class="kw">glmmTMB</span>(total.flowers <span class="op">~</span><span class="st"> </span>treatment <span class="op">+</span><span class="st"> </span>flowering <span class="op">+</span><span class="st"> </span>flowers.pot <span class="op">+</span><span class="st">  </span><span class="kw">offset</span>(<span class="kw">log</span>(dec.Length)) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>PlantID<span class="op">/</span>repID), <span class="dt">family =</span> <span class="st">&quot;nbinom2&quot;</span>, <span class="dt">data =</span> byrep)</a>
<a class="sourceLine" id="cb12-4" title="4"><span class="kw">summary</span>(m1)</a></code></pre></div>
<pre><code>##  Family: nbinom2  ( log )
## Formula:          
## total.flowers ~ treatment + flowering + flowers.pot + offset(log(dec.Length)) +  
##     (1 | PlantID/repID)
## Data: byrep
## 
##      AIC      BIC   logLik deviance df.resid 
##   1113.4   1137.6   -549.7   1099.4      228 
## 
## Random effects:
## 
## Conditional model:
##  Groups        Name        Variance Std.Dev.
##  repID:PlantID (Intercept) 0.110000 0.33166 
##  PlantID       (Intercept) 0.004306 0.06562 
## Number of obs: 235, groups:  repID:PlantID, 122; PlantID, 61
## 
## Overdispersion parameter for nbinom2 family (): 1.03 
## 
## Conditional model:
##                Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)     0.99231    0.29018   3.420 0.000627 ***
## treatmentshrub -0.35025    0.16645  -2.104 0.035355 *  
## floweringbloom -1.25518    0.16064  -7.813 5.56e-15 ***
## flowers.pot     0.06996    0.02673   2.617 0.008863 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1">car<span class="op">::</span><span class="kw">Anova</span>(m1, <span class="dt">type =</span> <span class="dv">2</span>)</a></code></pre></div>
<pre><code>## Analysis of Deviance Table (Type II Wald chisquare tests)
## 
## Response: total.flowers
##               Chisq Df Pr(&gt;Chisq)    
## treatment    4.4279  1   0.035355 *  
## flowering   61.0499  1  5.565e-15 ***
## flowers.pot  6.8503  1   0.008863 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1"><span class="co">#interactive model</span></a>
<a class="sourceLine" id="cb16-2" title="2"></a>
<a class="sourceLine" id="cb16-3" title="3">m2 &lt;-<span class="st"> </span><span class="kw">glmmTMB</span>(total.flowers <span class="op">~</span><span class="st"> </span>treatment <span class="op">*</span><span class="st"> </span>flowering <span class="op">+</span><span class="st"> </span>flowers.pot <span class="op">+</span><span class="st"> </span><span class="kw">offset</span>(<span class="kw">log</span>(dec.Length)) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>PlantID<span class="op">/</span>repID),  <span class="dt">family =</span> <span class="st">&quot;nbinom2&quot;</span>, <span class="dt">data =</span> byrep)</a>
<a class="sourceLine" id="cb16-4" title="4"><span class="kw">summary</span>(m2)</a></code></pre></div>
<pre><code>##  Family: nbinom2  ( log )
## Formula:          
## total.flowers ~ treatment * flowering + flowers.pot + offset(log(dec.Length)) +  
##     (1 | PlantID/repID)
## Data: byrep
## 
##      AIC      BIC   logLik deviance df.resid 
##   1115.4   1143.1   -549.7   1099.4      227 
## 
## Random effects:
## 
## Conditional model:
##  Groups        Name        Variance Std.Dev.
##  repID:PlantID (Intercept) 0.108109 0.32880 
##  PlantID       (Intercept) 0.004266 0.06532 
## Number of obs: 235, groups:  repID:PlantID, 122; PlantID, 61
## 
## Overdispersion parameter for nbinom2 family (): 1.03 
## 
## Conditional model:
##                               Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)                    1.00441    0.29943   3.354 0.000795 ***
## treatmentshrub                -0.37402    0.22030  -1.698 0.089545 .  
## floweringbloom                -1.27992    0.22004  -5.817    6e-09 ***
## flowers.pot                    0.06998    0.02672   2.619 0.008827 ** 
## treatmentshrub:floweringbloom  0.05182    0.31469   0.165 0.869195    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1">car<span class="op">::</span><span class="kw">Anova</span>(m2, <span class="dt">type =</span><span class="dv">3</span>)</a></code></pre></div>
<pre><code>## Analysis of Deviance Table (Type III Wald chisquare tests)
## 
## Response: total.flowers
##                       Chisq Df Pr(&gt;Chisq)    
## (Intercept)         11.2521  1  0.0007953 ***
## treatment            2.8825  1  0.0895451 .  
## flowering           33.8337  1  6.003e-09 ***
## flowers.pot          6.8575  1  0.0088268 ** 
## treatment:flowering  0.0271  1  0.8691947    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" title="1">null &lt;-<span class="st"> </span><span class="kw">glmmTMB</span>(total.flowers <span class="op">~</span><span class="st"> </span>flowers.pot <span class="op">+</span><span class="st"> </span><span class="kw">offset</span>(<span class="kw">log</span>(dec.Length)) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>PlantID<span class="op">/</span>repID),  <span class="dt">family =</span> <span class="st">&quot;nbinom2&quot;</span>, <span class="dt">data =</span> byrep)</a>
<a class="sourceLine" id="cb20-2" title="2"><span class="kw">summary</span>(null)</a></code></pre></div>
<pre><code>##  Family: nbinom2  ( log )
## Formula:          
## total.flowers ~ flowers.pot + offset(log(dec.Length)) + (1 |  
##     PlantID/repID)
## Data: byrep
## 
##      AIC      BIC   logLik deviance df.resid 
##   1166.2   1183.5   -578.1   1156.2      230 
## 
## Random effects:
## 
## Conditional model:
##  Groups        Name        Variance Std.Dev.
##  repID:PlantID (Intercept) 0.06257  0.2501  
##  PlantID       (Intercept) 0.05976  0.2445  
## Number of obs: 235, groups:  repID:PlantID, 122; PlantID, 61
## 
## Overdispersion parameter for nbinom2 family (): 0.705 
## 
## Conditional model:
##             Estimate Std. Error z value Pr(&gt;|z|)  
## (Intercept)  0.79243    0.31602   2.507   0.0122 *
## flowers.pot  0.02672    0.03001   0.890   0.3733  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" title="1"><span class="kw">anova</span>(null, m1,m2)</a></code></pre></div>
<pre><code>## Data: byrep
## Models:
## null: total.flowers ~ flowers.pot + offset(log(dec.Length)) + (1 | , zi=~0, disp=~1
## null:     PlantID/repID), zi=~0, disp=~1
## m1: total.flowers ~ treatment + flowering + flowers.pot + offset(log(dec.Length)) + , zi=~0, disp=~1
## m1:     (1 | PlantID/repID), zi=~0, disp=~1
## m2: total.flowers ~ treatment * flowering + flowers.pot + offset(log(dec.Length)) + , zi=~0, disp=~1
## m2:     (1 | PlantID/repID), zi=~0, disp=~1
##      Df    AIC    BIC  logLik deviance   Chisq Chi Df Pr(&gt;Chisq)    
## null  5 1166.2 1183.5 -578.12   1156.2                              
## m1    7 1113.4 1137.6 -549.71   1099.4 56.8240      2   4.58e-13 ***
## m2    8 1115.4 1143.1 -549.69   1099.4  0.0271      1     0.8692    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" title="1"><span class="kw">AIC</span>(m1,m2, null)</a></code></pre></div>
<pre><code>##      df      AIC
## m1    7 1113.413
## m2    8 1115.385
## null  5 1166.237</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" title="1">car<span class="op">::</span><span class="kw">Anova</span>(m2, <span class="dt">type =</span> <span class="dv">3</span>)</a></code></pre></div>
<pre><code>## Analysis of Deviance Table (Type III Wald chisquare tests)
## 
## Response: total.flowers
##                       Chisq Df Pr(&gt;Chisq)    
## (Intercept)         11.2521  1  0.0007953 ***
## treatment            2.8825  1  0.0895451 .  
## flowering           33.8337  1  6.003e-09 ***
## flowers.pot          6.8575  1  0.0088268 ** 
## treatment:flowering  0.0271  1  0.8691947    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" title="1"><span class="co">#model 1 is best fit</span></a></code></pre></div>
<p>Foraging bouts</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" title="1"><span class="co">#base additive model foraging instances</span></a>
<a class="sourceLine" id="cb29-2" title="2">m3 &lt;-<span class="st"> </span><span class="kw">glmmTMB</span>(total.visits <span class="op">~</span><span class="st"> </span>treatment <span class="op">+</span><span class="st"> </span>flowering <span class="op">+</span><span class="st"> </span>flowers.pot <span class="op">+</span><span class="st"> </span><span class="kw">offset</span>(<span class="kw">log</span>(dec.Length)) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>PlantID<span class="op">/</span>repID), <span class="dt">family =</span> <span class="st">&quot;nbinom2&quot;</span>, <span class="dt">data =</span> byrep)</a>
<a class="sourceLine" id="cb29-3" title="3"><span class="kw">summary</span>(m3)</a></code></pre></div>
<pre><code>##  Family: nbinom2  ( log )
## Formula:          
## total.visits ~ treatment + flowering + flowers.pot + offset(log(dec.Length)) +  
##     (1 | PlantID/repID)
## Data: byrep
## 
##      AIC      BIC   logLik deviance df.resid 
##   1002.7   1026.9   -494.4    988.7      228 
## 
## Random effects:
## 
## Conditional model:
##  Groups        Name        Variance Std.Dev.
##  repID:PlantID (Intercept) 0.040467 0.20116 
##  PlantID       (Intercept) 0.003019 0.05494 
## Number of obs: 235, groups:  repID:PlantID, 122; PlantID, 61
## 
## Overdispersion parameter for nbinom2 family (): 1.48 
## 
## Conditional model:
##                Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)     0.96727    0.25574   3.782 0.000155 ***
## treatmentshrub -0.32815    0.14465  -2.269 0.023291 *  
## floweringbloom -1.25617    0.14375  -8.739  &lt; 2e-16 ***
## flowers.pot     0.04755    0.02355   2.020 0.043428 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" title="1">car<span class="op">::</span><span class="kw">Anova</span>(m3, <span class="dt">type =</span> <span class="dv">2</span>)</a></code></pre></div>
<pre><code>## Analysis of Deviance Table (Type II Wald chisquare tests)
## 
## Response: total.visits
##               Chisq Df Pr(&gt;Chisq)    
## treatment    5.1467  1    0.02329 *  
## flowering   76.3670  1    &lt; 2e-16 ***
## flowers.pot  4.0786  1    0.04343 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" title="1"><span class="co">#base interactive model</span></a>
<a class="sourceLine" id="cb33-2" title="2">m5 &lt;-<span class="st"> </span><span class="kw">glmmTMB</span>(total.visits <span class="op">~</span><span class="st"> </span>treatment <span class="op">*</span><span class="st"> </span>flowering <span class="op">+</span><span class="st"> </span>flowers.pot <span class="op">+</span><span class="st"> </span><span class="kw">offset</span>(<span class="kw">log</span>(dec.Length)) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>PlantID<span class="op">/</span>repID), <span class="dt">family =</span> <span class="st">&quot;nbinom2&quot;</span>, <span class="dt">data =</span> byrep)</a>
<a class="sourceLine" id="cb33-3" title="3"><span class="kw">summary</span>(m5)</a></code></pre></div>
<pre><code>##  Family: nbinom2  ( log )
## Formula:          
## total.visits ~ treatment * flowering + flowers.pot + offset(log(dec.Length)) +  
##     (1 | PlantID/repID)
## Data: byrep
## 
##      AIC      BIC   logLik deviance df.resid 
##   1004.7   1032.4   -494.3    988.7      227 
## 
## Random effects:
## 
## Conditional model:
##  Groups        Name        Variance Std.Dev.
##  repID:PlantID (Intercept) 0.039793 0.19948 
##  PlantID       (Intercept) 0.003084 0.05553 
## Number of obs: 235, groups:  repID:PlantID, 122; PlantID, 61
## 
## Overdispersion parameter for nbinom2 family (): 1.48 
## 
## Conditional model:
##                               Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)                    0.97525    0.26300   3.708 0.000209 ***
## treatmentshrub                -0.34374    0.18748  -1.834 0.066723 .  
## floweringbloom                -1.27358    0.19604  -6.496 8.22e-11 ***
## flowers.pot                    0.04753    0.02355   2.019 0.043519 *  
## treatmentshrub:floweringbloom  0.03685    0.28178   0.131 0.895960    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" title="1">car<span class="op">::</span><span class="kw">Anova</span>(m5, <span class="dt">type =</span> <span class="dv">3</span>)</a></code></pre></div>
<pre><code>## Analysis of Deviance Table (Type III Wald chisquare tests)
## 
## Response: total.visits
##                       Chisq Df Pr(&gt;Chisq)    
## (Intercept)         13.7509  1  0.0002087 ***
## treatment            3.3619  1  0.0667227 .  
## flowering           42.2045  1  8.221e-11 ***
## flowers.pot          4.0751  1  0.0435193 *  
## treatment:flowering  0.0171  1  0.8959596    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" title="1"><span class="co">#null model</span></a>
<a class="sourceLine" id="cb37-2" title="2">null &lt;-<span class="st"> </span><span class="kw">glmmTMB</span>(total.visits <span class="op">~</span><span class="st"> </span>flowers.pot <span class="op">+</span><span class="st"> </span><span class="kw">offset</span>(<span class="kw">log</span>(dec.Length)) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>PlantID<span class="op">/</span>repID), <span class="dt">family =</span> <span class="st">&quot;nbinom2&quot;</span>, <span class="dt">data =</span> byrep)</a>
<a class="sourceLine" id="cb37-3" title="3"></a>
<a class="sourceLine" id="cb37-4" title="4"></a>
<a class="sourceLine" id="cb37-5" title="5"><span class="kw">anova</span>(null, m3,m5)</a></code></pre></div>
<pre><code>## Data: byrep
## Models:
## null: total.visits ~ flowers.pot + offset(log(dec.Length)) + (1 | PlantID/repID), zi=~0, disp=~1
## m3: total.visits ~ treatment + flowering + flowers.pot + offset(log(dec.Length)) + , zi=~0, disp=~1
## m3:     (1 | PlantID/repID), zi=~0, disp=~1
## m5: total.visits ~ treatment * flowering + flowers.pot + offset(log(dec.Length)) + , zi=~0, disp=~1
## m5:     (1 | PlantID/repID), zi=~0, disp=~1
##      Df    AIC    BIC  logLik deviance   Chisq Chi Df Pr(&gt;Chisq)    
## null  5 1067.8 1085.1 -528.90  1057.80                              
## m3    7 1002.7 1026.9 -494.35   988.70 69.0982      2  9.897e-16 ***
## m5    8 1004.7 1032.4 -494.34   988.69  0.0171      1     0.8959    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" title="1"><span class="kw">AIC</span>(m3, m5, null)</a></code></pre></div>
<pre><code>##      df      AIC
## m3    7 1002.703
## m5    8 1004.686
## null  5 1067.801</code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" title="1"><span class="kw">ggplot</span>(byrep, <span class="kw">aes</span>(flowering, flowers.per.hour)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_boxplot</span>() <span class="op">+</span><span class="st"> </span><span class="kw">facet_grid</span>(<span class="op">~</span>treatment)</a></code></pre></div>
<p><img src="index_files/figure-html/visitation%20models%20(foraging)-1.png" width="672" /> ###Testing importance of covariates using TMB because glmer will not coverge.</p>
<p>Annual floral density</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" title="1">c2 &lt;-<span class="st"> </span><span class="kw">glmmTMB</span>(total.visits <span class="op">~</span><span class="st"> </span>treatment <span class="op">*</span><span class="st"> </span>flowering <span class="op">+</span><span class="st"> </span>flowers.pot <span class="op">+</span><span class="st"> </span>het.annual.floral.density <span class="op">+</span><span class="st"> </span>het.shrub.blooming.neighbours <span class="op">+</span><span class="st"> </span><span class="kw">offset</span>(<span class="kw">log</span>(dec.Length)) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>PlantID<span class="op">/</span>repID), <span class="dt">family =</span> <span class="kw">nbinom2</span>(<span class="dt">link =</span> <span class="st">&quot;log&quot;</span>), <span class="dt">data =</span> byrep)</a>
<a class="sourceLine" id="cb42-2" title="2"><span class="kw">summary</span>(c2)</a></code></pre></div>
<pre><code>##  Family: nbinom2  ( log )
## Formula:          
## total.visits ~ treatment * flowering + flowers.pot + het.annual.floral.density +  
##     het.shrub.blooming.neighbours + offset(log(dec.Length)) +  
##     (1 | PlantID/repID)
## Data: byrep
## 
##      AIC      BIC   logLik deviance df.resid 
##    987.7   1022.1   -483.8    967.7      221 
## 
## Random effects:
## 
## Conditional model:
##  Groups        Name        Variance Std.Dev.
##  repID:PlantID (Intercept) 0.05936  0.24363 
##  PlantID       (Intercept) 0.00229  0.04785 
## Number of obs: 231, groups:  repID:PlantID, 122; PlantID, 61
## 
## Overdispersion parameter for nbinom2 family (): 1.62 
## 
## Conditional model:
##                               Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)                    0.79991    0.26915   2.972  0.00296 ** 
## treatmentshrub                -0.35523    0.18596  -1.910  0.05610 .  
## floweringbloom                -1.18660    0.20485  -5.792 6.94e-09 ***
## flowers.pot                    0.05948    0.02374   2.506  0.01221 *  
## het.annual.floral.density      0.04136    0.01986   2.082  0.03730 *  
## het.shrub.blooming.neighbours -0.03560    0.03825  -0.931  0.35205    
## treatmentshrub:floweringbloom  0.08055    0.28402   0.284  0.77672    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb44-1" title="1">car<span class="op">::</span><span class="kw">Anova</span>(c2, <span class="dt">type =</span> <span class="dv">3</span>)</a></code></pre></div>
<pre><code>## Analysis of Deviance Table (Type III Wald chisquare tests)
## 
## Response: total.visits
##                                 Chisq Df Pr(&gt;Chisq)    
## (Intercept)                    8.8330  1   0.002958 ** 
## treatment                      3.6490  1   0.056103 .  
## flowering                     33.5521  1  6.938e-09 ***
## flowers.pot                    6.2802  1   0.012209 *  
## het.annual.floral.density      4.3366  1   0.037301 *  
## het.shrub.blooming.neighbours  0.8661  1   0.352046    
## treatment:flowering            0.0804  1   0.776719    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" title="1">c2.v &lt;-<span class="st"> </span><span class="kw">glmmTMB</span>(total.visits <span class="op">~</span><span class="st"> </span>treatment <span class="op">+</span><span class="st"> </span>flowering <span class="op">+</span><span class="st"> </span>het.annual.floral.density <span class="op">+</span><span class="st"> </span>flowers.pot <span class="op">+</span><span class="st"> </span><span class="kw">offset</span>(<span class="kw">log</span>(dec.Length)) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>PlantID<span class="op">/</span>repID), <span class="dt">family =</span> <span class="kw">nbinom2</span>(<span class="dt">link =</span> <span class="st">&quot;log&quot;</span>), <span class="dt">data =</span> byrep)</a>
<a class="sourceLine" id="cb46-2" title="2"><span class="kw">summary</span>(c2.v)</a></code></pre></div>
<pre><code>##  Family: nbinom2  ( log )
## Formula:          
## total.visits ~ treatment + flowering + het.annual.floral.density +  
##     flowers.pot + offset(log(dec.Length)) + (1 | PlantID/repID)
## Data: byrep
## 
##      AIC      BIC   logLik deviance df.resid 
##    984.6   1012.1   -484.3    968.6      223 
## 
## Random effects:
## 
## Conditional model:
##  Groups        Name        Variance Std.Dev.
##  repID:PlantID (Intercept) 0.04899  0.2213  
##  PlantID       (Intercept) 0.01753  0.1324  
## Number of obs: 231, groups:  repID:PlantID, 122; PlantID, 61
## 
## Overdispersion parameter for nbinom2 family (): 1.62 
## 
## Conditional model:
##                           Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)                0.78251    0.26356   2.969  0.00299 ** 
## treatmentshrub            -0.34480    0.14425  -2.390  0.01684 *  
## floweringbloom            -1.22826    0.14485  -8.479  &lt; 2e-16 ***
## het.annual.floral.density  0.04069    0.01984   2.051  0.04029 *  
## flowers.pot                0.05863    0.02389   2.455  0.01410 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" title="1">car<span class="op">::</span><span class="kw">Anova</span>(c2.v, <span class="dt">type =</span> <span class="dv">2</span>)</a></code></pre></div>
<pre><code>## Analysis of Deviance Table (Type II Wald chisquare tests)
## 
## Response: total.visits
##                             Chisq Df Pr(&gt;Chisq)    
## treatment                  5.7134  1    0.01684 *  
## flowering                 71.9003  1    &lt; 2e-16 ***
## het.annual.floral.density  4.2057  1    0.04029 *  
## flowers.pot                6.0255  1    0.01410 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" title="1">q &lt;-<span class="st"> </span><span class="kw">glmmTMB</span>(total.visits <span class="op">~</span><span class="st"> </span>treatment <span class="op">+</span><span class="st"> </span>flowering <span class="op">+</span><span class="st"> </span>flowers.pot <span class="op">+</span><span class="st"> </span>het.annual.floral.density <span class="op">+</span><span class="st"> </span><span class="kw">offset</span>(<span class="kw">log</span>(dec.Length)) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>PlantID<span class="op">/</span>repID), <span class="dt">family =</span> <span class="kw">nbinom1</span>(<span class="dt">link =</span> <span class="st">&quot;log&quot;</span>), <span class="dt">data =</span> byrep)</a>
<a class="sourceLine" id="cb50-2" title="2">car<span class="op">::</span><span class="kw">Anova</span>(q, <span class="dt">type =</span> <span class="dv">2</span>)</a></code></pre></div>
<pre><code>## Analysis of Deviance Table (Type II Wald chisquare tests)
## 
## Response: total.visits
##                             Chisq Df Pr(&gt;Chisq)    
## treatment                  2.3549  1    0.12489    
## flowering                 53.4209  1  2.692e-13 ***
## flowers.pot                6.2274  1    0.01258 *  
## het.annual.floral.density  9.5405  1    0.00201 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb52-1" title="1"><span class="kw">AIC</span>(c2.v, q)</a></code></pre></div>
<pre><code>##      df      AIC
## c2.v  8 984.5580
## q     8 990.3342</code></pre>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb54-1" title="1"><span class="co">#nbinom2 better</span></a>
<a class="sourceLine" id="cb54-2" title="2"></a>
<a class="sourceLine" id="cb54-3" title="3"><span class="co">#flowers</span></a>
<a class="sourceLine" id="cb54-4" title="4">c2.f &lt;-<span class="st"> </span><span class="kw">glmmTMB</span>(total.flowers <span class="op">~</span><span class="st"> </span>treatment <span class="op">*</span><span class="st"> </span>flowering <span class="op">+</span><span class="st"> </span>het.annual.floral.density <span class="op">+</span><span class="st"> </span>flowers.pot <span class="op">+</span><span class="st"> </span><span class="kw">offset</span>(<span class="kw">log</span>(dec.Length)) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>PlantID<span class="op">/</span>repID), <span class="dt">family =</span> <span class="kw">nbinom2</span>(<span class="dt">link =</span> <span class="st">&quot;log&quot;</span>), <span class="dt">data =</span> byrep)</a>
<a class="sourceLine" id="cb54-5" title="5"><span class="kw">summary</span>(c2.f)</a></code></pre></div>
<pre><code>##  Family: nbinom2  ( log )
## Formula:          
## total.flowers ~ treatment * flowering + het.annual.floral.density +  
##     flowers.pot + offset(log(dec.Length)) + (1 | PlantID/repID)
## Data: byrep
## 
##      AIC      BIC   logLik deviance df.resid 
##   1097.7   1128.7   -539.9   1079.7      222 
## 
## Random effects:
## 
## Conditional model:
##  Groups        Name        Variance Std.Dev.
##  repID:PlantID (Intercept) 0.120279 0.34681 
##  PlantID       (Intercept) 0.009982 0.09991 
## Number of obs: 231, groups:  repID:PlantID, 122; PlantID, 61
## 
## Overdispersion parameter for nbinom2 family (): 1.08 
## 
## Conditional model:
##                               Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)                    0.83530    0.30654   2.725  0.00643 ** 
## treatmentshrub                -0.39868    0.21963  -1.815  0.06949 .  
## floweringbloom                -1.24944    0.22058  -5.664 1.48e-08 ***
## het.annual.floral.density      0.04004    0.02339   1.712  0.08691 .  
## flowers.pot                    0.08036    0.02713   2.961  0.00306 ** 
## treatmentshrub:floweringbloom  0.04730    0.31517   0.150  0.88071    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb56-1" title="1">car<span class="op">::</span><span class="kw">Anova</span>(c2.f, <span class="dt">type =</span> <span class="dv">3</span>)</a></code></pre></div>
<pre><code>## Analysis of Deviance Table (Type III Wald chisquare tests)
## 
## Response: total.flowers
##                             Chisq Df Pr(&gt;Chisq)    
## (Intercept)                7.4252  1   0.006432 ** 
## treatment                  3.2950  1   0.069491 .  
## flowering                 32.0858  1  1.475e-08 ***
## het.annual.floral.density  2.9306  1   0.086913 .  
## flowers.pot                8.7695  1   0.003063 ** 
## treatment:flowering        0.0225  1   0.880707    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb58-1" title="1">c2.flowers &lt;-<span class="st"> </span><span class="kw">glmmTMB</span>(total.flowers <span class="op">~</span><span class="st"> </span>treatment <span class="op">+</span><span class="st"> </span>flowering <span class="op">+</span><span class="st"> </span>flowers.pot <span class="op">+</span><span class="st"> </span>het.annual.floral.density <span class="op">+</span><span class="st"> </span><span class="kw">offset</span>(<span class="kw">log</span>(dec.Length)) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>PlantID<span class="op">/</span>repID), <span class="dt">family =</span> <span class="kw">nbinom2</span>(<span class="dt">link =</span> <span class="st">&quot;log&quot;</span>), <span class="dt">data =</span> byrep)</a>
<a class="sourceLine" id="cb58-2" title="2"><span class="kw">summary</span>(c2.flowers)</a></code></pre></div>
<pre><code>##  Family: nbinom2  ( log )
## Formula:          
## total.flowers ~ treatment + flowering + flowers.pot + het.annual.floral.density +  
##     offset(log(dec.Length)) + (1 | PlantID/repID)
## Data: byrep
## 
##      AIC      BIC   logLik deviance df.resid 
##   1095.7   1123.3   -539.9   1079.7      223 
## 
## Random effects:
## 
## Conditional model:
##  Groups        Name        Variance Std.Dev.
##  repID:PlantID (Intercept) 0.12228  0.34969 
##  PlantID       (Intercept) 0.00987  0.09935 
## Number of obs: 231, groups:  repID:PlantID, 122; PlantID, 61
## 
## Overdispersion parameter for nbinom2 family (): 1.09 
## 
## Conditional model:
##                           Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)                0.82490    0.29852   2.763  0.00572 ** 
## treatmentshrub            -0.37733    0.16732  -2.255  0.02412 *  
## floweringbloom            -1.22713    0.16283  -7.536 4.84e-14 ***
## flowers.pot                0.08032    0.02714   2.960  0.00308 ** 
## het.annual.floral.density  0.03984    0.02334   1.707  0.08789 .  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb60-1" title="1">car<span class="op">::</span><span class="kw">Anova</span>(c2.flowers, <span class="dt">type =</span> <span class="dv">2</span>)</a></code></pre></div>
<pre><code>## Analysis of Deviance Table (Type II Wald chisquare tests)
## 
## Response: total.flowers
##                             Chisq Df Pr(&gt;Chisq)    
## treatment                  5.0857  1    0.02412 *  
## flowering                 56.7922  1  4.844e-14 ***
## flowers.pot                8.7595  1    0.00308 ** 
## het.annual.floral.density  2.9125  1    0.08789 .  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Number of blooming shrub neighbours</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb62-1" title="1">c3 &lt;-<span class="st"> </span><span class="kw">glmmTMB</span>(total.flowers <span class="op">~</span><span class="st"> </span>treatment <span class="op">+</span><span class="st"> </span>flowering <span class="op">+</span><span class="st"> </span>flowers.pot <span class="op">+</span><span class="st"> </span>het.shrub.blooming.neighbours <span class="op">+</span><span class="st"> </span><span class="kw">offset</span>(<span class="kw">log</span>(dec.Length)) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>PlantID<span class="op">/</span>repID), <span class="dt">family =</span> <span class="st">&quot;nbinom2&quot;</span>, <span class="dt">data =</span> byrep)</a>
<a class="sourceLine" id="cb62-2" title="2"><span class="kw">summary</span>(c3)</a></code></pre></div>
<pre><code>##  Family: nbinom2  ( log )
## Formula:          
## total.flowers ~ treatment + flowering + flowers.pot + het.shrub.blooming.neighbours +  
##     offset(log(dec.Length)) + (1 | PlantID/repID)
## Data: byrep
## 
##      AIC      BIC   logLik deviance df.resid 
##   1097.5   1125.1   -540.8   1081.5      223 
## 
## Random effects:
## 
## Conditional model:
##  Groups        Name        Variance  Std.Dev. 
##  repID:PlantID (Intercept) 1.183e-01 0.3440086
##  PlantID       (Intercept) 2.552e-08 0.0001598
## Number of obs: 231, groups:  repID:PlantID, 122; PlantID, 61
## 
## Overdispersion parameter for nbinom2 family (): 1.06 
## 
## Conditional model:
##                               Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)                    0.94775    0.29061   3.261  0.00111 ** 
## treatmentshrub                -0.32888    0.16998  -1.935  0.05301 .  
## floweringbloom                -1.16615    0.18601  -6.269 3.63e-10 ***
## flowers.pot                    0.07598    0.02703   2.811  0.00494 ** 
## het.shrub.blooming.neighbours -0.04940    0.04093  -1.207  0.22744    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb64-1" title="1">car<span class="op">::</span><span class="kw">Anova</span>(c3, <span class="dt">type =</span> <span class="dv">2</span>)</a></code></pre></div>
<pre><code>## Analysis of Deviance Table (Type II Wald chisquare tests)
## 
## Response: total.flowers
##                                 Chisq Df Pr(&gt;Chisq)    
## treatment                      3.7437  1   0.053008 .  
## flowering                     39.3038  1  3.627e-10 ***
## flowers.pot                    7.9027  1   0.004936 ** 
## het.shrub.blooming.neighbours  1.4568  1   0.227438    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb66-1" title="1">c2.v &lt;-<span class="st"> </span><span class="kw">glmmTMB</span>(total.visits <span class="op">~</span><span class="st"> </span>treatment <span class="op">+</span><span class="st"> </span>flowering <span class="op">+</span><span class="st"> </span>flowers.pot <span class="op">+</span><span class="st"> </span>het.shrub.blooming.neighbours <span class="op">+</span><span class="st"> </span><span class="kw">offset</span>(<span class="kw">log</span>(dec.Length)) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>PlantID<span class="op">/</span>repID), <span class="dt">family =</span> <span class="st">&quot;nbinom2&quot;</span>, <span class="dt">data =</span> byrep)</a>
<a class="sourceLine" id="cb66-2" title="2"><span class="kw">summary</span>(c2.v)</a></code></pre></div>
<pre><code>##  Family: nbinom2  ( log )
## Formula:          
## total.visits ~ treatment + flowering + flowers.pot + het.shrub.blooming.neighbours +  
##     offset(log(dec.Length)) + (1 | PlantID/repID)
## Data: byrep
## 
##      AIC      BIC   logLik deviance df.resid 
##    988.5   1016.0   -486.2    972.5      223 
## 
## Random effects:
## 
## Conditional model:
##  Groups        Name        Variance  Std.Dev. 
##  repID:PlantID (Intercept) 5.570e-02 0.2360056
##  PlantID       (Intercept) 8.077e-08 0.0002842
## Number of obs: 231, groups:  repID:PlantID, 122; PlantID, 61
## 
## Overdispersion parameter for nbinom2 family (): 1.53 
## 
## Conditional model:
##                               Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)                    0.92071    0.25682   3.585 0.000337 ***
## treatmentshrub                -0.31539    0.14829  -2.127 0.033434 *  
## floweringbloom                -1.20875    0.16707  -7.235 4.66e-13 ***
## flowers.pot                    0.05296    0.02376   2.229 0.025799 *  
## het.shrub.blooming.neighbours -0.03124    0.03744  -0.835 0.403996    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb68-1" title="1">car<span class="op">::</span><span class="kw">Anova</span>(c2.v)</a></code></pre></div>
<pre><code>## Analysis of Deviance Table (Type II Wald chisquare tests)
## 
## Response: total.visits
##                                 Chisq Df Pr(&gt;Chisq)    
## treatment                      4.5234  1    0.03343 *  
## flowering                     52.3453  1  4.655e-13 ***
## flowers.pot                    4.9695  1    0.02580 *  
## het.shrub.blooming.neighbours  0.6964  1    0.40400    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb70-1" title="1"><span class="co">#each model with both covariates added</span></a>
<a class="sourceLine" id="cb70-2" title="2">c.visits &lt;-<span class="st"> </span><span class="kw">glmmTMB</span>(total.visits <span class="op">~</span><span class="st"> </span>treatment <span class="op">+</span><span class="st"> </span>flowering <span class="op">+</span><span class="st"> </span>flowers.pot <span class="op">+</span><span class="st"> </span>het.annual.floral.density <span class="op">+</span><span class="st"> </span>het.shrub.blooming.neighbours <span class="op">+</span><span class="st">  </span><span class="kw">offset</span>(<span class="kw">log</span>(dec.Length)) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>PlantID<span class="op">/</span>repID), <span class="dt">family =</span> <span class="st">&quot;nbinom2&quot;</span>, <span class="dt">data =</span> byrep)</a>
<a class="sourceLine" id="cb70-3" title="3"><span class="kw">summary</span>(c.visits)</a></code></pre></div>
<pre><code>##  Family: nbinom2  ( log )
## Formula:          
## total.visits ~ treatment + flowering + flowers.pot + het.annual.floral.density +  
##     het.shrub.blooming.neighbours + offset(log(dec.Length)) +  
##     (1 | PlantID/repID)
## Data: byrep
## 
##      AIC      BIC   logLik deviance df.resid 
##    985.8   1016.7   -483.9    967.8      222 
## 
## Random effects:
## 
## Conditional model:
##  Groups        Name        Variance Std.Dev.
##  repID:PlantID (Intercept) 0.060672 0.24632 
##  PlantID       (Intercept) 0.002709 0.05205 
## Number of obs: 231, groups:  repID:PlantID, 122; PlantID, 61
## 
## Overdispersion parameter for nbinom2 family (): 1.62 
## 
## Conditional model:
##                               Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)                    0.78353    0.26268   2.983  0.00286 ** 
## treatmentshrub                -0.32315    0.14741  -2.192  0.02837 *  
## floweringbloom                -1.15297    0.16688  -6.909 4.88e-12 ***
## flowers.pot                    0.05945    0.02374   2.504  0.01227 *  
## het.annual.floral.density      0.04108    0.01982   2.072  0.03823 *  
## het.shrub.blooming.neighbours -0.03383    0.03778  -0.895  0.37055    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb72-1" title="1">car<span class="op">::</span><span class="kw">Anova</span>(c.visits, <span class="dt">type =</span> <span class="dv">2</span>)</a></code></pre></div>
<pre><code>## Analysis of Deviance Table (Type II Wald chisquare tests)
## 
## Response: total.visits
##                                 Chisq Df Pr(&gt;Chisq)    
## treatment                      4.8054  1    0.02837 *  
## flowering                     47.7336  1  4.882e-12 ***
## flowers.pot                    6.2713  1    0.01227 *  
## het.annual.floral.density      4.2948  1    0.03823 *  
## het.shrub.blooming.neighbours  0.8018  1    0.37055    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb74-1" title="1">c.flowers &lt;-<span class="st"> </span><span class="kw">glmmTMB</span>(total.flowers <span class="op">~</span><span class="st"> </span>treatment <span class="op">*</span><span class="st"> </span>flowering <span class="op">+</span><span class="st"> </span>flowers.pot <span class="op">+</span><span class="st"> </span>het.annual.floral.density <span class="op">+</span><span class="st"> </span>het.shrub.blooming.neighbours <span class="op">+</span><span class="st">  </span><span class="kw">offset</span>(<span class="kw">log</span>(dec.Length)) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>PlantID<span class="op">/</span>repID), <span class="dt">family =</span> <span class="st">&quot;nbinom2&quot;</span>, <span class="dt">data =</span> byrep)</a>
<a class="sourceLine" id="cb74-2" title="2"><span class="kw">summary</span>(c.flowers)</a></code></pre></div>
<pre><code>##  Family: nbinom2  ( log )
## Formula:          
## total.flowers ~ treatment * flowering + flowers.pot + het.annual.floral.density +  
##     het.shrub.blooming.neighbours + offset(log(dec.Length)) +  
##     (1 | PlantID/repID)
## Data: byrep
## 
##      AIC      BIC   logLik deviance df.resid 
##   1097.9   1132.3   -539.0   1077.9      221 
## 
## Random effects:
## 
## Conditional model:
##  Groups        Name        Variance  Std.Dev. 
##  repID:PlantID (Intercept) 1.165e-01 0.3413310
##  PlantID       (Intercept) 3.278e-08 0.0001811
## Number of obs: 231, groups:  repID:PlantID, 122; PlantID, 61
## 
## Overdispersion parameter for nbinom2 family (): 1.08 
## 
## Conditional model:
##                               Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)                    0.84650    0.30540   2.772  0.00557 ** 
## treatmentshrub                -0.39633    0.21933  -1.807  0.07077 .  
## floweringbloom                -1.16105    0.22987  -5.051  4.4e-07 ***
## flowers.pot                    0.08231    0.02705   3.043  0.00234 ** 
## het.annual.floral.density      0.04162    0.02332   1.785  0.07426 .  
## het.shrub.blooming.neighbours -0.05571    0.04125  -1.350  0.17687    
## treatmentshrub:floweringbloom  0.12553    0.32018   0.392  0.69502    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb76-1" title="1">t &lt;-<span class="st"> </span>car<span class="op">::</span><span class="kw">Anova</span>(c.flowers, <span class="dt">type =</span> <span class="dv">2</span>)</a></code></pre></div>
</div>
<div id="rtu-visitation-modelling" class="section level3">
<h3>RTU visitation modelling</h3>
<p>Models for testing RTU-specificity</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb77-1" title="1">byrtu &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;Output Data/rtu_by_rep.csv&quot;</span>)</a>
<a class="sourceLine" id="cb77-2" title="2">byrtu<span class="op">$</span>repID &lt;-<span class="st"> </span><span class="kw">paste</span>(byrtu<span class="op">$</span>PlantID, byrtu<span class="op">$</span>treatment)</a>
<a class="sourceLine" id="cb77-3" title="3">byrtu<span class="op">$</span>treatment &lt;-<span class="st"> </span><span class="kw">relevel</span>(byrtu<span class="op">$</span>treatment, <span class="st">&quot;open&quot;</span>)</a>
<a class="sourceLine" id="cb77-4" title="4">byrtu<span class="op">$</span>flowering &lt;-<span class="st"> </span><span class="kw">relevel</span>(byrtu<span class="op">$</span>flowering, <span class="st">&quot;pre&quot;</span>)</a>
<a class="sourceLine" id="cb77-5" title="5"></a>
<a class="sourceLine" id="cb77-6" title="6"><span class="co">#Full model (foraging instances)</span></a>
<a class="sourceLine" id="cb77-7" title="7">mFullPQ &lt;-<span class="st"> </span>MASS<span class="op">::</span><span class="kw">glmmPQL</span>(total.visits<span class="op">~</span>flowering <span class="op">*</span><span class="st"> </span>rtu <span class="op">*</span><span class="st"> </span>treatment <span class="op">+</span><span class="st"> </span>flowers.pot <span class="op">+</span><span class="st"> </span>het.annual.floral.density <span class="op">+</span><span class="st"> </span>het.shrub.blooming.neighbours <span class="op">+</span><span class="st"> </span><span class="kw">offset</span>(<span class="kw">log</span>(dec.Length)), <span class="dt">random =</span> <span class="op">~</span><span class="dv">1</span><span class="op">|</span>PlantID<span class="op">/</span>repID, <span class="dt">family=</span><span class="st">&quot;quasipoisson&quot;</span>, <span class="dt">data =</span> byrtu)</a></code></pre></div>
<pre><code>## iteration 1</code></pre>
<pre><code>## iteration 2</code></pre>
<pre><code>## iteration 3</code></pre>
<pre><code>## iteration 4</code></pre>
<pre><code>## iteration 5</code></pre>
<pre><code>## iteration 6</code></pre>
<pre><code>## iteration 7</code></pre>
<pre><code>## iteration 8</code></pre>
<pre><code>## iteration 9</code></pre>
<pre><code>## iteration 10</code></pre>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb88-1" title="1"><span class="kw">summary</span>(mFullPQ)</a></code></pre></div>
<pre><code>## Linear mixed-effects model fit by maximum likelihood
##  Data: byrtu 
##   AIC BIC logLik
##    NA  NA     NA
## 
## Random effects:
##  Formula: ~1 | PlantID
##         (Intercept)
## StdDev:   0.2203551
## 
##  Formula: ~1 | repID %in% PlantID
##         (Intercept) Residual
## StdDev:   0.4733597 1.324489
## 
## Variance function:
##  Structure: fixed weights
##  Formula: ~invwt 
## Fixed effects: total.visits ~ flowering * rtu * treatment + flowers.pot + het.annual.floral.density +      het.shrub.blooming.neighbours + offset(log(dec.Length)) 
##                                                Value Std.Error   DF
## (Intercept)                                -1.415959      0.33 1239
## floweringbloom                             -2.200581      0.71 1239
## rtubombylid                                -0.757686      0.42 1239
## rtuhoneybee                               -27.611509 142023.57 1239
## rtulep                                     -3.465736      1.36 1239
## rtuother                                    0.523248      0.30 1239
## rtusyrphid                                  1.822531      0.25 1239
## treatmentshrub                             -0.844208      0.45   60
## flowers.pot                                 0.053632      0.02 1239
## het.annual.floral.density                   0.037148      0.02 1239
## het.shrub.blooming.neighbours              -0.044494      0.04 1239
## floweringbloom:rtubombylid                  2.315830      0.85 1239
## floweringbloom:rtuhoneybee                  2.077398 200954.54 1239
## floweringbloom:rtulep                       4.564348      1.56 1239
## floweringbloom:rtuother                     2.133509      0.75 1239
## floweringbloom:rtusyrphid                  -0.643876      0.81 1239
## floweringbloom:treatmentshrub               1.476754      0.95 1239
## rtubombylid:treatmentshrub                  1.188469      0.63 1239
## rtuhoneybee:treatmentshrub                 26.655998 142023.57 1239
## rtulep:treatmentshrub                       0.900787      1.94 1239
## rtuother:treatmentshrub                     0.575364      0.52 1239
## rtusyrphid:treatmentshrub                   0.480054      0.47 1239
## floweringbloom:rtubombylid:treatmentshrub  -2.294628      1.17 1239
## floweringbloom:rtuhoneybee:treatmentshrub -27.253683 247747.94 1239
## floweringbloom:rtulep:treatmentshrub       -1.999399      2.21 1239
## floweringbloom:rtuother:treatmentshrub     -1.349390      1.02 1239
## floweringbloom:rtusyrphid:treatmentshrub   -1.812860      1.16 1239
##                                             t-value p-value
## (Intercept)                               -4.352760  0.0000
## floweringbloom                            -3.078653  0.0021
## rtubombylid                               -1.810258  0.0705
## rtuhoneybee                               -0.000194  0.9998
## rtulep                                    -2.551486  0.0108
## rtuother                                   1.753517  0.0798
## rtusyrphid                                 7.151519  0.0000
## treatmentshrub                            -1.875363  0.0656
## flowers.pot                                2.541848  0.0111
## het.annual.floral.density                  2.398246  0.0166
## het.shrub.blooming.neighbours             -1.137575  0.2555
## floweringbloom:rtubombylid                 2.735640  0.0063
## floweringbloom:rtuhoneybee                 0.000010  1.0000
## floweringbloom:rtulep                      2.921181  0.0036
## floweringbloom:rtuother                    2.831591  0.0047
## floweringbloom:rtusyrphid                 -0.798721  0.4246
## floweringbloom:treatmentshrub              1.557598  0.1196
## rtubombylid:treatmentshrub                 1.873833  0.0612
## rtuhoneybee:treatmentshrub                 0.000188  0.9999
## rtulep:treatmentshrub                      0.463819  0.6429
## rtuother:treatmentshrub                    1.102113  0.2706
## rtusyrphid:treatmentshrub                  1.032115  0.3022
## floweringbloom:rtubombylid:treatmentshrub -1.966219  0.0495
## floweringbloom:rtuhoneybee:treatmentshrub -0.000110  0.9999
## floweringbloom:rtulep:treatmentshrub      -0.905147  0.3656
## floweringbloom:rtuother:treatmentshrub    -1.319578  0.1872
## floweringbloom:rtusyrphid:treatmentshrub  -1.557370  0.1196
##  Correlation: 
##                                           (Intr) flwrng rtbmby rthnyb
## floweringbloom                            -0.218                     
## rtubombylid                               -0.411  0.187              
## rtuhoneybee                                0.000  0.000  0.000       
## rtulep                                    -0.127  0.058  0.098  0.000
## rtuother                                  -0.576  0.262  0.448  0.000
## rtusyrphid                                -0.674  0.307  0.524  0.000
## treatmentshrub                            -0.416  0.177  0.297  0.000
## flowers.pot                               -0.641 -0.035  0.000  0.000
## het.annual.floral.density                 -0.193  0.031  0.000  0.000
## het.shrub.blooming.neighbours             -0.004 -0.102  0.000  0.000
## floweringbloom:rtubombylid                 0.203 -0.832 -0.494  0.000
## floweringbloom:rtuhoneybee                 0.000  0.000  0.000 -0.707
## floweringbloom:rtulep                      0.110 -0.451 -0.085  0.000
## floweringbloom:rtuother                    0.228 -0.934 -0.177  0.000
## floweringbloom:rtusyrphid                  0.213 -0.873 -0.166  0.000
## floweringbloom:treatmentshrub              0.181 -0.741 -0.141  0.000
## rtubombylid:treatmentshrub                 0.271 -0.123 -0.660  0.000
## rtuhoneybee:treatmentshrub                 0.000  0.000  0.000 -1.000
## rtulep:treatmentshrub                      0.088 -0.040 -0.069  0.000
## rtuother:treatmentshrub                    0.329 -0.150 -0.256  0.000
## rtusyrphid:treatmentshrub                  0.370 -0.168 -0.287  0.000
## floweringbloom:rtubombylid:treatmentshrub -0.147  0.603  0.359  0.000
## floweringbloom:rtuhoneybee:treatmentshrub  0.000  0.000  0.000  0.573
## floweringbloom:rtulep:treatmentshrub      -0.078  0.319  0.060  0.000
## floweringbloom:rtuother:treatmentshrub    -0.168  0.688  0.131  0.000
## floweringbloom:rtusyrphid:treatmentshrub  -0.148  0.605  0.115  0.000
##                                           rtulep rtuthr rtsyrp trtmnt
## floweringbloom                                                       
## rtubombylid                                                          
## rtuhoneybee                                                          
## rtulep                                                               
## rtuother                                   0.138                     
## rtusyrphid                                 0.162  0.735              
## treatmentshrub                             0.091  0.416  0.487       
## flowers.pot                                0.000  0.000  0.000  0.006
## het.annual.floral.density                  0.000  0.000  0.000  0.001
## het.shrub.blooming.neighbours              0.000  0.000  0.000 -0.017
## floweringbloom:rtubombylid                -0.049 -0.221 -0.259 -0.147
## floweringbloom:rtuhoneybee                 0.000  0.000  0.000  0.000
## floweringbloom:rtulep                     -0.869 -0.120 -0.140 -0.079
## floweringbloom:rtuother                   -0.055 -0.396 -0.291 -0.165
## floweringbloom:rtusyrphid                 -0.051 -0.232 -0.316 -0.154
## floweringbloom:treatmentshrub             -0.043 -0.198 -0.231 -0.455
## rtubombylid:treatmentshrub                -0.065 -0.295 -0.346 -0.678
## rtuhoneybee:treatmentshrub                 0.000  0.000  0.000  0.000
## rtulep:treatmentshrub                     -0.699 -0.096 -0.113 -0.221
## rtuother:treatmentshrub                   -0.079 -0.572 -0.420 -0.824
## rtusyrphid:treatmentshrub                 -0.088 -0.403 -0.548 -0.924
## floweringbloom:rtubombylid:treatmentshrub  0.035  0.161  0.188  0.368
## floweringbloom:rtuhoneybee:treatmentshrub  0.000  0.000  0.000  0.000
## floweringbloom:rtulep:treatmentshrub       0.615  0.085  0.099  0.195
## floweringbloom:rtuother:treatmentshrub     0.040  0.292  0.215  0.420
## floweringbloom:rtusyrphid:treatmentshrub   0.035  0.161  0.219  0.369
##                                           flwrs. ht.n.. ht.s..
## floweringbloom                                                
## rtubombylid                                                   
## rtuhoneybee                                                   
## rtulep                                                        
## rtuother                                                      
## rtusyrphid                                                    
## treatmentshrub                                                
## flowers.pot                                                   
## het.annual.floral.density                  0.173              
## het.shrub.blooming.neighbours             -0.067 -0.080       
## floweringbloom:rtubombylid                 0.000  0.000  0.000
## floweringbloom:rtuhoneybee                 0.000  0.000  0.000
## floweringbloom:rtulep                      0.000  0.000  0.000
## floweringbloom:rtuother                    0.000  0.000  0.000
## floweringbloom:rtusyrphid                  0.000  0.000  0.000
## floweringbloom:treatmentshrub              0.005  0.008 -0.028
## rtubombylid:treatmentshrub                 0.000  0.000  0.000
## rtuhoneybee:treatmentshrub                 0.000  0.000  0.000
## rtulep:treatmentshrub                      0.000  0.000  0.000
## rtuother:treatmentshrub                    0.000  0.000  0.000
## rtusyrphid:treatmentshrub                  0.000  0.000  0.000
## floweringbloom:rtubombylid:treatmentshrub  0.000  0.000  0.000
## floweringbloom:rtuhoneybee:treatmentshrub  0.000  0.000  0.000
## floweringbloom:rtulep:treatmentshrub       0.000  0.000  0.000
## floweringbloom:rtuother:treatmentshrub     0.000  0.000  0.000
## floweringbloom:rtusyrphid:treatmentshrub   0.000  0.000  0.000
##                                           flwrngblm:rtb flwrngblm:rth
## floweringbloom                                                       
## rtubombylid                                                          
## rtuhoneybee                                                          
## rtulep                                                               
## rtuother                                                             
## rtusyrphid                                                           
## treatmentshrub                                                       
## flowers.pot                                                          
## het.annual.floral.density                                            
## het.shrub.blooming.neighbours                                        
## floweringbloom:rtubombylid                                           
## floweringbloom:rtuhoneybee                 0.000                     
## floweringbloom:rtulep                      0.380         0.000       
## floweringbloom:rtuother                    0.789         0.000       
## floweringbloom:rtusyrphid                  0.737         0.000       
## floweringbloom:treatmentshrub              0.627         0.000       
## rtubombylid:treatmentshrub                 0.326         0.000       
## rtuhoneybee:treatmentshrub                 0.000         0.707       
## rtulep:treatmentshrub                      0.034         0.000       
## rtuother:treatmentshrub                    0.127         0.000       
## rtusyrphid:treatmentshrub                  0.142         0.000       
## floweringbloom:rtubombylid:treatmentshrub -0.725         0.000       
## floweringbloom:rtuhoneybee:treatmentshrub  0.000        -0.811       
## floweringbloom:rtulep:treatmentshrub      -0.269         0.000       
## floweringbloom:rtuother:treatmentshrub    -0.581         0.000       
## floweringbloom:rtusyrphid:treatmentshrub  -0.511         0.000       
##                                           flwrngblm:rtl flwrngblm:rtt
## floweringbloom                                                       
## rtubombylid                                                          
## rtuhoneybee                                                          
## rtulep                                                               
## rtuother                                                             
## rtusyrphid                                                           
## treatmentshrub                                                       
## flowers.pot                                                          
## het.annual.floral.density                                            
## het.shrub.blooming.neighbours                                        
## floweringbloom:rtubombylid                                           
## floweringbloom:rtuhoneybee                                           
## floweringbloom:rtulep                                                
## floweringbloom:rtuother                    0.427                     
## floweringbloom:rtusyrphid                  0.399         0.828       
## floweringbloom:treatmentshrub              0.340         0.704       
## rtubombylid:treatmentshrub                 0.056         0.117       
## rtuhoneybee:treatmentshrub                 0.000         0.000       
## rtulep:treatmentshrub                      0.608         0.038       
## rtuother:treatmentshrub                    0.069         0.226       
## rtusyrphid:treatmentshrub                  0.077         0.160       
## floweringbloom:rtubombylid:treatmentshrub -0.276        -0.572       
## floweringbloom:rtuhoneybee:treatmentshrub  0.000         0.000       
## floweringbloom:rtulep:treatmentshrub      -0.707        -0.302       
## floweringbloom:rtuother:treatmentshrub    -0.315        -0.737       
## floweringbloom:rtusyrphid:treatmentshrub  -0.277        -0.574       
##                                           flwrngblm:rts flwrngblm:t rtbmb:
## floweringbloom                                                            
## rtubombylid                                                               
## rtuhoneybee                                                               
## rtulep                                                                    
## rtuother                                                                  
## rtusyrphid                                                                
## treatmentshrub                                                            
## flowers.pot                                                               
## het.annual.floral.density                                                 
## het.shrub.blooming.neighbours                                             
## floweringbloom:rtubombylid                                                
## floweringbloom:rtuhoneybee                                                
## floweringbloom:rtulep                                                     
## floweringbloom:rtuother                                                   
## floweringbloom:rtusyrphid                                                 
## floweringbloom:treatmentshrub              0.658                          
## rtubombylid:treatmentshrub                 0.109         0.322            
## rtuhoneybee:treatmentshrub                 0.000         0.000       0.000
## rtulep:treatmentshrub                      0.036         0.105       0.157
## rtuother:treatmentshrub                    0.133         0.391       0.585
## rtusyrphid:treatmentshrub                  0.173         0.439       0.656
## floweringbloom:rtubombylid:treatmentshrub -0.535        -0.810      -0.543
## floweringbloom:rtuhoneybee:treatmentshrub  0.000         0.000       0.000
## floweringbloom:rtulep:treatmentshrub      -0.283        -0.428      -0.138
## floweringbloom:rtuother:treatmentshrub    -0.610        -0.925      -0.298
## floweringbloom:rtusyrphid:treatmentshrub  -0.693        -0.812      -0.262
##                                           rthny: rtlp:t rtthr: rtsyr:
## floweringbloom                                                       
## rtubombylid                                                          
## rtuhoneybee                                                          
## rtulep                                                               
## rtuother                                                             
## rtusyrphid                                                           
## treatmentshrub                                                       
## flowers.pot                                                          
## het.annual.floral.density                                            
## het.shrub.blooming.neighbours                                        
## floweringbloom:rtubombylid                                           
## floweringbloom:rtuhoneybee                                           
## floweringbloom:rtulep                                                
## floweringbloom:rtuother                                              
## floweringbloom:rtusyrphid                                            
## floweringbloom:treatmentshrub                                        
## rtubombylid:treatmentshrub                                           
## rtuhoneybee:treatmentshrub                                           
## rtulep:treatmentshrub                      0.000                     
## rtuother:treatmentshrub                    0.000  0.191              
## rtusyrphid:treatmentshrub                  0.000  0.214  0.797       
## floweringbloom:rtubombylid:treatmentshrub  0.000 -0.085 -0.318 -0.357
## floweringbloom:rtuhoneybee:treatmentshrub -0.573  0.000  0.000  0.000
## floweringbloom:rtulep:treatmentshrub       0.000 -0.879 -0.168 -0.188
## floweringbloom:rtuother:treatmentshrub     0.000 -0.097 -0.511 -0.407
## floweringbloom:rtusyrphid:treatmentshrub   0.000 -0.086 -0.318 -0.400
##                                           flwrngblm:rtb: flwrngblm:rth:
## floweringbloom                                                         
## rtubombylid                                                            
## rtuhoneybee                                                            
## rtulep                                                                 
## rtuother                                                               
## rtusyrphid                                                             
## treatmentshrub                                                         
## flowers.pot                                                            
## het.annual.floral.density                                              
## het.shrub.blooming.neighbours                                          
## floweringbloom:rtubombylid                                             
## floweringbloom:rtuhoneybee                                             
## floweringbloom:rtulep                                                  
## floweringbloom:rtuother                                                
## floweringbloom:rtusyrphid                                              
## floweringbloom:treatmentshrub                                          
## rtubombylid:treatmentshrub                                             
## rtuhoneybee:treatmentshrub                                             
## rtulep:treatmentshrub                                                  
## rtuother:treatmentshrub                                                
## rtusyrphid:treatmentshrub                                              
## floweringbloom:rtubombylid:treatmentshrub                              
## floweringbloom:rtuhoneybee:treatmentshrub  0.000                       
## floweringbloom:rtulep:treatmentshrub       0.348          0.000        
## floweringbloom:rtuother:treatmentshrub     0.751          0.000        
## floweringbloom:rtusyrphid:treatmentshrub   0.660          0.000        
##                                           flwrngblm:rtl: flwrngblm:rtt:
## floweringbloom                                                         
## rtubombylid                                                            
## rtuhoneybee                                                            
## rtulep                                                                 
## rtuother                                                               
## rtusyrphid                                                             
## treatmentshrub                                                         
## flowers.pot                                                            
## het.annual.floral.density                                              
## het.shrub.blooming.neighbours                                          
## floweringbloom:rtubombylid                                             
## floweringbloom:rtuhoneybee                                             
## floweringbloom:rtulep                                                  
## floweringbloom:rtuother                                                
## floweringbloom:rtusyrphid                                              
## floweringbloom:treatmentshrub                                          
## rtubombylid:treatmentshrub                                             
## rtuhoneybee:treatmentshrub                                             
## rtulep:treatmentshrub                                                  
## rtuother:treatmentshrub                                                
## rtusyrphid:treatmentshrub                                              
## floweringbloom:rtubombylid:treatmentshrub                              
## floweringbloom:rtuhoneybee:treatmentshrub                              
## floweringbloom:rtulep:treatmentshrub                                   
## floweringbloom:rtuother:treatmentshrub     0.397                       
## floweringbloom:rtusyrphid:treatmentshrub   0.349          0.753        
## 
## Standardized Within-Group Residuals:
##           Min            Q1           Med            Q3           Max 
## -2.414212e+00 -3.939256e-01 -2.404337e-01 -5.006376e-15  1.430014e+01 
## 
## Number of Observations: 1386
## Number of Groups: 
##            PlantID repID %in% PlantID 
##                 61                122</code></pre>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb90-1" title="1">t &lt;-<span class="st"> </span>car<span class="op">::</span><span class="kw">Anova</span>(mFullPQ, <span class="dt">type =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb90-2" title="2"></a>
<a class="sourceLine" id="cb90-3" title="3">mP1 &lt;-<span class="st"> </span>MASS<span class="op">::</span><span class="kw">glmmPQL</span>(total.visits<span class="op">~</span>flowering <span class="op">*</span><span class="st"> </span>rtu <span class="op">+</span><span class="st"> </span>treatment <span class="op">+</span><span class="st"> </span>flowers.pot <span class="op">+</span><span class="st"> </span>het.annual.floral.density <span class="op">+</span><span class="st"> </span>het.shrub.blooming.neighbours <span class="op">+</span><span class="st"> </span><span class="kw">offset</span>(<span class="kw">log</span>(dec.Length)), <span class="dt">random =</span> <span class="op">~</span><span class="dv">1</span><span class="op">|</span>PlantID<span class="op">/</span>repID, <span class="dt">family=</span><span class="st">&quot;quasipoisson&quot;</span>, <span class="dt">data =</span> byrtu)</a></code></pre></div>
<pre><code>## iteration 1</code></pre>
<pre><code>## iteration 2</code></pre>
<pre><code>## iteration 3</code></pre>
<pre><code>## iteration 4</code></pre>
<pre><code>## iteration 5</code></pre>
<pre><code>## iteration 6</code></pre>
<pre><code>## iteration 7</code></pre>
<pre><code>## iteration 8</code></pre>
<pre><code>## iteration 9</code></pre>
<pre><code>## iteration 10</code></pre>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb101-1" title="1">car<span class="op">::</span><span class="kw">Anova</span>(mP1, <span class="dt">type =</span> <span class="dv">3</span>)</a></code></pre></div>
<pre><code>## Analysis of Deviance Table (Type III tests)
## 
## Response: total.visits
##                                  Chisq Df Pr(&gt;Chisq)    
## (Intercept)                    24.5018  1  7.424e-07 ***
## flowering                       9.3810  1   0.002192 ** 
## rtu                           210.6638  5  &lt; 2.2e-16 ***
## treatment                       4.5105  1   0.033687 *  
## flowers.pot                     5.8299  1   0.015756 *  
## het.annual.floral.density       5.3384  1   0.020860 *  
## het.shrub.blooming.neighbours   1.0849  1   0.297602    
## flowering:rtu                  65.8395  5  7.504e-13 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb103-1" title="1">mPt &lt;-<span class="st"> </span>MASS<span class="op">::</span><span class="kw">glmmPQL</span>(total.visits<span class="op">~</span><span class="st"> </span>flowering <span class="op">*</span><span class="st"> </span>rtu <span class="op">+</span><span class="st">  </span>treatment <span class="op">+</span><span class="st"> </span>flowers.pot <span class="op">+</span><span class="st"> </span>het.annual.floral.density <span class="op">+</span><span class="st"> </span><span class="kw">offset</span>(<span class="kw">log</span>(dec.Length)), <span class="dt">random =</span> <span class="op">~</span><span class="dv">1</span><span class="op">|</span>PlantID<span class="op">/</span>repID, <span class="dt">family=</span><span class="st">&quot;quasipoisson&quot;</span>, <span class="dt">data =</span> byrtu)</a></code></pre></div>
<pre><code>## iteration 1</code></pre>
<pre><code>## iteration 2</code></pre>
<pre><code>## iteration 3</code></pre>
<pre><code>## iteration 4</code></pre>
<pre><code>## iteration 5</code></pre>
<pre><code>## iteration 6</code></pre>
<pre><code>## iteration 7</code></pre>
<pre><code>## iteration 8</code></pre>
<pre><code>## iteration 9</code></pre>
<pre><code>## iteration 10</code></pre>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb114-1" title="1"><span class="kw">summary</span>(mPt)</a></code></pre></div>
<pre><code>## Linear mixed-effects model fit by maximum likelihood
##  Data: byrtu 
##   AIC BIC logLik
##    NA  NA     NA
## 
## Random effects:
##  Formula: ~1 | PlantID
##         (Intercept)
## StdDev:     0.22884
## 
##  Formula: ~1 | repID %in% PlantID
##         (Intercept) Residual
## StdDev:   0.4255542 1.464069
## 
## Variance function:
##  Structure: fixed weights
##  Formula: ~invwt 
## Fixed effects: total.visits ~ flowering * rtu + treatment + flowers.pot + het.annual.floral.density +      offset(log(dec.Length)) 
##                                 Value Std.Error   DF   t-value p-value
## (Intercept)                 -1.582497      0.33 1251 -4.866918  0.0000
## floweringbloom              -1.620995      0.50 1251 -3.260774  0.0011
## rtubombylid                 -0.251314      0.33 1251 -0.757510  0.4489
## rtuhoneybee                 -2.197225      0.69 1251 -3.166330  0.0016
## rtulep                      -3.113515      1.06 1251 -2.926839  0.0035
## rtuother                     0.725937      0.27 1251  2.715705  0.0067
## rtusyrphid                   1.986351      0.23 1251  8.488291  0.0000
## treatmentshrub              -0.318826      0.14   60 -2.261107  0.0274
## flowers.pot                  0.051805      0.02 1251  2.312699  0.0209
## het.annual.floral.density    0.035700      0.02 1251  2.219892  0.0266
## floweringbloom:rtubombylid   1.254617      0.62 1251  2.037149  0.0418
## floweringbloom:rtuhoneybee -22.688602  68229.09 1251 -0.000333  0.9997
## floweringbloom:rtulep        3.660059      1.20 1251  3.047220  0.0024
## floweringbloom:rtuother      1.510897      0.54 1251  2.808141  0.0051
## floweringbloom:rtusyrphid   -1.439807      0.60 1251 -2.380557  0.0174
##  Correlation: 
##                            (Intr) flwrng rtbmby rthnyb rtulep rtuthr
## floweringbloom             -0.262                                   
## rtubombylid                -0.446  0.292                            
## rtuhoneybee                -0.213  0.140  0.209                     
## rtulep                     -0.139  0.091  0.136  0.065              
## rtuother                   -0.554  0.362  0.543  0.260  0.169       
## rtusyrphid                 -0.633  0.414  0.620  0.297  0.193  0.770
## treatmentshrub             -0.212 -0.002  0.000  0.000  0.000  0.000
## flowers.pot                -0.687 -0.061  0.000  0.000  0.000  0.000
## het.annual.floral.density  -0.208  0.039  0.000  0.000  0.000  0.000
## floweringbloom:rtubombylid  0.240 -0.801 -0.539 -0.113 -0.074 -0.293
## floweringbloom:rtuhoneybee  0.000  0.000  0.000  0.000  0.000  0.000
## floweringbloom:rtulep       0.123 -0.411 -0.121 -0.058 -0.886 -0.150
## floweringbloom:rtuother     0.275 -0.917 -0.270 -0.129 -0.084 -0.497
## floweringbloom:rtusyrphid   0.245 -0.815 -0.240 -0.115 -0.075 -0.298
##                            rtsyrp trtmnt flwrs. ht.n.. flwrngblm:rtb
## floweringbloom                                                      
## rtubombylid                                                         
## rtuhoneybee                                                         
## rtulep                                                              
## rtuother                                                            
## rtusyrphid                                                          
## treatmentshrub              0.000                                   
## flowers.pot                 0.000  0.027                            
## het.annual.floral.density   0.000  0.011  0.168                     
## floweringbloom:rtubombylid -0.334  0.000  0.000  0.000              
## floweringbloom:rtuhoneybee  0.000  0.000  0.000  0.000  0.000       
## floweringbloom:rtulep      -0.171  0.000  0.000  0.000  0.331       
## floweringbloom:rtuother    -0.382  0.000  0.000  0.000  0.740       
## floweringbloom:rtusyrphid  -0.387  0.000  0.000  0.000  0.658       
##                            flwrngblm:rth flwrngblm:rtl flwrngblm:rtt
## floweringbloom                                                      
## rtubombylid                                                         
## rtuhoneybee                                                         
## rtulep                                                              
## rtuother                                                            
## rtusyrphid                                                          
## treatmentshrub                                                      
## flowers.pot                                                         
## het.annual.floral.density                                           
## floweringbloom:rtubombylid                                          
## floweringbloom:rtuhoneybee                                          
## floweringbloom:rtulep       0.000                                   
## floweringbloom:rtuother     0.000         0.379                     
## floweringbloom:rtusyrphid   0.000         0.337         0.753       
## 
## Standardized Within-Group Residuals:
##        Min         Q1        Med         Q3        Max 
## -2.0026759 -0.3594501 -0.2237711 -0.0585066 15.6102117 
## 
## Number of Observations: 1386
## Number of Groups: 
##            PlantID repID %in% PlantID 
##                 61                122</code></pre>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb116-1" title="1">car<span class="op">::</span><span class="kw">Anova</span>(mPt, <span class="dt">type =</span> <span class="dv">3</span>)</a></code></pre></div>
<pre><code>## Analysis of Deviance Table (Type III tests)
## 
## Response: total.visits
##                              Chisq Df Pr(&gt;Chisq)    
## (Intercept)                23.9461  1  9.907e-07 ***
## flowering                  10.7490  1   0.001043 ** 
## rtu                       206.8849  5  &lt; 2.2e-16 ***
## treatment                   5.1685  1   0.023000 *  
## flowers.pot                 5.4071  1   0.020055 *  
## het.annual.floral.density   4.9818  1   0.025615 *  
## flowering:rtu              64.6584  5  1.319e-12 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb118-1" title="1"><span class="kw">lsmeans</span>(mPt, pairwise<span class="op">~</span>flowering<span class="op">|</span>rtu)</a></code></pre></div>
<pre><code>## $lsmeans
## rtu = bee:
##  flowering  lsmean       SE df  lower.CL  upper.CL
##  pre        -0.907     0.23 60 -1.36e+00     -0.45
##  bloom      -2.528     0.45 60 -3.42e+00     -1.63
## 
## rtu = bombylid:
##  flowering  lsmean       SE df  lower.CL  upper.CL
##  pre        -1.158     0.25 60 -1.67e+00     -0.65
##  bloom      -1.525     0.28 60 -2.08e+00     -0.97
## 
## rtu = honeybee:
##  flowering  lsmean       SE df  lower.CL  upper.CL
##  pre        -3.104     0.66 60 -4.43e+00     -1.78
##  bloom     -27.414 68229.09 60 -1.37e+05 136451.08
## 
## rtu = lep:
##  flowering  lsmean       SE df  lower.CL  upper.CL
##  pre        -4.021     1.04 60 -6.11e+00     -1.94
##  bloom      -1.981     0.34 60 -2.67e+00     -1.30
## 
## rtu = other:
##  flowering  lsmean       SE df  lower.CL  upper.CL
##  pre        -0.181     0.16 60 -5.10e-01      0.14
##  bloom      -0.291     0.16 60 -6.00e-01      0.02
## 
## rtu = syrphid:
##  flowering  lsmean       SE df  lower.CL  upper.CL
##  pre         1.079     0.10 60  8.80e-01      1.28
##  bloom      -1.981     0.34 60 -2.67e+00     -1.30
## 
## Results are averaged over the levels of: treatment 
## Degrees-of-freedom method: containment 
## Results are given on the log (not the response) scale. 
## Confidence level used: 0.95 
## 
## $contrasts
## rtu = bee:
##  contrast    estimate       SE   df t.ratio p.value
##  pre - bloom    1.621     0.50 1251  3.261  0.0011 
## 
## rtu = bombylid:
##  contrast    estimate       SE   df t.ratio p.value
##  pre - bloom    0.366     0.37 1251  0.993  0.3209 
## 
## rtu = honeybee:
##  contrast    estimate       SE   df t.ratio p.value
##  pre - bloom   24.310 68229.09 1251  0.000  0.9997 
## 
## rtu = lep:
##  contrast    estimate       SE   df t.ratio p.value
##  pre - bloom   -2.039     1.10 1251 -1.862  0.0629 
## 
## rtu = other:
##  contrast    estimate       SE   df t.ratio p.value
##  pre - bloom    0.110     0.22 1251  0.512  0.6090 
## 
## rtu = syrphid:
##  contrast    estimate       SE   df t.ratio p.value
##  pre - bloom    3.061     0.35 1251  8.740  &lt;.0001 
## 
## Results are averaged over the levels of: treatment 
## Degrees-of-freedom method: containment 
## Results are given on the log (not the response) scale.</code></pre>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb120-1" title="1"><span class="co">#full model flower visits</span></a>
<a class="sourceLine" id="cb120-2" title="2">mFullPQv &lt;-<span class="st"> </span>MASS<span class="op">::</span><span class="kw">glmmPQL</span>(total.flowers<span class="op">~</span>flowering <span class="op">*</span><span class="st"> </span>rtu <span class="op">*</span><span class="st"> </span>treatment <span class="op">+</span><span class="st"> </span>flowers.pot <span class="op">+</span><span class="st"> </span>het.annual.floral.density <span class="op">+</span><span class="st"> </span>het.shrub.blooming.neighbours <span class="op">+</span><span class="st"> </span><span class="kw">offset</span>(<span class="kw">log</span>(dec.Length)), <span class="dt">random =</span> <span class="op">~</span><span class="dv">1</span><span class="op">|</span>PlantID<span class="op">/</span>repID, <span class="dt">family=</span><span class="st">&quot;quasipoisson&quot;</span>, <span class="dt">data =</span> byrtu)</a></code></pre></div>
<pre><code>## iteration 1</code></pre>
<pre><code>## iteration 2</code></pre>
<pre><code>## iteration 3</code></pre>
<pre><code>## iteration 4</code></pre>
<pre><code>## iteration 5</code></pre>
<pre><code>## iteration 6</code></pre>
<pre><code>## iteration 7</code></pre>
<pre><code>## iteration 8</code></pre>
<pre><code>## iteration 9</code></pre>
<pre><code>## iteration 10</code></pre>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb131-1" title="1"><span class="kw">summary</span>(mFullPQv)</a></code></pre></div>
<pre><code>## Linear mixed-effects model fit by maximum likelihood
##  Data: byrtu 
##   AIC BIC logLik
##    NA  NA     NA
## 
## Random effects:
##  Formula: ~1 | PlantID
##         (Intercept)
## StdDev:   0.2393515
## 
##  Formula: ~1 | repID %in% PlantID
##         (Intercept) Residual
## StdDev:   0.5789797 1.566556
## 
## Variance function:
##  Structure: fixed weights
##  Formula: ~invwt 
## Fixed effects: total.flowers ~ flowering * rtu * treatment + flowers.pot + het.annual.floral.density +      het.shrub.blooming.neighbours + offset(log(dec.Length)) 
##                                                Value Std.Error   DF
## (Intercept)                                -0.979717      0.31 1239
## floweringbloom                             -2.175786      0.60 1239
## rtubombylid                                -1.386294      0.44 1239
## rtuhoneybee                               -27.099692  91960.98 1239
## rtulep                                     -4.158883      1.59 1239
## rtuother                                   -0.115832      0.29 1239
## rtusyrphid                                  1.435828      0.22 1239
## treatmentshrub                             -1.090591      0.43   60
## flowers.pot                                 0.074787      0.02 1239
## het.annual.floral.density                   0.028520      0.02 1239
## het.shrub.blooming.neighbours              -0.072448      0.04 1239
## floweringbloom:rtubombylid                  2.772589      0.77 1239
## floweringbloom:rtuhoneybee                  2.045259 131178.26 1239
## floweringbloom:rtulep                       4.969813      1.73 1239
## floweringbloom:rtuother                     2.255898      0.66 1239
## floweringbloom:rtusyrphid                  -0.424227      0.69 1239
## floweringbloom:treatmentshrub               1.620281      0.83 1239
## rtubombylid:treatmentshrub                  1.486378      0.67 1239
## rtuhoneybee:treatmentshrub                 26.457838  91960.98 1239
## rtulep:treatmentshrub                       1.214444      2.28 1239
## rtuother:treatmentshrub                     0.834954      0.53 1239
## rtusyrphid:treatmentshrub                   0.749631      0.44 1239
## floweringbloom:rtubombylid:treatmentshrub  -2.718522      1.11 1239
## floweringbloom:rtuhoneybee:treatmentshrub -26.998537 165002.50 1239
## floweringbloom:rtulep:treatmentshrub       -2.207696      2.47 1239
## floweringbloom:rtuother:treatmentshrub     -1.349053      0.94 1239
## floweringbloom:rtusyrphid:treatmentshrub   -2.454380      1.12 1239
##                                             t-value p-value
## (Intercept)                               -3.154788  0.0016
## floweringbloom                            -3.615551  0.0003
## rtubombylid                               -3.135036  0.0018
## rtuhoneybee                               -0.000295  0.9998
## rtulep                                    -2.608508  0.0092
## rtuother                                  -0.402017  0.6877
## rtusyrphid                                 6.525723  0.0000
## treatmentshrub                            -2.537207  0.0138
## flowers.pot                                3.375247  0.0008
## het.annual.floral.density                  1.697634  0.0898
## het.shrub.blooming.neighbours             -1.711431  0.0873
## floweringbloom:rtubombylid                 3.620028  0.0003
## floweringbloom:rtuhoneybee                 0.000016  1.0000
## floweringbloom:rtulep                      2.872260  0.0041
## floweringbloom:rtuother                    3.429539  0.0006
## floweringbloom:rtusyrphid                 -0.615511  0.5383
## floweringbloom:treatmentshrub              1.942756  0.0523
## rtubombylid:treatmentshrub                 2.224557  0.0263
## rtuhoneybee:treatmentshrub                 0.000288  0.9998
## rtulep:treatmentshrub                      0.533774  0.5936
## rtuother:treatmentshrub                    1.580962  0.1141
## rtusyrphid:treatmentshrub                  1.697797  0.0898
## floweringbloom:rtubombylid:treatmentshrub -2.456340  0.0142
## floweringbloom:rtuhoneybee:treatmentshrub -0.000164  0.9999
## floweringbloom:rtulep:treatmentshrub      -0.894801  0.3711
## floweringbloom:rtuother:treatmentshrub    -1.439579  0.1502
## floweringbloom:rtusyrphid:treatmentshrub  -2.197650  0.0282
##  Correlation: 
##                                           (Intr) flwrng rtbmby rthnyb
## floweringbloom                            -0.180                     
## rtubombylid                               -0.285  0.147              
## rtuhoneybee                                0.000  0.000  0.000       
## rtulep                                    -0.079  0.041  0.055  0.000
## rtuother                                  -0.437  0.226  0.307  0.000
## rtusyrphid                                -0.572  0.295  0.402  0.000
## treatmentshrub                            -0.349  0.157  0.206  0.000
## flowers.pot                               -0.706 -0.045  0.000  0.000
## het.annual.floral.density                 -0.212  0.049  0.000  0.000
## het.shrub.blooming.neighbours              0.022 -0.136  0.000  0.000
## floweringbloom:rtubombylid                 0.164 -0.764 -0.577  0.000
## floweringbloom:rtuhoneybee                 0.000  0.000  0.000 -0.701
## floweringbloom:rtulep                      0.073 -0.338 -0.051  0.000
## floweringbloom:rtuother                    0.191 -0.889 -0.134  0.000
## floweringbloom:rtusyrphid                  0.183 -0.849 -0.128  0.000
## floweringbloom:treatmentshrub              0.149 -0.701 -0.106  0.000
## rtubombylid:treatmentshrub                 0.188 -0.097 -0.662  0.000
## rtuhoneybee:treatmentshrub                 0.000  0.000  0.000 -1.000
## rtulep:treatmentshrub                      0.055 -0.029 -0.039  0.000
## rtuother:treatmentshrub                    0.238 -0.123 -0.167  0.000
## rtusyrphid:treatmentshrub                  0.285 -0.147 -0.200  0.000
## floweringbloom:rtubombylid:treatmentshrub -0.114  0.528  0.400  0.000
## floweringbloom:rtuhoneybee:treatmentshrub  0.000  0.000  0.000  0.557
## floweringbloom:rtulep:treatmentshrub      -0.051  0.237  0.036  0.000
## floweringbloom:rtuother:treatmentshrub    -0.134  0.624  0.094  0.000
## floweringbloom:rtusyrphid:treatmentshrub  -0.113  0.524  0.079  0.000
##                                           rtulep rtuthr rtsyrp trtmnt
## floweringbloom                                                       
## rtubombylid                                                          
## rtuhoneybee                                                          
## rtulep                                                               
## rtuother                                   0.085                     
## rtusyrphid                                 0.111  0.617              
## treatmentshrub                             0.057  0.316  0.414       
## flowers.pot                                0.000  0.000  0.000  0.006
## het.annual.floral.density                  0.000  0.000  0.000  0.003
## het.shrub.blooming.neighbours              0.000  0.000  0.000 -0.023
## floweringbloom:rtubombylid                -0.032 -0.177 -0.232 -0.119
## floweringbloom:rtuhoneybee                 0.000  0.000  0.000  0.000
## floweringbloom:rtulep                     -0.921 -0.078 -0.103 -0.053
## floweringbloom:rtuother                   -0.037 -0.438 -0.270 -0.138
## floweringbloom:rtusyrphid                 -0.036 -0.197 -0.319 -0.132
## floweringbloom:treatmentshrub             -0.029 -0.163 -0.213 -0.480
## rtubombylid:treatmentshrub                -0.037 -0.203 -0.266 -0.595
## rtuhoneybee:treatmentshrub                 0.000  0.000  0.000  0.000
## rtulep:treatmentshrub                     -0.701 -0.060 -0.078 -0.175
## rtuother:treatmentshrub                   -0.046 -0.546 -0.337 -0.753
## rtusyrphid:treatmentshrub                 -0.056 -0.307 -0.498 -0.900
## floweringbloom:rtubombylid:treatmentshrub  0.022  0.123  0.161  0.359
## floweringbloom:rtuhoneybee:treatmentshrub  0.000  0.000  0.000  0.000
## floweringbloom:rtulep:treatmentshrub       0.646  0.055  0.072  0.161
## floweringbloom:rtuother:treatmentshrub     0.026  0.307  0.190  0.424
## floweringbloom:rtusyrphid:treatmentshrub   0.022  0.122  0.197  0.356
##                                           flwrs. ht.n.. ht.s..
## floweringbloom                                                
## rtubombylid                                                   
## rtuhoneybee                                                   
## rtulep                                                        
## rtuother                                                      
## rtusyrphid                                                    
## treatmentshrub                                                
## flowers.pot                                                   
## het.annual.floral.density                  0.172              
## het.shrub.blooming.neighbours             -0.093 -0.102       
## floweringbloom:rtubombylid                 0.000  0.000  0.000
## floweringbloom:rtuhoneybee                 0.000  0.000  0.000
## floweringbloom:rtulep                      0.000  0.000  0.000
## floweringbloom:rtuother                    0.000  0.000  0.000
## floweringbloom:rtusyrphid                  0.000  0.000  0.000
## floweringbloom:treatmentshrub              0.009  0.006 -0.021
## rtubombylid:treatmentshrub                 0.000  0.000  0.000
## rtuhoneybee:treatmentshrub                 0.000  0.000  0.000
## rtulep:treatmentshrub                      0.000  0.000  0.000
## rtuother:treatmentshrub                    0.000  0.000  0.000
## rtusyrphid:treatmentshrub                  0.000  0.000  0.000
## floweringbloom:rtubombylid:treatmentshrub  0.000  0.000  0.000
## floweringbloom:rtuhoneybee:treatmentshrub  0.000  0.000  0.000
## floweringbloom:rtulep:treatmentshrub       0.000  0.000  0.000
## floweringbloom:rtuother:treatmentshrub     0.000  0.000  0.000
## floweringbloom:rtusyrphid:treatmentshrub   0.000  0.000  0.000
##                                           flwrngblm:rtb flwrngblm:rth
## floweringbloom                                                       
## rtubombylid                                                          
## rtuhoneybee                                                          
## rtulep                                                               
## rtuother                                                             
## rtusyrphid                                                           
## treatmentshrub                                                       
## flowers.pot                                                          
## het.annual.floral.density                                            
## het.shrub.blooming.neighbours                                        
## floweringbloom:rtubombylid                                           
## floweringbloom:rtuhoneybee                 0.000                     
## floweringbloom:rtulep                      0.266         0.000       
## floweringbloom:rtuother                    0.699         0.000       
## floweringbloom:rtusyrphid                  0.667         0.000       
## floweringbloom:treatmentshrub              0.551         0.000       
## rtubombylid:treatmentshrub                 0.382         0.000       
## rtuhoneybee:treatmentshrub                 0.000         0.701       
## rtulep:treatmentshrub                      0.022         0.000       
## rtuother:treatmentshrub                    0.097         0.000       
## rtusyrphid:treatmentshrub                  0.116         0.000       
## floweringbloom:rtubombylid:treatmentshrub -0.692         0.000       
## floweringbloom:rtuhoneybee:treatmentshrub  0.000        -0.795       
## floweringbloom:rtulep:treatmentshrub      -0.186         0.000       
## floweringbloom:rtuother:treatmentshrub    -0.490         0.000       
## floweringbloom:rtusyrphid:treatmentshrub  -0.411         0.000       
##                                           flwrngblm:rtl flwrngblm:rtt
## floweringbloom                                                       
## rtubombylid                                                          
## rtuhoneybee                                                          
## rtulep                                                               
## rtuother                                                             
## rtusyrphid                                                           
## treatmentshrub                                                       
## flowers.pot                                                          
## het.annual.floral.density                                            
## het.shrub.blooming.neighbours                                        
## floweringbloom:rtubombylid                                           
## floweringbloom:rtuhoneybee                                           
## floweringbloom:rtulep                                                
## floweringbloom:rtuother                    0.309                     
## floweringbloom:rtusyrphid                  0.295         0.776       
## floweringbloom:treatmentshrub              0.244         0.642       
## rtubombylid:treatmentshrub                 0.034         0.089       
## rtuhoneybee:treatmentshrub                 0.000         0.000       
## rtulep:treatmentshrub                      0.646         0.026       
## rtuother:treatmentshrub                    0.043         0.239       
## rtusyrphid:treatmentshrub                  0.051         0.135       
## floweringbloom:rtubombylid:treatmentshrub -0.184        -0.483       
## floweringbloom:rtuhoneybee:treatmentshrub  0.000         0.000       
## floweringbloom:rtulep:treatmentshrub      -0.701        -0.217       
## floweringbloom:rtuother:treatmentshrub    -0.217        -0.702       
## floweringbloom:rtusyrphid:treatmentshrub  -0.182        -0.479       
##                                           flwrngblm:rts flwrngblm:t rtbmb:
## floweringbloom                                                            
## rtubombylid                                                               
## rtuhoneybee                                                               
## rtulep                                                                    
## rtuother                                                                  
## rtusyrphid                                                                
## treatmentshrub                                                            
## flowers.pot                                                               
## het.annual.floral.density                                                 
## het.shrub.blooming.neighbours                                             
## floweringbloom:rtubombylid                                                
## floweringbloom:rtuhoneybee                                                
## floweringbloom:rtulep                                                     
## floweringbloom:rtuother                                                   
## floweringbloom:rtusyrphid                                                 
## floweringbloom:treatmentshrub              0.612                          
## rtubombylid:treatmentshrub                 0.085         0.307            
## rtuhoneybee:treatmentshrub                 0.000         0.000       0.000
## rtulep:treatmentshrub                      0.025         0.090       0.112
## rtuother:treatmentshrub                    0.107         0.388       0.484
## rtusyrphid:treatmentshrub                  0.159         0.464       0.579
## floweringbloom:rtubombylid:treatmentshrub -0.461        -0.750      -0.604
## floweringbloom:rtuhoneybee:treatmentshrub  0.000         0.000       0.000
## floweringbloom:rtulep:treatmentshrub      -0.207        -0.336      -0.104
## floweringbloom:rtuother:treatmentshrub    -0.545        -0.886      -0.273
## floweringbloom:rtusyrphid:treatmentshrub  -0.617        -0.743      -0.229
##                                           rthny: rtlp:t rtthr: rtsyr:
## floweringbloom                                                       
## rtubombylid                                                          
## rtuhoneybee                                                          
## rtulep                                                               
## rtuother                                                             
## rtusyrphid                                                           
## treatmentshrub                                                       
## flowers.pot                                                          
## het.annual.floral.density                                            
## het.shrub.blooming.neighbours                                        
## floweringbloom:rtubombylid                                           
## floweringbloom:rtuhoneybee                                           
## floweringbloom:rtulep                                                
## floweringbloom:rtuother                                              
## floweringbloom:rtusyrphid                                            
## floweringbloom:treatmentshrub                                        
## rtubombylid:treatmentshrub                                           
## rtuhoneybee:treatmentshrub                                           
## rtulep:treatmentshrub                      0.000                     
## rtuother:treatmentshrub                    0.000  0.142              
## rtusyrphid:treatmentshrub                  0.000  0.170  0.733       
## floweringbloom:rtubombylid:treatmentshrub  0.000 -0.068 -0.292 -0.350
## floweringbloom:rtuhoneybee:treatmentshrub -0.557  0.000  0.000  0.000
## floweringbloom:rtulep:treatmentshrub       0.000 -0.922 -0.131 -0.157
## floweringbloom:rtuother:treatmentshrub     0.000 -0.080 -0.564 -0.413
## floweringbloom:rtusyrphid:treatmentshrub   0.000 -0.067 -0.290 -0.395
##                                           flwrngblm:rtb: flwrngblm:rth:
## floweringbloom                                                         
## rtubombylid                                                            
## rtuhoneybee                                                            
## rtulep                                                                 
## rtuother                                                               
## rtusyrphid                                                             
## treatmentshrub                                                         
## flowers.pot                                                            
## het.annual.floral.density                                              
## het.shrub.blooming.neighbours                                          
## floweringbloom:rtubombylid                                             
## floweringbloom:rtuhoneybee                                             
## floweringbloom:rtulep                                                  
## floweringbloom:rtuother                                                
## floweringbloom:rtusyrphid                                              
## floweringbloom:treatmentshrub                                          
## rtubombylid:treatmentshrub                                             
## rtuhoneybee:treatmentshrub                                             
## rtulep:treatmentshrub                                                  
## rtuother:treatmentshrub                                                
## rtusyrphid:treatmentshrub                                              
## floweringbloom:rtubombylid:treatmentshrub                              
## floweringbloom:rtuhoneybee:treatmentshrub  0.000                       
## floweringbloom:rtulep:treatmentshrub       0.254          0.000        
## floweringbloom:rtuother:treatmentshrub     0.667          0.000        
## floweringbloom:rtusyrphid:treatmentshrub   0.560          0.000        
##                                           flwrngblm:rtl: flwrngblm:rtt:
## floweringbloom                                                         
## rtubombylid                                                            
## rtuhoneybee                                                            
## rtulep                                                                 
## rtuother                                                               
## rtusyrphid                                                             
## treatmentshrub                                                         
## flowers.pot                                                            
## het.annual.floral.density                                              
## het.shrub.blooming.neighbours                                          
## floweringbloom:rtubombylid                                             
## floweringbloom:rtuhoneybee                                             
## floweringbloom:rtulep                                                  
## floweringbloom:rtuother                                                
## floweringbloom:rtusyrphid                                              
## floweringbloom:treatmentshrub                                          
## rtubombylid:treatmentshrub                                             
## rtuhoneybee:treatmentshrub                                             
## rtulep:treatmentshrub                                                  
## rtuother:treatmentshrub                                                
## rtusyrphid:treatmentshrub                                              
## floweringbloom:rtubombylid:treatmentshrub                              
## floweringbloom:rtuhoneybee:treatmentshrub                              
## floweringbloom:rtulep:treatmentshrub                                   
## floweringbloom:rtuother:treatmentshrub     0.299                       
## floweringbloom:rtusyrphid:treatmentshrub   0.251          0.661        
## 
## Standardized Within-Group Residuals:
##           Min            Q1           Med            Q3           Max 
## -3.063184e+00 -3.918256e-01 -2.324796e-01 -2.523448e-13  1.296016e+01 
## 
## Number of Observations: 1386
## Number of Groups: 
##            PlantID repID %in% PlantID 
##                 61                122</code></pre>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb133-1" title="1">t &lt;-<span class="st"> </span>car<span class="op">::</span><span class="kw">Anova</span>(mFullPQv, <span class="dt">type =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb133-2" title="2"></a>
<a class="sourceLine" id="cb133-3" title="3">m &lt;-<span class="st"> </span>MASS<span class="op">::</span><span class="kw">glmmPQL</span>(total.flowers<span class="op">~</span>flowering <span class="op">*</span><span class="st"> </span>rtu <span class="op">+</span><span class="st"> </span>treatment<span class="op">*</span>flowering <span class="op">+</span><span class="st"> </span>flowers.pot <span class="op">+</span><span class="kw">offset</span>(<span class="kw">log</span>(dec.Length)), <span class="dt">random =</span> <span class="op">~</span><span class="dv">1</span><span class="op">|</span>PlantID<span class="op">/</span>repID, <span class="dt">family=</span><span class="st">&quot;quasipoisson&quot;</span>, <span class="dt">data =</span> byrtu)</a></code></pre></div>
<pre><code>## iteration 1</code></pre>
<pre><code>## iteration 2</code></pre>
<pre><code>## iteration 3</code></pre>
<pre><code>## iteration 4</code></pre>
<pre><code>## iteration 5</code></pre>
<pre><code>## iteration 6</code></pre>
<pre><code>## iteration 7</code></pre>
<pre><code>## iteration 8</code></pre>
<pre><code>## iteration 9</code></pre>
<pre><code>## iteration 10</code></pre>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb144-1" title="1">car<span class="op">::</span><span class="kw">Anova</span>(m, <span class="dt">type =</span> <span class="dv">3</span>)</a></code></pre></div>
<pre><code>## Analysis of Deviance Table (Type III tests)
## 
## Response: total.flowers
##                        Chisq Df Pr(&gt;Chisq)    
## (Intercept)          11.0841  1  0.0008707 ***
## flowering            14.6807  1  0.0001273 ***
## rtu                 192.4197  5  &lt; 2.2e-16 ***
## treatment             4.0995  1  0.0428956 *  
## flowers.pot           7.5923  1  0.0058617 ** 
## flowering:rtu        68.3742  5  2.233e-13 ***
## flowering:treatment   0.0595  1  0.8073099    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb146-1" title="1">mQ &lt;-<span class="st"> </span>MASS<span class="op">::</span><span class="kw">glmmPQL</span>(total.flowers<span class="op">~</span>flowering <span class="op">*</span><span class="st"> </span>rtu <span class="op">+</span><span class="st"> </span>treatment <span class="op">+</span><span class="st"> </span>flowers.pot <span class="op">+</span><span class="st"> </span><span class="kw">offset</span>(<span class="kw">log</span>(dec.Length)), <span class="dt">random =</span> <span class="op">~</span><span class="dv">1</span><span class="op">|</span>PlantID<span class="op">/</span>repID, <span class="dt">family=</span><span class="st">&quot;quasipoisson&quot;</span>, <span class="dt">data =</span> byrtu)</a></code></pre></div>
<pre><code>## iteration 1</code></pre>
<pre><code>## iteration 2</code></pre>
<pre><code>## iteration 3</code></pre>
<pre><code>## iteration 4</code></pre>
<pre><code>## iteration 5</code></pre>
<pre><code>## iteration 6</code></pre>
<pre><code>## iteration 7</code></pre>
<pre><code>## iteration 8</code></pre>
<pre><code>## iteration 9</code></pre>
<pre><code>## iteration 10</code></pre>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb157-1" title="1"><span class="kw">summary</span>(mQ)</a></code></pre></div>
<pre><code>## Linear mixed-effects model fit by maximum likelihood
##  Data: byrtu 
##   AIC BIC logLik
##    NA  NA     NA
## 
## Random effects:
##  Formula: ~1 | PlantID
##         (Intercept)
## StdDev:   0.2505923
## 
##  Formula: ~1 | repID %in% PlantID
##         (Intercept) Residual
## StdDev:   0.5372871 1.775239
## 
## Variance function:
##  Structure: fixed weights
##  Formula: ~invwt 
## Fixed effects: total.flowers ~ flowering * rtu + treatment + flowers.pot + offset(log(dec.Length)) 
##                                 Value Std.Error   DF   t-value p-value
## (Intercept)                 -1.064369      0.32 1276 -3.349236  0.0008
## floweringbloom              -1.731231      0.45 1276 -3.876210  0.0001
## rtubombylid                 -0.807923      0.35 1276 -2.290844  0.0221
## rtuhoneybee                 -2.116256      0.60 1276 -3.543579  0.0004
## rtulep                      -3.725693      1.28 1276 -2.918288  0.0036
## rtuother                     0.145508      0.27 1276  0.544139  0.5864
## rtusyrphid                   1.663378      0.21 1276  7.787977  0.0000
## treatmentshrub              -0.340708      0.16   60 -2.128848  0.0374
## flowers.pot                  0.064550      0.02 1276  2.740821  0.0062
## floweringbloom:rtubombylid   1.683391      0.59 1276  2.846071  0.0045
## floweringbloom:rtuhoneybee -23.267822  78676.26 1276 -0.000296  0.9998
## floweringbloom:rtulep        4.131159      1.38 1276  3.000893  0.0027
## floweringbloom:rtuother      1.749109      0.50 1276  3.466512  0.0005
## floweringbloom:rtusyrphid   -1.326906      0.56 1276 -2.351352  0.0189
##  Correlation: 
##                            (Intr) flwrng rtbmby rthnyb rtulep rtuthr
## floweringbloom             -0.213                                   
## rtubombylid                -0.342  0.243                            
## rtuhoneybee                -0.202  0.144  0.182                     
## rtulep                     -0.095  0.067  0.085  0.050              
## rtuother                   -0.451  0.321  0.407  0.240  0.112       
## rtusyrphid                 -0.565  0.402  0.509  0.301  0.141  0.671
## treatmentshrub             -0.246 -0.003  0.000  0.000  0.000  0.000
## flowers.pot                -0.727 -0.082  0.000  0.000  0.000  0.000
## floweringbloom:rtubombylid  0.204 -0.748 -0.596 -0.109 -0.051 -0.242
## floweringbloom:rtuhoneybee  0.000  0.000  0.000  0.000  0.000  0.000
## floweringbloom:rtulep       0.088 -0.321 -0.079 -0.047 -0.927 -0.104
## floweringbloom:rtuother     0.239 -0.876 -0.216 -0.127 -0.060 -0.530
## floweringbloom:rtusyrphid   0.214 -0.784 -0.193 -0.114 -0.053 -0.254
##                            rtsyrp trtmnt flwrs. flwrngblm:rtb
## floweringbloom                                               
## rtubombylid                                                  
## rtuhoneybee                                                  
## rtulep                                                       
## rtuother                                                     
## rtusyrphid                                                   
## treatmentshrub              0.000                            
## flowers.pot                 0.000  0.027                     
## floweringbloom:rtubombylid -0.304  0.000  0.000              
## floweringbloom:rtuhoneybee  0.000  0.000  0.000  0.000       
## floweringbloom:rtulep      -0.130  0.000  0.000  0.243       
## floweringbloom:rtuother    -0.356  0.000  0.000  0.662       
## floweringbloom:rtusyrphid  -0.378  0.000  0.000  0.592       
##                            flwrngblm:rth flwrngblm:rtl flwrngblm:rtt
## floweringbloom                                                      
## rtubombylid                                                         
## rtuhoneybee                                                         
## rtulep                                                              
## rtuother                                                            
## rtusyrphid                                                          
## treatmentshrub                                                      
## flowers.pot                                                         
## floweringbloom:rtubombylid                                          
## floweringbloom:rtuhoneybee                                          
## floweringbloom:rtulep       0.000                                   
## floweringbloom:rtuother     0.000         0.284                     
## floweringbloom:rtusyrphid   0.000         0.254         0.694       
## 
## Standardized Within-Group Residuals:
##         Min          Q1         Med          Q3         Max 
## -2.53323480 -0.35080887 -0.21658404 -0.04776788 17.09065961 
## 
## Number of Observations: 1410
## Number of Groups: 
##            PlantID repID %in% PlantID 
##                 61                122</code></pre>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb159-1" title="1"><span class="kw">lsmeans</span>(mQ, pairwise<span class="op">~</span>flowering<span class="op">|</span>rtu, <span class="dt">adjust =</span> <span class="st">&quot;Tukey&quot;</span>)</a></code></pre></div>
<pre><code>## $lsmeans
## rtu = bee:
##  flowering  lsmean       SE df  lower.CL  upper.CL
##  pre        -0.310     0.21 60 -7.20e-01      0.10
##  bloom      -2.042     0.41 60 -2.85e+00     -1.23
## 
## rtu = bombylid:
##  flowering  lsmean       SE df  lower.CL  upper.CL
##  pre        -1.118     0.30 60 -1.72e+00     -0.52
##  bloom      -1.166     0.27 60 -1.70e+00     -0.63
## 
## rtu = honeybee:
##  flowering  lsmean       SE df  lower.CL  upper.CL
##  pre        -2.427     0.57 60 -3.56e+00     -1.29
##  bloom     -27.426 78676.26 60 -1.57e+05 157348.52
## 
## rtu = lep:
##  flowering  lsmean       SE df  lower.CL  upper.CL
##  pre        -4.036     1.26 60 -6.56e+00     -1.51
##  bloom      -1.636     0.33 60 -2.30e+00     -0.97
## 
## rtu = other:
##  flowering  lsmean       SE df  lower.CL  upper.CL
##  pre        -0.165     0.19 60 -5.50e-01      0.22
##  bloom      -0.147     0.17 60 -4.90e-01      0.19
## 
## rtu = syrphid:
##  flowering  lsmean       SE df  lower.CL  upper.CL
##  pre         1.353     0.11 60  1.14e+00      1.57
##  bloom      -1.705     0.34 60 -2.39e+00     -1.02
## 
## Results are averaged over the levels of: treatment 
## Degrees-of-freedom method: containment 
## Results are given on the log (not the response) scale. 
## Confidence level used: 0.95 
## 
## $contrasts
## rtu = bee:
##  contrast    estimate       SE   df t.ratio p.value
##  pre - bloom   1.7312     0.45 1276  3.876  0.0001 
## 
## rtu = bombylid:
##  contrast    estimate       SE   df t.ratio p.value
##  pre - bloom   0.0478     0.39 1276  0.122  0.9031 
## 
## rtu = honeybee:
##  contrast    estimate       SE   df t.ratio p.value
##  pre - bloom  24.9991 78676.26 1276  0.000  0.9997 
## 
## rtu = lep:
##  contrast    estimate       SE   df t.ratio p.value
##  pre - bloom  -2.3999     1.30 1276 -1.841  0.0659 
## 
## rtu = other:
##  contrast    estimate       SE   df t.ratio p.value
##  pre - bloom  -0.0179     0.24 1276 -0.074  0.9414 
## 
## rtu = syrphid:
##  contrast    estimate       SE   df t.ratio p.value
##  pre - bloom   3.0581     0.35 1276  8.723  &lt;.0001 
## 
## Results are averaged over the levels of: treatment 
## Degrees-of-freedom method: containment 
## Results are given on the log (not the response) scale.</code></pre>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb161-1" title="1">car<span class="op">::</span><span class="kw">Anova</span>(mQ, <span class="dt">type =</span> <span class="dv">3</span>)</a></code></pre></div>
<pre><code>## Analysis of Deviance Table (Type III tests)
## 
## Response: total.flowers
##                  Chisq Df Pr(&gt;Chisq)    
## (Intercept)    11.3299  1  0.0007627 ***
## flowering      15.1757  1  9.796e-05 ***
## rtu           192.9482  5  &lt; 2.2e-16 ***
## treatment       4.5774  1  0.0323955 *  
## flowers.pot     7.5874  1  0.0058776 ** 
## flowering:rtu  68.5620  5  2.041e-13 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb163-1" title="1">mQt &lt;-<span class="st"> </span>MASS<span class="op">::</span><span class="kw">glmmPQL</span>(total.flowers<span class="op">~</span>treatment <span class="op">*</span><span class="st"> </span>rtu <span class="op">+</span><span class="st"> </span>flowering <span class="op">+</span><span class="st"> </span>flowers.pot <span class="op">+</span><span class="st"> </span><span class="kw">offset</span>(<span class="kw">log</span>(dec.Length)), <span class="dt">random =</span> <span class="op">~</span><span class="dv">1</span><span class="op">|</span>PlantID<span class="op">/</span>repID, <span class="dt">family=</span><span class="st">&quot;quasipoisson&quot;</span>, <span class="dt">data =</span> byrtu)</a></code></pre></div>
<pre><code>## iteration 1</code></pre>
<pre><code>## iteration 2</code></pre>
<pre><code>## iteration 3</code></pre>
<pre><code>## iteration 4</code></pre>
<pre><code>## iteration 5</code></pre>
<pre><code>## iteration 6</code></pre>
<pre><code>## iteration 7</code></pre>
<pre><code>## iteration 8</code></pre>
<pre><code>## iteration 9</code></pre>
<pre><code>## iteration 10</code></pre>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb174-1" title="1"><span class="kw">summary</span>(mQt)</a></code></pre></div>
<pre><code>## Linear mixed-effects model fit by maximum likelihood
##  Data: byrtu 
##   AIC BIC logLik
##    NA  NA     NA
## 
## Random effects:
##  Formula: ~1 | PlantID
##         (Intercept)
## StdDev:   0.2433783
## 
##  Formula: ~1 | repID %in% PlantID
##         (Intercept) Residual
## StdDev:    0.522491 1.857319
## 
## Variance function:
##  Structure: fixed weights
##  Formula: ~invwt 
## Fixed effects: total.flowers ~ treatment * rtu + flowering + flowers.pot + offset(log(dec.Length)) 
##                                 Value Std.Error   DF   t-value p-value
## (Intercept)                 -1.013940      0.34 1276 -3.015931  0.0026
## treatmentshrub              -0.770960      0.41   60 -1.862202  0.0675
## rtubombylid                 -0.405465      0.35 1276 -1.165726  0.2439
## rtuhoneybee                -26.652111  81784.60 1276 -0.000326  0.9997
## rtulep                      -1.280934      0.47 1276 -2.714943  0.0067
## rtuother                     0.567521      0.28 1276  2.060963  0.0395
## rtusyrphid                   1.396657      0.25 1276  5.684548  0.0000
## floweringbloom              -1.249935      0.14 1276 -8.691456  0.0000
## flowers.pot                  0.064194      0.02 1276  2.653347  0.0081
## treatmentshrub:rtubombylid   0.582396      0.57 1276  1.017616  0.3091
## treatmentshrub:rtuhoneybee  25.520709  81784.60 1276  0.000312  0.9998
## treatmentshrub:rtulep        0.331853      0.79 1276  0.419647  0.6748
## treatmentshrub:rtuother      0.623465      0.47 1276  1.322098  0.1864
## treatmentshrub:rtusyrphid    0.334142      0.44 1276  0.761244  0.4467
##  Correlation: 
##                            (Intr) trtmnt rtbmby rthnyb rtulep rtuthr
## treatmentshrub             -0.395                                   
## rtubombylid                -0.414  0.336                            
## rtuhoneybee                 0.000  0.000  0.000                     
## rtulep                     -0.305  0.248  0.295  0.000              
## rtuother                   -0.523  0.424  0.505  0.000  0.372       
## rtusyrphid                 -0.586  0.476  0.566  0.000  0.417  0.715
## floweringbloom              0.066 -0.004  0.000  0.000  0.000  0.000
## flowers.pot                -0.707  0.011  0.000  0.000  0.000  0.000
## treatmentshrub:rtubombylid  0.252 -0.679 -0.608  0.000 -0.179 -0.307
## treatmentshrub:rtuhoneybee  0.000  0.000  0.000 -1.000  0.000  0.000
## treatmentshrub:rtulep       0.182 -0.491 -0.176  0.000 -0.597 -0.222
## treatmentshrub:rtuother     0.305 -0.824 -0.295  0.000 -0.218 -0.584
## treatmentshrub:rtusyrphid   0.328 -0.885 -0.317  0.000 -0.234 -0.400
##                            rtsyrp flwrng flwrs. trtmntshrb:rtb
## treatmentshrub                                                
## rtubombylid                                                   
## rtuhoneybee                                                   
## rtulep                                                        
## rtuother                                                      
## rtusyrphid                                                    
## floweringbloom              0.000                             
## flowers.pot                 0.000 -0.256                      
## treatmentshrub:rtubombylid -0.344  0.000  0.000               
## treatmentshrub:rtuhoneybee  0.000  0.000  0.000  0.000        
## treatmentshrub:rtulep      -0.249  0.000  0.000  0.355        
## treatmentshrub:rtuother    -0.418  0.000  0.000  0.596        
## treatmentshrub:rtusyrphid  -0.560  0.000  0.000  0.640        
##                            trtmntshrb:rth trtmntshrb:rtl trtmntshrb:rtt
## treatmentshrub                                                         
## rtubombylid                                                            
## rtuhoneybee                                                            
## rtulep                                                                 
## rtuother                                                               
## rtusyrphid                                                             
## floweringbloom                                                         
## flowers.pot                                                            
## treatmentshrub:rtubombylid                                             
## treatmentshrub:rtuhoneybee                                             
## treatmentshrub:rtulep       0.000                                      
## treatmentshrub:rtuother     0.000          0.431                       
## treatmentshrub:rtusyrphid   0.000          0.463          0.777        
## 
## Standardized Within-Group Residuals:
##        Min         Q1        Med         Q3        Max 
## -2.1079350 -0.3769598 -0.2163581 -0.0897138 13.6044704 
## 
## Number of Observations: 1410
## Number of Groups: 
##            PlantID repID %in% PlantID 
##                 61                122</code></pre>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb176-1" title="1"><span class="co">#RTU by microsite not significant</span></a></code></pre></div>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb177-1" title="1"><span class="kw">str</span>(byrtu)</a></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    1410 obs. of  23 variables:
##  $ X                             : int  1 2 3 4 5 6 7 8 9 10 ...
##  $ PlantID                       : Factor w/ 61 levels &quot;104&quot;,&quot;114&quot;,&quot;146&quot;,..: 3 3 3 3 3 3 3 3 3 3 ...
##  $ treatment                     : Factor w/ 2 levels &quot;open&quot;,&quot;shrub&quot;: 1 1 1 1 1 1 2 2 2 2 ...
##  $ flowering                     : Factor w/ 2 levels &quot;pre&quot;,&quot;bloom&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ Date                          : Factor w/ 20 levels &quot;4.10.2017&quot;,&quot;4.11.2017&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
##  $ TimeOut                       : Factor w/ 99 levels &quot;&quot;,&quot;10:48&quot;,&quot;10:57&quot;,..: 58 58 58 58 58 58 58 58 58 58 ...
##  $ flowers.shrub                 : int  0 0 0 0 0 0 0 0 0 0 ...
##  $ flowers.pot                   : int  18 18 18 18 18 18 11 11 11 11 ...
##  $ het.shrub.blooming.neighbours : int  0 0 0 0 0 0 0 0 0 0 ...
##  $ het.cactus.blooming.neighbours: int  0 0 0 0 0 0 0 0 0 0 ...
##  $ understory.richness           : int  5 5 5 5 5 5 3 3 3 3 ...
##  $ het.annual.floral.density     : int  0 0 0 0 0 0 1 1 1 1 ...
##  $ understory.assoc              : Factor w/ 11 levels &quot;&quot;,&quot;?&quot;,&quot;acamp&quot;,..: 8 8 8 8 8 8 8 8 8 8 ...
##  $ uniID                         : Factor w/ 235 levels &quot;LO14.10.2017&quot;,..: 1 1 1 1 1 1 117 117 117 117 ...
##  $ rtu                           : Factor w/ 6 levels &quot;bee&quot;,&quot;bombylid&quot;,..: 6 1 5 2 4 3 6 1 5 2 ...
##  $ total.visits                  : int  18 2 0 0 0 0 6 1 0 0 ...
##  $ total.flowers                 : int  35 5 0 0 0 0 8 2 0 0 ...
##  $ Length                        : Factor w/ 225 levels &quot;0:31:34&quot;,&quot;0:32:53&quot;,..: 120 120 120 120 120 120 185 185 185 185 ...
##  $ pos.Length                    : Factor w/ 225 levels &quot;2019-09-24 00:31:34&quot;,..: 120 120 120 120 120 120 185 185 185 185 ...
##  $ dec.Length                    : num  1.38 1.38 1.38 1.38 1.38 ...
##  $ visits.per.hour               : num  13.04 1.45 0 0 0 ...
##  $ flowers.per.hour              : num  25.35 3.62 0 0 0 ...
##  $ repID                         : chr  &quot;146 open&quot; &quot;146 open&quot; &quot;146 open&quot; &quot;146 open&quot; ...</code></pre>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb179-1" title="1">p &lt;-<span class="st"> </span>byrtu <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(treatment, flowering, rtu) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">summarise</span>(<span class="dt">visits =</span> <span class="kw">sum</span>(flowers.per.hour))</a>
<a class="sourceLine" id="cb179-2" title="2"></a>
<a class="sourceLine" id="cb179-3" title="3"><span class="kw">ggplot</span>(p, <span class="kw">aes</span>(treatment, visits)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> rtu), <span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">facet_grid</span>(<span class="op">~</span>flowering, <span class="dt">labeller=</span><span class="kw">labeller</span>(<span class="dt">flowering =</span> labels))<span class="op">+</span><span class="st"> </span><span class="kw">theme_Publication</span>() <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Microsite&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Total Flowers Visited&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">fill=</span><span class="st">&quot;&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">16</span>))  <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_brewer</span>(<span class="dt">palette=</span> <span class="st">&quot;Spectral&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_manual</span>(<span class="st">&quot;&quot;</span>, <span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;bee&quot;</span> =<span class="st">&quot;#D53E4F&quot;</span>, <span class="st">&quot;bombylid&quot;</span>=<span class="st"> &quot;#FC8D59&quot;</span>, <span class="st">&quot;honeybee&quot;</span>=<span class="st"> &quot;#FEE08B&quot;</span>, <span class="st">&quot;lep&quot;</span>=<span class="st"> &quot;#D3D3D3&quot;</span>, <span class="st">&quot;other&quot;</span>=<span class="st"> &quot;#99D594&quot;</span>, <span class="st">&quot;syrphid&quot;</span> =<span class="st"> &quot;#3288BD&quot;</span>), <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Solitary Bee&quot;</span>, <span class="st">&quot;Bombyliidae&quot;</span>, <span class="st">&quot;Honeybee&quot;</span>, <span class="st">&quot;Lepidoptera&quot;</span>, <span class="st">&quot;Other&quot;</span>, <span class="st">&quot;Syrphidae&quot;</span>))</a></code></pre></div>
<pre><code>## 
## Attaching package: &#39;ggthemes&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:cowplot&#39;:
## 
##     theme_map</code></pre>
<pre><code>## Scale for &#39;fill&#39; is already present. Adding another scale for &#39;fill&#39;,
## which will replace the existing scale.</code></pre>
<p><img src="index_files/figure-html/rtu%20plots-1.png" width="672" /></p>
</div>
<div id="visit-duration" class="section level3">
<h3>Visit duration</h3>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb183-1" title="1">byobs &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;Output Data/byobs_cleaned.csv&quot;</span>)</a>
<a class="sourceLine" id="cb183-2" title="2"></a>
<a class="sourceLine" id="cb183-3" title="3"><span class="co">#observation level rtu data. Need to join simplified rtu to data sheet</span></a>
<a class="sourceLine" id="cb183-4" title="4">cov &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;Clean Data/video_cov.csv&quot;</span>)</a>
<a class="sourceLine" id="cb183-5" title="5"><span class="co">#rtu.key &lt;- read.csv(&quot;Clean Data/video_rtu_key.csv&quot;)</span></a>
<a class="sourceLine" id="cb183-6" title="6">cov<span class="op">$</span>uniID &lt;-<span class="st"> </span><span class="kw">paste</span>(cov<span class="op">$</span>Cam, cov<span class="op">$</span>Date)</a>
<a class="sourceLine" id="cb183-7" title="7">cov<span class="op">$</span>uniID &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;</span><span class="ch">\\</span><span class="st">s+&#39;</span>, <span class="st">&quot;&quot;</span>, cov<span class="op">$</span>uniID)</a>
<a class="sourceLine" id="cb183-8" title="8"></a>
<a class="sourceLine" id="cb183-9" title="9">rtu.data &lt;-<span class="st"> </span><span class="kw">right_join</span>(cov, byobs, <span class="dt">by =</span> <span class="st">&quot;uniID&quot;</span>)</a></code></pre></div>
<pre><code>## Warning: Column `uniID` joining character vector and factor, coercing into
## character vector</code></pre>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb185-1" title="1">rtu.data &lt;-<span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(rtu.data, plant.id, microsite, flowering.x, video.date, video.length, flower.fov, flowers.pot, total.time, flowers.visits, unique.fl.visited, uniID, dec.total.time, het.annual.floral.density)                    </a>
<a class="sourceLine" id="cb185-2" title="2">rtu.data<span class="op">$</span>repID &lt;-<span class="st"> </span><span class="kw">paste</span>(rtu.data<span class="op">$</span>plant.id, rtu.data<span class="op">$</span>microsite)</a>
<a class="sourceLine" id="cb185-3" title="3">rtu.data<span class="op">$</span>microsite &lt;-<span class="kw">as.factor</span>(rtu.data<span class="op">$</span>microsite)</a>
<a class="sourceLine" id="cb185-4" title="4">rtu.data<span class="op">$</span>microsite &lt;-<span class="st"> </span><span class="kw">relevel</span>(rtu.data<span class="op">$</span>microsite, <span class="st">&quot;open&quot;</span>)</a>
<a class="sourceLine" id="cb185-5" title="5">rtu.data<span class="op">$</span>flowering &lt;-<span class="st"> </span><span class="kw">relevel</span>(rtu.data<span class="op">$</span>flowering, <span class="st">&quot;pre&quot;</span>)</a>
<a class="sourceLine" id="cb185-6" title="6">rtu.data<span class="op">$</span>flowers.pot &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">as.character</span>(rtu.data<span class="op">$</span>flowers.pot))</a>
<a class="sourceLine" id="cb185-7" title="7"><span class="co">#count.rtu.fl &lt;- rtu.data %&gt;% group_by(uniID, rtu.ag) %&gt;% summarise(total.flowers = sum(flowers.visits), total.visits = n()) </span></a>
<a class="sourceLine" id="cb185-8" title="8"></a>
<a class="sourceLine" id="cb185-9" title="9"><span class="co">#viz. dec.total.time is the visit duration</span></a>
<a class="sourceLine" id="cb185-10" title="10"><span class="kw">ggplot</span>(rtu.data, <span class="kw">aes</span>(microsite, dec.total.time)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_boxplot</span>() <span class="op">+</span><span class="st"> </span><span class="kw">facet_grid</span>(<span class="op">~</span>flowering)</a></code></pre></div>
<pre><code>## Warning: Removed 1 rows containing non-finite values (stat_boxplot).</code></pre>
<p><img src="index_files/figure-html/duration%20models-1.png" width="672" /></p>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb187-1" title="1"><span class="kw">ggplot</span>(rtu.data, <span class="kw">aes</span>(flowering, dec.total.time)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_boxplot</span>() <span class="op">+</span><span class="st"> </span><span class="kw">facet_grid</span>(<span class="op">~</span>microsite)</a></code></pre></div>
<pre><code>## Warning: Removed 1 rows containing non-finite values (stat_boxplot).</code></pre>
<p><img src="index_files/figure-html/duration%20models-2.png" width="672" /></p>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb189-1" title="1"><span class="kw">ggplot</span>(rtu.data, <span class="kw">aes</span>(dec.total.time)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_density</span>()</a></code></pre></div>
<pre><code>## Warning: Removed 1 rows containing non-finite values (stat_density).</code></pre>
<p><img src="index_files/figure-html/duration%20models-3.png" width="672" /></p>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb191-1" title="1"><span class="co">#using gamma because continuous and positive with no zeros, looks like it fits </span></a>
<a class="sourceLine" id="cb191-2" title="2"></a>
<a class="sourceLine" id="cb191-3" title="3">m1 &lt;-<span class="st"> </span><span class="kw">glmmTMB</span>(dec.total.time <span class="op">~</span><span class="st"> </span>flowering <span class="op">+</span><span class="st"> </span>microsite <span class="op">+</span><span class="st"> </span>flowers.pot <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>plant.id<span class="op">/</span>repID), <span class="dt">family =</span> <span class="kw">Gamma</span>(<span class="dt">link =</span> <span class="st">&quot;log&quot;</span>), <span class="dt">data =</span> rtu.data)</a>
<a class="sourceLine" id="cb191-4" title="4"><span class="kw">summary</span>(m1)</a></code></pre></div>
<pre><code>##  Family: Gamma  ( log )
## Formula:          
## dec.total.time ~ flowering + microsite + flowers.pot + (1 | plant.id/repID)
## Data: rtu.data
## 
##      AIC      BIC   logLik deviance df.resid 
##  -3613.5  -3581.7   1813.7  -3627.5      689 
## 
## Random effects:
## 
## Conditional model:
##  Groups         Name        Variance Std.Dev.
##  repID:plant.id (Intercept) 0.92479  0.9617  
##  plant.id       (Intercept) 0.02743  0.1656  
## Number of obs: 696, groups:  repID:plant.id, 118; plant.id, 61
## 
## Dispersion estimate for Gamma family (sigma^2): 2.02 
## 
## Conditional model:
##                 Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)    -3.259677   0.344342  -9.466  &lt; 2e-16 ***
## floweringbloom -0.762170   0.173386  -4.396  1.1e-05 ***
## micrositeshrub -0.024950   0.232588  -0.107    0.915    
## flowers.pot    -0.002081   0.030706  -0.068    0.946    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb193-1" title="1">car<span class="op">::</span><span class="kw">Anova</span>(m1, <span class="dt">type =</span><span class="dv">2</span>)</a></code></pre></div>
<pre><code>## Analysis of Deviance Table (Type II Wald chisquare tests)
## 
## Response: dec.total.time
##               Chisq Df Pr(&gt;Chisq)    
## flowering   19.3231  1  1.104e-05 ***
## microsite    0.0115  1     0.9146    
## flowers.pot  0.0046  1     0.9460    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb195-1" title="1">m2 &lt;-<span class="st"> </span><span class="kw">glmmTMB</span>(dec.total.time <span class="op">~</span><span class="st"> </span>flowering <span class="op">*</span><span class="st"> </span>microsite <span class="op">+</span><span class="st"> </span>flowers.pot <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>plant.id<span class="op">/</span>repID), <span class="dt">family =</span> <span class="kw">Gamma</span>(<span class="dt">link =</span> <span class="st">&quot;log&quot;</span>), <span class="dt">data =</span> rtu.data)</a>
<a class="sourceLine" id="cb195-2" title="2">car<span class="op">::</span><span class="kw">Anova</span>(m2, <span class="dt">type =</span> <span class="dv">3</span>)</a></code></pre></div>
<pre><code>## Analysis of Deviance Table (Type III Wald chisquare tests)
## 
## Response: dec.total.time
##                       Chisq Df Pr(&gt;Chisq)    
## (Intercept)         93.9925  1    &lt; 2e-16 ***
## flowering            5.9348  1    0.01484 *  
## microsite            0.2376  1    0.62593    
## flowers.pot          0.0005  1    0.98280    
## flowering:microsite  2.0966  1    0.14762    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb197-1" title="1">m3 &lt;-<span class="st"> </span><span class="kw">glmmTMB</span>(dec.total.time <span class="op">~</span><span class="st"> </span>flowering <span class="op">+</span><span class="st"> </span>microsite <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>plant.id<span class="op">/</span>repID), <span class="dt">family =</span> <span class="kw">Gamma</span>(<span class="dt">link =</span> <span class="st">&quot;log&quot;</span>), <span class="dt">data =</span> rtu.data)</a>
<a class="sourceLine" id="cb197-2" title="2">car<span class="op">::</span><span class="kw">Anova</span>(m3, <span class="dt">type =</span> <span class="dv">2</span>)</a></code></pre></div>
<pre><code>## Analysis of Deviance Table (Type II Wald chisquare tests)
## 
## Response: dec.total.time
##             Chisq Df Pr(&gt;Chisq)    
## flowering 20.1027  1  7.339e-06 ***
## microsite  0.0113  1     0.9154    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb199-1" title="1">null &lt;-<span class="st"> </span><span class="kw">glmmTMB</span>(dec.total.time <span class="op">~</span>(<span class="dv">1</span><span class="op">|</span>plant.id<span class="op">/</span>repID), <span class="dt">family =</span> <span class="kw">Gamma</span>(<span class="dt">link =</span> <span class="st">&quot;log&quot;</span>), <span class="dt">data =</span> rtu.data)</a>
<a class="sourceLine" id="cb199-2" title="2"><span class="kw">anova</span>(m1, m2, m3, null)</a></code></pre></div>
<pre><code>## Data: rtu.data
## Models:
## null: dec.total.time ~ (1 | plant.id/repID), zi=~0, disp=~1
## m3: dec.total.time ~ flowering + microsite + (1 | plant.id/repID), zi=~0, disp=~1
## m1: dec.total.time ~ flowering + microsite + flowers.pot + (1 | plant.id/repID), zi=~0, disp=~1
## m2: dec.total.time ~ flowering * microsite + flowers.pot + (1 | plant.id/repID), zi=~0, disp=~1
##      Df     AIC     BIC logLik deviance   Chisq Chi Df Pr(&gt;Chisq)    
## null  4 -3600.4 -3582.2 1804.2  -3608.4                              
## m3    6 -3615.5 -3588.2 1813.8  -3627.5 19.0691      2  7.231e-05 ***
## m1    7 -3613.5 -3581.7 1813.8  -3627.5  0.0046      1     0.9459    
## m2    8 -3613.6 -3577.2 1814.8  -3629.6  2.0831      1     0.1489    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb201-1" title="1"><span class="co">#with covariates</span></a>
<a class="sourceLine" id="cb201-2" title="2">m4 &lt;-<span class="st"> </span><span class="kw">glmmTMB</span>(dec.total.time <span class="op">~</span><span class="st"> </span>flowering <span class="op">+</span><span class="st"> </span>microsite <span class="op">+</span><span class="st"> </span>flowers.pot <span class="op">+</span><span class="st"> </span>het.annual.floral.density <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>plant.id<span class="op">/</span>repID), <span class="dt">family =</span> <span class="kw">Gamma</span>(<span class="dt">link =</span> <span class="st">&quot;log&quot;</span>), <span class="dt">data =</span> rtu.data)</a>
<a class="sourceLine" id="cb201-3" title="3"><span class="kw">summary</span>(m4)</a></code></pre></div>
<pre><code>##  Family: Gamma  ( log )
## Formula:          
## dec.total.time ~ flowering + microsite + flowers.pot + het.annual.floral.density +  
##     (1 | plant.id/repID)
## Data: rtu.data
## 
##      AIC      BIC   logLik deviance df.resid 
##  -3583.9  -3547.6   1800.0  -3599.9      681 
## 
## Random effects:
## 
## Conditional model:
##  Groups         Name        Variance Std.Dev.
##  repID:plant.id (Intercept) 0.88927  0.9430  
##  plant.id       (Intercept) 0.01174  0.1083  
## Number of obs: 689, groups:  repID:plant.id, 118; plant.id, 61
## 
## Dispersion estimate for Gamma family (sigma^2): 2.03 
## 
## Conditional model:
##                            Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)               -3.085184   0.356193  -8.662  &lt; 2e-16 ***
## floweringbloom            -0.855040   0.178792  -4.782 1.73e-06 ***
## micrositeshrub            -0.045905   0.230861  -0.199    0.842    
## flowers.pot               -0.009357   0.031158  -0.300    0.764    
## het.annual.floral.density -0.046941   0.021494  -2.184    0.029 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb203-1" title="1">car<span class="op">::</span><span class="kw">Anova</span>(m4, <span class="dt">type =</span> <span class="dv">2</span>)</a></code></pre></div>
<pre><code>## Analysis of Deviance Table (Type II Wald chisquare tests)
## 
## Response: dec.total.time
##                             Chisq Df Pr(&gt;Chisq)    
## flowering                 22.8704  1  1.733e-06 ***
## microsite                  0.0395  1    0.84239    
## flowers.pot                0.0902  1    0.76393    
## het.annual.floral.density  4.7694  1    0.02897 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb205-1" title="1"><span class="kw">AIC</span>(m1, m2, m3, null)</a></code></pre></div>
<pre><code>##      df       AIC
## m1    7 -3613.498
## m2    8 -3613.581
## m3    6 -3615.494
## null  4 -3600.425</code></pre>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb207-1" title="1">labels &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dt">pre =</span> <span class="st">&quot;Pre-blooming&quot;</span>, <span class="dt">post =</span> <span class="st">&quot;Blooming&quot;</span>, <span class="dt">bloom =</span> <span class="st">&quot;Blooming&quot;</span>)</a>
<a class="sourceLine" id="cb207-2" title="2"></a>
<a class="sourceLine" id="cb207-3" title="3"><span class="co">#filter(rtu.data, dec.total.time&lt;1.5) %&gt;% ggplot(aes(microsite, dec.total.time, fill = rtu.ag)) + geom_boxplot() + facet_grid(~flowering, labeller=labeller(flowering = labels)) + scale_fill_brewer(palette= &quot;Spectral&quot;) + theme_Publication() + xlab(&quot;Microsite&quot;) + ylab(&quot;Duration of visit (decimal time)&quot;) + labs(fill=&quot;&quot;) + theme(legend.text = element_text(size = 16)) + scale_fill_manual(&quot;&quot;, values = c(&quot;bee&quot; =&quot;#D53E4F&quot;, &quot;bombylid&quot;= &quot;#FC8D59&quot;, &quot;honeybee&quot;= &quot;#FEE08B&quot;, &quot;lep&quot;= &quot;#D3D3D3&quot;, &quot;other&quot;= &quot;#99D594&quot;, &quot;syrphid&quot; = &quot;#3288BD&quot;), labels = c(&quot;Solitary Bee&quot;, &quot;Bombyliidae&quot;, &quot;Honeybee&quot;, &quot;Lepidoptera&quot;, &quot;Other&quot;, &quot;Syrphidae&quot;))</span></a></code></pre></div>
<p>#ggplot(rtu.data, aes(microsite, prop.visited, fill = rtu.ag)) + geom_boxplot() + facet_grid(~flowering, labeller=labeller(flowering = labels)) + scale_fill_brewer(palette= “Spectral”) + theme_Publication() + xlab(“Microsite”) + ylab(“Proportion of flowers visited”) + labs(fill="“) + theme(legend.text = element_text(size = 16)) + scale_fill_manual(”“, values = c(”bee" =“#D53E4F”, “bombylid”= “#FC8D59”, “honeybee”= “#FEE08B”, “lep”= “#D3D3D3”, “other”= “#99D594”, “syrphid” = “#3288BD”), labels = c(“Solitary Bee”, “Bombyliidae”, “Honeybee”, “Lepidoptera”, “Other”, “Syrphidae”)) ```</p>
<p>###Pollen Deposition</p>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb208-1" title="1">counts &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;Clean Data/Pollen_Corrected.csv&quot;</span>)</a>
<a class="sourceLine" id="cb208-2" title="2">cov &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;Clean Data/pollen_cov.csv&quot;</span>)</a>
<a class="sourceLine" id="cb208-3" title="3">counts<span class="op">$</span>X &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">as.character</span>(counts<span class="op">$</span>X))   </a></code></pre></div>
<pre><code>## Warning: NAs introduced by coercion</code></pre>
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb210-1" title="1">counts &lt;-<span class="st"> </span>counts <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">replace</span>(<span class="kw">is.na</span>(.), <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb210-2" title="2">counts &lt;-<span class="st"> </span>counts <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">all.con =</span> <span class="kw">rowSums</span>(.[<span class="dv">5</span><span class="op">:</span><span class="dv">18</span>]))</a>
<a class="sourceLine" id="cb210-3" title="3">counts &lt;-<span class="st"> </span><span class="kw">select</span>(counts, Rep<span class="op">:</span>Het.Grains, all.con)                </a>
<a class="sourceLine" id="cb210-4" title="4">counts.ag &lt;-<span class="st"> </span>counts <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(Rep, Slide) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarise</span>(<span class="dt">Het =</span> <span class="kw">sum</span>(Het.Grains), <span class="dt">Con =</span> <span class="kw">sum</span>(all.con))             </a>
<a class="sourceLine" id="cb210-5" title="5">counts.ag &lt;-<span class="st"> </span>counts.ag <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(., <span class="dt">microsite =</span> <span class="kw">ifelse</span>(<span class="kw">substr</span>(Rep,<span class="dt">start =</span> <span class="dv">1</span>, <span class="dt">stop =</span> <span class="dv">1</span>) <span class="op">==</span><span class="st"> &quot;S&quot;</span>, <span class="st">&quot;shrub&quot;</span>, <span class="st">&quot;open&quot;</span>))</a>
<a class="sourceLine" id="cb210-6" title="6">counts.ag<span class="op">$</span>Flower &lt;-<span class="st"> </span><span class="kw">substr</span>(counts.ag<span class="op">$</span>Slide, <span class="dv">1</span>, <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb210-7" title="7"></a>
<a class="sourceLine" id="cb210-8" title="8"><span class="kw">sum</span>(counts.ag<span class="op">$</span>Con)</a></code></pre></div>
<pre><code>## [1] 16209</code></pre>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb212-1" title="1"><span class="kw">sum</span>(counts.ag<span class="op">$</span>Het)</a></code></pre></div>
<pre><code>## [1] 1719</code></pre>
<div class="sourceCode" id="cb214"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb214-1" title="1">counts.ag &lt;-<span class="st"> </span><span class="kw">right_join</span>(counts.ag, cov, <span class="dt">by =</span> <span class="st">&quot;Rep&quot;</span>)</a>
<a class="sourceLine" id="cb214-2" title="2"></a>
<a class="sourceLine" id="cb214-3" title="3"><span class="co">#ag by flower</span></a>
<a class="sourceLine" id="cb214-4" title="4">count.fl &lt;-<span class="st"> </span>counts.ag <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(., Flower) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarise</span>(<span class="dt">con =</span> <span class="kw">sum</span>(Con))</a>
<a class="sourceLine" id="cb214-5" title="5">count.fl<span class="op">$</span>f2 &lt;-<span class="st"> </span>count.fl<span class="op">$</span>Flower</a>
<a class="sourceLine" id="cb214-6" title="6"></a>
<a class="sourceLine" id="cb214-7" title="7">count.fl &lt;-<span class="st"> </span>count.fl <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb214-8" title="8"><span class="st">  </span><span class="kw">separate</span>(Flower, <span class="kw">c</span>(<span class="st">&quot;Rep&quot;</span>, <span class="st">&quot;no&quot;</span>), <span class="st">&quot; &quot;</span>)</a></code></pre></div>
<pre><code>## Warning: Expected 2 pieces. Missing pieces filled with `NA` in 3 rows [1,
## 2, 3].</code></pre>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb216-1" title="1">counts.fl &lt;-<span class="st"> </span><span class="kw">right_join</span>(count.fl, cov, <span class="dt">by =</span> <span class="st">&quot;Rep&quot;</span>)</a></code></pre></div>
<pre><code>## Warning: Column `Rep` joining character vector and factor, coercing into
## character vector</code></pre>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb218-1" title="1"><span class="co">#m1 &lt;- MASS::glmmPQL(con~ d.flowers + microsite + dN1, ~1|Rep, family = quasipoisson, data = counts.fl)</span></a>
<a class="sourceLine" id="cb218-2" title="2"><span class="co">#summary(m1)</span></a>
<a class="sourceLine" id="cb218-3" title="3"></a>
<a class="sourceLine" id="cb218-4" title="4"><span class="kw">ggplot</span>(<span class="dt">data =</span>counts.ag,(<span class="kw">aes</span>(microsite.x, Con))) <span class="op">+</span><span class="st"> </span><span class="kw">geom_boxplot</span>()</a></code></pre></div>
<p><img src="index_files/figure-html/pollen%20deposition-1.png" width="672" /></p>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb219-1" title="1"><span class="kw">ggplot</span>(<span class="dt">data =</span>counts.ag,(<span class="kw">aes</span>(microsite.x, Het))) <span class="op">+</span><span class="st"> </span><span class="kw">geom_boxplot</span>()</a></code></pre></div>
<p><img src="index_files/figure-html/pollen%20deposition-2.png" width="672" /></p>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb220-1" title="1"><span class="kw">ggplot</span>(<span class="dt">data =</span> counts.ag, (<span class="kw">aes</span>(Con))) <span class="op">+</span><span class="st"> </span><span class="kw">geom_freqpoly</span>()</a></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="index_files/figure-html/pollen%20deposition-3.png" width="672" /></p>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb222-1" title="1"><span class="kw">shapiro.test</span>(counts.ag<span class="op">$</span>Con)</a></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  counts.ag$Con
## W = 0.82636, p-value = 2.363e-15</code></pre>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb224-1" title="1">counts.ag<span class="op">$</span>Flower &lt;-<span class="st"> </span><span class="kw">paste</span>(counts.ag<span class="op">$</span>Rep, counts.ag<span class="op">$</span>Flower)</a>
<a class="sourceLine" id="cb224-2" title="2">counts.ag<span class="op">$</span>Sample &lt;-<span class="st"> </span><span class="kw">paste</span>(counts.ag<span class="op">$</span>Slide, counts.ag<span class="op">$</span>Rep)</a>
<a class="sourceLine" id="cb224-3" title="3">counts.ag<span class="op">$</span>d.S &lt;-<span class="st"> </span>counts.ag<span class="op">$</span>d.S <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">replace</span>(<span class="kw">is.na</span>(.), <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb224-4" title="4">counts.ag &lt;-<span class="st"> </span>counts.ag <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(., <span class="dt">all =</span> Con <span class="op">+</span><span class="st"> </span>Het)</a>
<a class="sourceLine" id="cb224-5" title="5"><span class="kw">cor.test</span>(counts.ag<span class="op">$</span>Con, counts.ag<span class="op">$</span>Het)</a></code></pre></div>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  counts.ag$Con and counts.ag$Het
## t = 2.3967, df = 229, p-value = 0.01735
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  0.02791644 0.27985733
## sample estimates:
##       cor 
## 0.1564304</code></pre>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb226-1" title="1"><span class="kw">mean</span>(counts.ag<span class="op">$</span>d.S)</a></code></pre></div>
<pre><code>## [1] 183.2857</code></pre>
<div class="sourceCode" id="cb228"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb228-1" title="1"><span class="kw">mean</span>(counts.ag<span class="op">$</span>dN1)</a></code></pre></div>
<pre><code>## [1] 79.37229</code></pre>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb230-1" title="1"><span class="kw">mean</span>(counts.ag<span class="op">$</span>d.flowers)</a></code></pre></div>
<pre><code>## [1] 7.025974</code></pre>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb232-1" title="1">m1 &lt;-<span class="st"> </span><span class="kw">glmmTMB</span>(Con <span class="op">~</span><span class="st"> </span>d.flowers <span class="op">+</span><span class="st"> </span>dN1 <span class="op">+</span><span class="st"> </span>d.S <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>Rep<span class="op">/</span>Flower), <span class="dt">family =</span> <span class="st">&quot;nbinom2&quot;</span>, <span class="dt">data =</span> counts.ag)</a>
<a class="sourceLine" id="cb232-2" title="2"><span class="kw">summary</span>(m1)</a></code></pre></div>
<pre><code>##  Family: nbinom2  ( log )
## Formula:          Con ~ d.flowers + dN1 + d.S + (1 | Rep/Flower)
## Data: counts.ag
## 
##      AIC      BIC   logLik deviance df.resid 
##   2381.5   2405.6  -1183.7   2367.5      224 
## 
## Random effects:
## 
## Conditional model:
##  Groups     Name        Variance  Std.Dev. 
##  Flower:Rep (Intercept) 5.976e-08 0.0002445
##  Rep        (Intercept) 6.696e-02 0.2587597
## Number of obs: 231, groups:  Flower:Rep, 78; Rep, 26
## 
## Overdispersion parameter for nbinom2 family (): 2.22 
## 
## Conditional model:
##              Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept) 3.9655244  0.1382528  28.683   &lt;2e-16 ***
## d.flowers   0.0080175  0.0101089   0.793    0.428    
## dN1         0.0018651  0.0012219   1.526    0.127    
## d.S         0.0001934  0.0003475   0.557    0.578    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb234-1" title="1">car<span class="op">::</span><span class="kw">Anova</span>(m1, <span class="dt">type =</span> <span class="dv">2</span>)</a></code></pre></div>
<pre><code>## Analysis of Deviance Table (Type II Wald chisquare tests)
## 
## Response: Con
##            Chisq Df Pr(&gt;Chisq)
## d.flowers 0.6290  1     0.4277
## dN1       2.3299  1     0.1269
## d.S       0.3099  1     0.5777</code></pre>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb236-1" title="1"><span class="co">#try microsites instead</span></a>
<a class="sourceLine" id="cb236-2" title="2"></a>
<a class="sourceLine" id="cb236-3" title="3">m2 &lt;-<span class="st"> </span><span class="kw">glmmTMB</span>(Con <span class="op">~</span><span class="st"> </span>d.flowers <span class="op">+</span><span class="st"> </span>dN1 <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>Rep<span class="op">/</span>Flower), <span class="dt">family =</span> <span class="st">&quot;nbinom2&quot;</span>, <span class="dt">data =</span> counts.ag)</a>
<a class="sourceLine" id="cb236-4" title="4"><span class="kw">summary</span>(m2)</a></code></pre></div>
<pre><code>##  Family: nbinom2  ( log )
## Formula:          Con ~ d.flowers + dN1 + (1 | Rep/Flower)
## Data: counts.ag
## 
##      AIC      BIC   logLik deviance df.resid 
##   2379.8   2400.5  -1183.9   2367.8      225 
## 
## Random effects:
## 
## Conditional model:
##  Groups     Name        Variance  Std.Dev. 
##  Flower:Rep (Intercept) 9.961e-08 0.0003156
##  Rep        (Intercept) 6.877e-02 0.2622419
## Number of obs: 231, groups:  Flower:Rep, 78; Rep, 26
## 
## Overdispersion parameter for nbinom2 family (): 2.22 
## 
## Conditional model:
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept) 3.993236   0.130002  30.717   &lt;2e-16 ***
## d.flowers   0.009251   0.009935   0.931    0.352    
## dN1         0.001852   0.001230   1.506    0.132    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb238-1" title="1">m3 &lt;-<span class="st"> </span><span class="kw">glmmTMB</span>(Con <span class="op">~</span><span class="st"> </span>dN1 <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>Rep<span class="op">/</span>Flower), <span class="dt">family =</span> <span class="st">&quot;nbinom2&quot;</span>, <span class="dt">data =</span> counts.ag)</a>
<a class="sourceLine" id="cb238-2" title="2"><span class="kw">summary</span>(m3)</a></code></pre></div>
<pre><code>##  Family: nbinom2  ( log )
## Formula:          Con ~ dN1 + (1 | Rep/Flower)
## Data: counts.ag
## 
##      AIC      BIC   logLik deviance df.resid 
##   2378.7   2395.9  -1184.3   2368.7      226 
## 
## Random effects:
## 
## Conditional model:
##  Groups     Name        Variance  Std.Dev. 
##  Flower:Rep (Intercept) 2.212e-08 0.0001487
##  Rep        (Intercept) 7.262e-02 0.2694890
## Number of obs: 231, groups:  Flower:Rep, 78; Rep, 26
## 
## Overdispersion parameter for nbinom2 family (): 2.22 
## 
## Conditional model:
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept) 4.043609   0.119945   33.71   &lt;2e-16 ***
## dN1         0.002043   0.001234    1.66   0.0978 .  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb240-1" title="1">null &lt;-<span class="st"> </span><span class="kw">glmmTMB</span>(Con <span class="op">~</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>Rep<span class="op">/</span>Flower), <span class="dt">family =</span> <span class="st">&quot;nbinom2&quot;</span>, <span class="dt">data =</span> counts.ag)</a>
<a class="sourceLine" id="cb240-2" title="2"><span class="kw">summary</span>(null)</a></code></pre></div>
<pre><code>##  Family: nbinom2  ( log )
## Formula:          Con ~ (1 | Rep/Flower)
## Data: counts.ag
## 
##      AIC      BIC   logLik deviance df.resid 
##   2379.3   2393.1  -1185.6   2371.3      227 
## 
## Random effects:
## 
## Conditional model:
##  Groups     Name        Variance  Std.Dev. 
##  Flower:Rep (Intercept) 3.583e-08 0.0001893
##  Rep        (Intercept) 8.571e-02 0.2927643
## Number of obs: 231, groups:  Flower:Rep, 78; Rep, 26
## 
## Overdispersion parameter for nbinom2 family (): 2.22 
## 
## Conditional model:
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)  4.20487    0.07338   57.31   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb242-1" title="1"><span class="kw">AIC</span>(m1, m2, m3, null)</a></code></pre></div>
<pre><code>##      df      AIC
## m1    7 2381.494
## m2    6 2379.803
## m3    5 2378.664
## null  4 2379.284</code></pre>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb244-1" title="1"><span class="kw">anova</span>(m1, m2, m3, null)</a></code></pre></div>
<pre><code>## Data: counts.ag
## Models:
## null: Con ~ (1 | Rep/Flower), zi=~0, disp=~1
## m3: Con ~ dN1 + (1 | Rep/Flower), zi=~0, disp=~1
## m2: Con ~ d.flowers + dN1 + (1 | Rep/Flower), zi=~0, disp=~1
## m1: Con ~ d.flowers + dN1 + d.S + (1 | Rep/Flower), zi=~0, disp=~1
##      Df    AIC    BIC  logLik deviance  Chisq Chi Df Pr(&gt;Chisq)
## null  4 2379.3 2393.1 -1185.6   2371.3                         
## m3    5 2378.7 2395.9 -1184.3   2368.7 2.6199      1     0.1055
## m2    6 2379.8 2400.5 -1183.9   2367.8 0.8609      1     0.3535
## m1    7 2381.5 2405.6 -1183.8   2367.5 0.3090      1     0.5783</code></pre>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb246-1" title="1">m4 &lt;-<span class="st"> </span><span class="kw">glmmTMB</span>(Het <span class="op">~</span><span class="st"> </span>d.flowers <span class="op">+</span><span class="st"> </span>dN1 <span class="op">+</span><span class="st"> </span>d.S <span class="op">+</span><span class="st"> </span>z <span class="op">+</span>(<span class="dv">1</span><span class="op">|</span>Rep<span class="op">/</span>Flower), <span class="dt">family =</span> <span class="st">&quot;nbinom2&quot;</span>, <span class="dt">data =</span> counts.ag)</a></code></pre></div>
<pre><code>## Warning in fitTMB(TMBStruc): Model convergence problem; non-positive-
## definite Hessian matrix. See vignette(&#39;troubleshooting&#39;)</code></pre>
<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb248-1" title="1"><span class="kw">summary</span>(m4)</a></code></pre></div>
<pre><code>##  Family: nbinom2  ( log )
## Formula:          Het ~ d.flowers + dN1 + d.S + z + (1 | Rep/Flower)
## Data: counts.ag
## 
##      AIC      BIC   logLik deviance df.resid 
##       NA       NA       NA       NA      108 
## 
## Random effects:
## 
## Conditional model:
##  Groups     Name        Variance  Std.Dev. 
##  Flower:Rep (Intercept) 5.477e-02 2.340e-01
##  Rep        (Intercept) 7.078e-09 8.413e-05
## Number of obs: 116, groups:  Flower:Rep, 39; Rep, 13
## 
## Overdispersion parameter for nbinom2 family (): 1.74 
## 
## Conditional model:
##               Estimate Std. Error z value Pr(&gt;|z|)
## (Intercept)  2.1011722         NA      NA       NA
## d.flowers    0.0051848         NA      NA       NA
## dN1          0.0008273         NA      NA       NA
## d.S          0.0000000         NA      NA       NA
## z           -0.0031817         NA      NA       NA</code></pre>
<div class="sourceCode" id="cb250"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb250-1" title="1">car<span class="op">::</span><span class="kw">Anova</span>(m4, <span class="dt">type =</span> <span class="dv">2</span>)</a></code></pre></div>
<pre><code>## Analysis of Deviance Table (Type II Wald chisquare tests)
## 
## Response: Het
##           Chisq Df Pr(&gt;Chisq)
## d.flowers        1           
## dN1              1           
## d.S              1           
## z                1</code></pre>
<div class="sourceCode" id="cb252"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb252-1" title="1">m5 &lt;-<span class="st"> </span><span class="kw">glmmTMB</span>(Het <span class="op">~</span><span class="st"> </span>d.flowers <span class="op">+</span><span class="st"> </span>d.S <span class="op">+</span><span class="st"> </span>z<span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>Rep<span class="op">/</span>Flower), <span class="dt">family =</span> <span class="st">&quot;nbinom2&quot;</span>, <span class="dt">data =</span> counts.ag)</a></code></pre></div>
<pre><code>## Warning in fitTMB(TMBStruc): Model convergence problem; non-positive-
## definite Hessian matrix. See vignette(&#39;troubleshooting&#39;)</code></pre>
<div class="sourceCode" id="cb254"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb254-1" title="1"><span class="kw">summary</span>(m5)</a></code></pre></div>
<pre><code>##  Family: nbinom2  ( log )
## Formula:          Het ~ d.flowers + d.S + z + (1 | Rep/Flower)
## Data: counts.ag
## 
##      AIC      BIC   logLik deviance df.resid 
##       NA       NA       NA       NA      109 
## 
## Random effects:
## 
## Conditional model:
##  Groups     Name        Variance  Std.Dev. 
##  Flower:Rep (Intercept) 5.982e-02 0.2445824
##  Rep        (Intercept) 1.197e-08 0.0001094
## Number of obs: 116, groups:  Flower:Rep, 39; Rep, 13
## 
## Overdispersion parameter for nbinom2 family (): 1.75 
## 
## Conditional model:
##              Estimate Std. Error z value Pr(&gt;|z|)
## (Intercept)  2.158598         NA      NA       NA
## d.flowers    0.005629         NA      NA       NA
## d.S          0.000000         NA      NA       NA
## z           -0.003179         NA      NA       NA</code></pre>
<div class="sourceCode" id="cb256"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb256-1" title="1">m6 &lt;-<span class="st"> </span><span class="kw">glmmTMB</span>(Het <span class="op">~</span><span class="st"> </span>d.S <span class="op">+</span><span class="st"> </span>z <span class="op">+</span>(<span class="dv">1</span><span class="op">|</span>Rep<span class="op">/</span>Flower), <span class="dt">family =</span> <span class="st">&quot;nbinom2&quot;</span>, <span class="dt">data =</span> counts.ag)</a></code></pre></div>
<pre><code>## Warning in fitTMB(TMBStruc): Model convergence problem; non-positive-
## definite Hessian matrix. See vignette(&#39;troubleshooting&#39;)</code></pre>
<div class="sourceCode" id="cb258"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb258-1" title="1"><span class="kw">summary</span>(m6)</a></code></pre></div>
<pre><code>##  Family: nbinom2  ( log )
## Formula:          Het ~ d.S + z + (1 | Rep/Flower)
## Data: counts.ag
## 
##      AIC      BIC   logLik deviance df.resid 
##       NA       NA       NA       NA      110 
## 
## Random effects:
## 
## Conditional model:
##  Groups     Name        Variance  Std.Dev. 
##  Flower:Rep (Intercept) 5.906e-02 2.430e-01
##  Rep        (Intercept) 8.412e-09 9.171e-05
## Number of obs: 116, groups:  Flower:Rep, 39; Rep, 13
## 
## Overdispersion parameter for nbinom2 family (): 1.75 
## 
## Conditional model:
##              Estimate Std. Error z value Pr(&gt;|z|)
## (Intercept)  2.196206         NA      NA       NA
## d.S          0.000000         NA      NA       NA
## z           -0.003249         NA      NA       NA</code></pre>
<div class="sourceCode" id="cb260"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb260-1" title="1">null &lt;-<span class="st"> </span><span class="kw">glmmTMB</span>(Het <span class="op">~</span><span class="st"> </span>z<span class="op">+</span>(<span class="dv">1</span><span class="op">|</span>Rep<span class="op">/</span>Flower), <span class="dt">family =</span> <span class="st">&quot;nbinom2&quot;</span>, <span class="dt">data =</span> counts.ag)</a>
<a class="sourceLine" id="cb260-2" title="2"><span class="kw">summary</span>(null)</a></code></pre></div>
<pre><code>##  Family: nbinom2  ( log )
## Formula:          Het ~ z + (1 | Rep/Flower)
## Data: counts.ag
## 
##      AIC      BIC   logLik deviance df.resid 
##    658.3    672.0   -324.1    648.3      111 
## 
## Random effects:
## 
## Conditional model:
##  Groups     Name        Variance  Std.Dev. 
##  Flower:Rep (Intercept) 5.906e-02 2.430e-01
##  Rep        (Intercept) 8.412e-09 9.171e-05
## Number of obs: 116, groups:  Flower:Rep, 39; Rep, 13
## 
## Overdispersion parameter for nbinom2 family (): 1.75 
## 
## Conditional model:
##              Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)  2.196206   0.393752   5.578 2.44e-08 ***
## z           -0.003249   0.002608  -1.246    0.213    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb262"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb262-1" title="1"><span class="kw">AIC</span>(m4, m5, m6, null)</a></code></pre></div>
<pre><code>##      df      AIC
## m4    8       NA
## m5    7       NA
## m6    6       NA
## null  5 658.2597</code></pre>
<div class="sourceCode" id="cb264"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb264-1" title="1"><span class="kw">anova</span>(m4, m5, m6, null)</a></code></pre></div>
<pre><code>## Data: counts.ag
## Models:
## null: Het ~ z + (1 | Rep/Flower), zi=~0, disp=~1
## m6: Het ~ d.S + z + (1 | Rep/Flower), zi=~0, disp=~1
## m5: Het ~ d.flowers + d.S + z + (1 | Rep/Flower), zi=~0, disp=~1
## m4: Het ~ d.flowers + dN1 + d.S + z + (1 | Rep/Flower), zi=~0, disp=~1
##      Df    AIC    BIC  logLik deviance Chisq Chi Df Pr(&gt;Chisq)
## null  5 658.26 672.03 -324.13   648.26                        
## m6    6                                           1           
## m5    7                                           1           
## m4    8                                           1</code></pre>
<div class="sourceCode" id="cb266"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb266-1" title="1">p3 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(counts.ag, <span class="kw">aes</span>(d.S, Con)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="dt">shape =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_smooth</span>(<span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">size =</span> <span class="fl">0.5</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_jitter</span>(<span class="dt">shape =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme_Publication</span>() <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Distance to Larrea tridentata&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Conspecific Pollen Deposition&quot;</span>)</a>
<a class="sourceLine" id="cb266-2" title="2"></a>
<a class="sourceLine" id="cb266-3" title="3"></a>
<a class="sourceLine" id="cb266-4" title="4">p4 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(counts.ag, <span class="kw">aes</span>(d.S, Het)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="dt">shape =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_smooth</span>(<span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">size =</span> <span class="fl">0.5</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_jitter</span>(<span class="dt">shape =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme_Publication</span>() <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Distance to Larrea tridentata&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Heterospecific Pollen Deposition&quot;</span>)</a>
<a class="sourceLine" id="cb266-5" title="5"></a>
<a class="sourceLine" id="cb266-6" title="6"><span class="kw">plot_grid</span>(p3, p4, <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>), <span class="dt">align =</span> <span class="st">&quot;h&quot;</span>)</a></code></pre></div>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;
## `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<p><img src="index_files/figure-html/pollen%20plots-1.png" width="672" /></p>
<hr />
<p>##Community level effects</p>
<hr />
</div>
<div id="vegetation-modelling" class="section level3">
<h3>Vegetation Modelling</h3>
<p>GLMM for vegetation covariates to test for direct shrub facilitation/background flowering levels</p>
<hr />
<p>Annual Percent Cover</p>
<div class="sourceCode" id="cb268"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb268-1" title="1">visits &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;Output Data/byrep_cleaned.csv&quot;</span>)</a>
<a class="sourceLine" id="cb268-2" title="2">metadata &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;Output Data/metadata_nobeetle.csv&quot;</span>)</a>
<a class="sourceLine" id="cb268-3" title="3"></a>
<a class="sourceLine" id="cb268-4" title="4"><span class="co">#only care about the veg</span></a>
<a class="sourceLine" id="cb268-5" title="5">visits &lt;-<span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(visits, uniID, treatment, flowering, het.shrub.blooming.neighbours, het.cactus.blooming.neighbours, understory.richness, het.annual.floral.density, PlantID)</a>
<a class="sourceLine" id="cb268-6" title="6">visits<span class="op">$</span>flowering &lt;-<span class="st"> </span><span class="kw">relevel</span>(visits<span class="op">$</span>flowering, <span class="st">&quot;pre&quot;</span>)</a>
<a class="sourceLine" id="cb268-7" title="7">metadata<span class="op">$</span>blooming &lt;-<span class="st"> </span><span class="kw">relevel</span>(metadata<span class="op">$</span>blooming, <span class="st">&quot;pre&quot;</span>)</a>
<a class="sourceLine" id="cb268-8" title="8"></a>
<a class="sourceLine" id="cb268-9" title="9">metadata &lt;-<span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(metadata, uniID, plant.id, treatment, blooming, percent.cover, date)</a>
<a class="sourceLine" id="cb268-10" title="10">metadata<span class="op">$</span>repID &lt;-<span class="st"> </span><span class="kw">paste</span>(metadata<span class="op">$</span>plant.id, metadata<span class="op">$</span>treatment)</a>
<a class="sourceLine" id="cb268-11" title="11">visits<span class="op">$</span>repID &lt;-<span class="st"> </span><span class="kw">paste</span>(visits<span class="op">$</span>PlantID, visits<span class="op">$</span>treatment)</a>
<a class="sourceLine" id="cb268-12" title="12"></a>
<a class="sourceLine" id="cb268-13" title="13"></a>
<a class="sourceLine" id="cb268-14" title="14"><span class="co">#percent.cover</span></a>
<a class="sourceLine" id="cb268-15" title="15"><span class="kw">shapiro.test</span>(metadata<span class="op">$</span>percent.cover)</a></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  metadata$percent.cover
## W = 0.84516, p-value = 2.406e-14</code></pre>
<div class="sourceCode" id="cb270"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb270-1" title="1"><span class="kw">mean</span>(metadata<span class="op">$</span>percent.cover)</a></code></pre></div>
<pre><code>## [1] 18.82456</code></pre>
<div class="sourceCode" id="cb272"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb272-1" title="1"><span class="kw">sd</span>(metadata<span class="op">$</span>percent.cover)</a></code></pre></div>
<pre><code>## [1] 19.50229</code></pre>
<div class="sourceCode" id="cb274"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb274-1" title="1"><span class="kw">ggplot</span>(metadata, <span class="kw">aes</span>(percent.cover)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_density</span>()</a></code></pre></div>
<p><img src="index_files/figure-html/percent%20cover-1.png" width="672" /></p>
<div class="sourceCode" id="cb275"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb275-1" title="1">g1.nb &lt;-<span class="st"> </span><span class="kw">glmmTMB</span>(percent.cover <span class="op">~</span><span class="st"> </span>treatment <span class="op">+</span><span class="st"> </span>blooming <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>repID), <span class="dt">family =</span> <span class="st">&quot;nbinom2&quot;</span>, <span class="dt">data =</span> metadata)</a>
<a class="sourceLine" id="cb275-2" title="2">g1.nb1 &lt;-<span class="st"> </span><span class="kw">glmmTMB</span>(percent.cover <span class="op">~</span><span class="st"> </span>treatment <span class="op">*</span><span class="st"> </span>blooming <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>repID), <span class="dt">family =</span> <span class="st">&quot;nbinom2&quot;</span>, <span class="dt">data =</span> metadata)</a>
<a class="sourceLine" id="cb275-3" title="3">g1.nb.null &lt;-<span class="st"> </span><span class="kw">glmmTMB</span>(percent.cover <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>repID), <span class="dt">family =</span> <span class="st">&quot;nbinom2&quot;</span>, <span class="dt">data =</span> metadata)</a>
<a class="sourceLine" id="cb275-4" title="4"></a>
<a class="sourceLine" id="cb275-5" title="5">g1.ps &lt;-<span class="st"> </span><span class="kw">glmmTMB</span>(percent.cover <span class="op">~</span><span class="st"> </span>treatment <span class="op">*</span><span class="st"> </span>blooming <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>repID), <span class="dt">family =</span> <span class="st">&quot;poisson&quot;</span>, <span class="dt">data =</span> metadata)</a>
<a class="sourceLine" id="cb275-6" title="6"><span class="kw">summary</span>(g1.ps)</a></code></pre></div>
<pre><code>##  Family: poisson  ( log )
## Formula:          percent.cover ~ treatment * blooming + (1 | repID)
## Data: metadata
## 
##      AIC      BIC   logLik deviance df.resid 
##   1732.7   1749.8   -861.3   1722.7      223 
## 
## Random effects:
## 
## Conditional model:
##  Groups Name        Variance Std.Dev.
##  repID  (Intercept) 0.3482   0.5901  
## Number of obs: 228, groups:  repID, 126
## 
## Conditional model:
##                             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)                  1.63127    0.09872  16.524   &lt;2e-16 ***
## treatmentshrub               1.70620    0.12616  13.524   &lt;2e-16 ***
## bloomingpost                -0.87124    0.10046  -8.673   &lt;2e-16 ***
## treatmentshrub:bloomingpost  0.92105    0.10597   8.691   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb277"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb277-1" title="1"><span class="co">#overdisp_fun(g1.ps)</span></a>
<a class="sourceLine" id="cb277-2" title="2"><span class="kw">summary</span>(g1.nb)</a></code></pre></div>
<pre><code>##  Family: nbinom2  ( log )
## Formula:          percent.cover ~ treatment + blooming + (1 | repID)
## Data: metadata
## 
##      AIC      BIC   logLik deviance df.resid 
##   1553.7   1570.9   -771.9   1543.7      223 
## 
## Random effects:
## 
## Conditional model:
##  Groups Name        Variance Std.Dev.
##  repID  (Intercept) 0.1603   0.4004  
## Number of obs: 228, groups:  repID, 126
## 
## Overdispersion parameter for nbinom2 family (): 3.76 
## 
## Conditional model:
##                Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)     1.45974    0.09829  14.852  &lt; 2e-16 ***
## treatmentshrub  2.15367    0.11501  18.726  &lt; 2e-16 ***
## bloomingpost   -0.28135    0.08611  -3.267  0.00109 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb279"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb279-1" title="1"><span class="kw">summary</span>(g1.nb1)</a></code></pre></div>
<pre><code>##  Family: nbinom2  ( log )
## Formula:          percent.cover ~ treatment * blooming + (1 | repID)
## Data: metadata
## 
##      AIC      BIC   logLik deviance df.resid 
##   1534.0   1554.6   -761.0   1522.0      222 
## 
## Random effects:
## 
## Conditional model:
##  Groups Name        Variance Std.Dev.
##  repID  (Intercept) 0.1757   0.4192  
## Number of obs: 228, groups:  repID, 126
## 
## Overdispersion parameter for nbinom2 family (): 4.66 
## 
## Conditional model:
##                             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)                   1.6794     0.1073  15.650  &lt; 2e-16 ***
## treatmentshrub                1.7641     0.1379  12.793  &lt; 2e-16 ***
## bloomingpost                 -0.8027     0.1377  -5.831 5.52e-09 ***
## treatmentshrub:bloomingpost   0.8048     0.1684   4.779 1.76e-06 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb281"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb281-1" title="1"><span class="kw">summary</span>(g1.nb.null)</a></code></pre></div>
<pre><code>##  Family: nbinom2  ( log )
## Formula:          percent.cover ~ 1 + (1 | repID)
## Data: metadata
## 
##      AIC      BIC   logLik deviance df.resid 
##   1730.3   1740.6   -862.1   1724.3      225 
## 
## Random effects:
## 
## Conditional model:
##  Groups Name        Variance Std.Dev.
##  repID  (Intercept) 1.379    1.174   
## Number of obs: 228, groups:  repID, 126
## 
## Overdispersion parameter for nbinom2 family (): 3.76 
## 
## Conditional model:
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)   2.3677     0.1164   20.35   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb283"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb283-1" title="1"><span class="kw">AIC</span>(g1.ps, g1.nb1)</a></code></pre></div>
<pre><code>##        df      AIC
## g1.ps   5 1732.656
## g1.nb1  6 1533.999</code></pre>
<div class="sourceCode" id="cb285"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb285-1" title="1"><span class="kw">anova</span>(g1.nb, g1.nb1, g1.nb.null)</a></code></pre></div>
<pre><code>## Data: metadata
## Models:
## g1.nb.null: percent.cover ~ 1 + (1 | repID), zi=~0, disp=~1
## g1.nb: percent.cover ~ treatment + blooming + (1 | repID), zi=~0, disp=~1
## g1.nb1: percent.cover ~ treatment * blooming + (1 | repID), zi=~0, disp=~1
##            Df    AIC    BIC  logLik deviance  Chisq Chi Df Pr(&gt;Chisq)    
## g1.nb.null  3 1730.3 1740.6 -862.15   1724.3                             
## g1.nb       5 1553.7 1570.9 -771.86   1543.7 180.57      2  &lt; 2.2e-16 ***
## g1.nb1      6 1534.0 1554.6 -761.00   1522.0  21.72      1  3.154e-06 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb287"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb287-1" title="1"><span class="kw">AIC</span>(g1.nb, g1.nb1, g1.nb.null)</a></code></pre></div>
<pre><code>##            df      AIC
## g1.nb       5 1553.720
## g1.nb1      6 1533.999
## g1.nb.null  3 1730.291</code></pre>
<div class="sourceCode" id="cb289"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb289-1" title="1">car<span class="op">::</span><span class="kw">Anova</span>(g1.nb, <span class="dt">type =</span> <span class="dv">2</span>)</a></code></pre></div>
<pre><code>## Analysis of Deviance Table (Type II Wald chisquare tests)
## 
## Response: percent.cover
##             Chisq Df Pr(&gt;Chisq)    
## treatment 350.646  1  &lt; 2.2e-16 ***
## blooming   10.675  1   0.001086 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb291"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb291-1" title="1">car<span class="op">::</span><span class="kw">Anova</span>(g1.nb1, <span class="dt">type =</span> <span class="dv">3</span>)</a></code></pre></div>
<pre><code>## Analysis of Deviance Table (Type III Wald chisquare tests)
## 
## Response: percent.cover
##                      Chisq Df Pr(&gt;Chisq)    
## (Intercept)        244.911  1  &lt; 2.2e-16 ***
## treatment          163.649  1  &lt; 2.2e-16 ***
## blooming            33.998  1  5.517e-09 ***
## treatment:blooming  22.837  1  1.764e-06 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb293"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb293-1" title="1"><span class="co">#negative binomail with interaction is best fitting model</span></a>
<a class="sourceLine" id="cb293-2" title="2"></a>
<a class="sourceLine" id="cb293-3" title="3"><span class="co">#posthoc in interaction</span></a>
<a class="sourceLine" id="cb293-4" title="4">ph &lt;-<span class="st"> </span><span class="kw">lsmeans</span>(g1.nb1, pairwise<span class="op">~</span>treatment<span class="op">*</span>blooming, <span class="dt">adjust=</span><span class="st">&quot;tukey&quot;</span>)</a>
<a class="sourceLine" id="cb293-5" title="5"><span class="kw">summary</span>(ph)</a></code></pre></div>
<pre><code>## $lsmeans
##  treatment blooming lsmean     SE  df lower.CL upper.CL
##  open      pre       1.679 0.1073 222    1.468     1.89
##  shrub     pre       3.444 0.0893 222    3.268     3.62
##  open      post      0.877 0.1193 222    0.642     1.11
##  shrub     post      3.446 0.0875 222    3.273     3.62
## 
## Results are given on the log (not the response) scale. 
## Confidence level used: 0.95 
## 
## $contrasts
##  contrast               estimate     SE  df t.ratio p.value
##  open,pre - shrub,pre   -1.76411 0.1379 222 -12.793 &lt;.0001 
##  open,pre - open,post    0.80267 0.1377 222   5.831 &lt;.0001 
##  open,pre - shrub,post  -1.76620 0.1353 222 -13.058 &lt;.0001 
##  shrub,pre - open,post   2.56678 0.1472 222  17.442 &lt;.0001 
##  shrub,pre - shrub,post -0.00209 0.0974 222  -0.021 1.0000 
##  open,post - shrub,post -2.56887 0.1444 222 -17.789 &lt;.0001 
## 
## Results are given on the log (not the response) scale. 
## P value adjustment: tukey method for comparing a family of 4 estimates</code></pre>
<div class="sourceCode" id="cb295"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb295-1" title="1"><span class="kw">ggplot</span>(metadata, <span class="kw">aes</span>(treatment, percent.cover)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_boxplot</span>() <span class="op">+</span><span class="st"> </span><span class="kw">facet_grid</span>(<span class="op">~</span>blooming)</a></code></pre></div>
<p><img src="index_files/figure-html/percent%20cover-2.png" width="672" /></p>
<div class="sourceCode" id="cb296"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb296-1" title="1"><span class="kw">ggplot</span>(metadata, <span class="kw">aes</span>(treatment, percent.cover)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_boxplot</span>() <span class="op">+</span><span class="st"> </span><span class="kw">theme_Publication</span>() <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Percent Annual Vegetation Cover&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Microsite&quot;</span>)</a></code></pre></div>
<pre><code>## Warning: `legend.margin` must be specified using `margin()`. For the old
## behavior use legend.spacing</code></pre>
<pre><code>## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font family not found in Windows font database

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font family not found in Windows font database

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font family not found in Windows font database

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font family not found in Windows font database

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font family not found in Windows font database

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font family not found in Windows font database

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font family not found in Windows font database</code></pre>
<pre><code>## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x,
## x$y, : font family not found in Windows font database</code></pre>
<p><img src="index_files/figure-html/percent%20cover-3.png" width="672" /></p>
<div class="sourceCode" id="cb300"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb300-1" title="1"><span class="kw">ggplot</span>(metadata, <span class="kw">aes</span>(treatment, percent.cover)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_boxplot</span>() <span class="op">+</span><span class="st"> </span><span class="kw">theme_Publication</span>() <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Percent Annual Vegetation Cover&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Microsite&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">facet_grid</span>(<span class="op">~</span>blooming,<span class="dt">labeller=</span><span class="kw">labeller</span>(<span class="dt">blooming =</span> labels))</a></code></pre></div>
<pre><code>## Warning: `legend.margin` must be specified using `margin()`. For the old
## behavior use legend.spacing</code></pre>
<pre><code>## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font family not found in Windows font database

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font family not found in Windows font database

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font family not found in Windows font database</code></pre>
<pre><code>## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x,
## x$y, : font family not found in Windows font database</code></pre>
<pre><code>## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font family not found in Windows font database

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font family not found in Windows font database</code></pre>
<pre><code>## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x,
## x$y, : font family not found in Windows font database</code></pre>
<p><img src="index_files/figure-html/percent%20cover-4.png" width="672" /></p>
<hr />
<p>Annual Richness</p>
<div class="sourceCode" id="cb306"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb306-1" title="1"><span class="kw">mean</span>(visits<span class="op">$</span>understory.richness, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 2.376623</code></pre>
<div class="sourceCode" id="cb308"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb308-1" title="1"><span class="kw">sd</span>(visits<span class="op">$</span>understory.richness, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.8703667</code></pre>
<div class="sourceCode" id="cb310"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb310-1" title="1"><span class="kw">shapiro.test</span>(visits<span class="op">$</span>understory.richness)</a></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  visits$understory.richness
## W = 0.88912, p-value = 5.431e-12</code></pre>
<div class="sourceCode" id="cb312"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb312-1" title="1"><span class="kw">ggplot</span>(visits, <span class="kw">aes</span>(understory.richness)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_density</span>()</a></code></pre></div>
<pre><code>## Warning: Removed 4 rows containing non-finite values (stat_density).</code></pre>
<p><img src="index_files/figure-html/annual%20richness-1.png" width="672" /></p>
<div class="sourceCode" id="cb314"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb314-1" title="1">g2 &lt;-<span class="st"> </span><span class="kw">glmmTMB</span>(understory.richness <span class="op">~</span><span class="st"> </span>treatment <span class="op">+</span><span class="st"> </span>flowering <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>repID), <span class="dt">family =</span> <span class="kw">poisson</span>(<span class="dt">link=</span><span class="st">&quot;log&quot;</span>), <span class="dt">data =</span> visits)</a>
<a class="sourceLine" id="cb314-2" title="2">g2<span class="fl">.2</span> &lt;-<span class="st"> </span><span class="kw">glmmTMB</span>(understory.richness <span class="op">~</span><span class="st"> </span>treatment <span class="op">*</span><span class="st"> </span>flowering <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>repID), <span class="dt">family =</span> <span class="kw">poisson</span>(<span class="dt">link=</span><span class="st">&quot;log&quot;</span>), <span class="dt">data =</span> visits)</a>
<a class="sourceLine" id="cb314-3" title="3">g2.null &lt;-<span class="st"> </span><span class="kw">glmmTMB</span>(understory.richness <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>repID), <span class="dt">family =</span> <span class="kw">poisson</span>(<span class="dt">link=</span><span class="st">&quot;log&quot;</span>), <span class="dt">data =</span> visits)</a>
<a class="sourceLine" id="cb314-4" title="4">g2b &lt;-<span class="st"> </span><span class="kw">glmmTMB</span>(understory.richness <span class="op">~</span><span class="st"> </span>treatment <span class="op">+</span><span class="st"> </span>flowering <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>repID), <span class="dt">family =</span> nbinom2, <span class="dt">data =</span> visits)</a></code></pre></div>
<pre><code>## Warning in fitTMB(TMBStruc): Model convergence problem; false convergence
## (8). See vignette(&#39;troubleshooting&#39;)</code></pre>
<div class="sourceCode" id="cb316"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb316-1" title="1"><span class="kw">summary</span>(g2)</a></code></pre></div>
<pre><code>##  Family: poisson  ( log )
## Formula:          
## understory.richness ~ treatment + flowering + (1 | repID)
## Data: visits
## 
##      AIC      BIC   logLik deviance df.resid 
##    707.6    721.3   -349.8    699.6      227 
## 
## Random effects:
## 
## Conditional model:
##  Groups Name        Variance  Std.Dev. 
##  repID  (Intercept) 1.589e-10 1.261e-05
## Number of obs: 231, groups:  repID, 122
## 
## Conditional model:
##                Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)     0.89619    0.07359  12.179   &lt;2e-16 ***
## treatmentshrub  0.07186    0.08546   0.841      0.4    
## floweringbloom -0.14068    0.08560  -1.643      0.1    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb318"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb318-1" title="1"><span class="kw">summary</span>(g2<span class="fl">.2</span>)</a></code></pre></div>
<pre><code>##  Family: poisson  ( log )
## Formula:          
## understory.richness ~ treatment * flowering + (1 | repID)
## Data: visits
## 
##      AIC      BIC   logLik deviance df.resid 
##    709.6    726.8   -349.8    699.6      226 
## 
## Random effects:
## 
## Conditional model:
##  Groups Name        Variance  Std.Dev. 
##  repID  (Intercept) 1.729e-10 1.315e-05
## Number of obs: 231, groups:  repID, 122
## 
## Conditional model:
##                               Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)                    0.89142    0.08482  10.510   &lt;2e-16 ***
## treatmentshrub                 0.08090    0.11664   0.694    0.488    
## floweringbloom                -0.13045    0.12406  -1.052    0.293    
## treatmentshrub:floweringbloom -0.01951    0.17140  -0.114    0.909    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb320"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb320-1" title="1"><span class="kw">summary</span>(g2.null)</a></code></pre></div>
<pre><code>##  Family: poisson  ( log )
## Formula:          understory.richness ~ 1 + (1 | repID)
## Data: visits
## 
##      AIC      BIC   logLik deviance df.resid 
##    707.0    713.9   -351.5    703.0      229 
## 
## Random effects:
## 
## Conditional model:
##  Groups Name        Variance  Std.Dev. 
##  repID  (Intercept) 2.005e-10 1.416e-05
## Number of obs: 231, groups:  repID, 122
## 
## Conditional model:
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)  0.86568    0.04268   20.28   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb322"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb322-1" title="1"><span class="kw">anova</span>(g2, g2.null, g2<span class="fl">.2</span>, g2b, <span class="dt">test =</span> <span class="st">&quot;Chisq&quot;</span>)</a></code></pre></div>
<pre><code>## Data: visits
## Models:
## g2.null: understory.richness ~ 1 + (1 | repID), zi=~0, disp=~1
## g2: understory.richness ~ treatment + flowering + (1 | repID), zi=~0, disp=~1
## g2.2: understory.richness ~ treatment * flowering + (1 | repID), zi=~0, disp=~1
## g2b: understory.richness ~ treatment + flowering + (1 | repID), zi=~0, disp=~1
##         Df    AIC    BIC  logLik deviance  Chisq Chi Df Pr(&gt;Chisq)
## g2.null  2 707.01 713.89 -351.50   703.01                         
## g2       4 707.58 721.35 -349.79   699.58 3.4279      2     0.1802
## g2.2     5 709.56 726.78 -349.78   699.56 0.0130      1     0.9094
## g2b      5 709.58 726.79 -349.79   699.58 0.0000      0     1.0000</code></pre>
<div class="sourceCode" id="cb324"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb324-1" title="1"><span class="kw">AIC</span>(g2, g2<span class="fl">.2</span>, g2.null, g2b)</a></code></pre></div>
<pre><code>##         df      AIC
## g2       4 707.5776
## g2.2     5 709.5646
## g2.null  2 707.0055
## g2b      5 709.5776</code></pre>
<div class="sourceCode" id="cb326"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb326-1" title="1">car<span class="op">::</span><span class="kw">Anova</span>(g2, <span class="dt">type =</span> <span class="dv">2</span>)</a></code></pre></div>
<pre><code>## Analysis of Deviance Table (Type II Wald chisquare tests)
## 
## Response: understory.richness
##            Chisq Df Pr(&gt;Chisq)
## treatment 0.7071  1     0.4004
## flowering 2.7010  1     0.1003</code></pre>
<div class="sourceCode" id="cb328"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb328-1" title="1"><span class="co">#null model is the best fit</span></a>
<a class="sourceLine" id="cb328-2" title="2"><span class="kw">shapiro.test</span>(<span class="kw">residuals</span>(g2))</a></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  residuals(g2)
## W = 0.9774, p-value = 0.0009409</code></pre>
<div class="sourceCode" id="cb330"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb330-1" title="1"><span class="kw">ggplot</span>(visits, <span class="kw">aes</span>(treatment, understory.richness)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_boxplot</span>() <span class="op">+</span><span class="st"> </span><span class="kw">facet_grid</span>(<span class="op">~</span>flowering, <span class="dt">labeller=</span><span class="kw">labeller</span>(<span class="dt">flowering =</span> labels)) <span class="op">+</span><span class="st"> </span><span class="kw">theme_Publication</span>() <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Microsite&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Annual Species Richness&quot;</span>)</a></code></pre></div>
<pre><code>## Warning: `legend.margin` must be specified using `margin()`. For the old
## behavior use legend.spacing</code></pre>
<pre><code>## Warning: Removed 4 rows containing non-finite values (stat_boxplot).</code></pre>
<pre><code>## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font family not found in Windows font database

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font family not found in Windows font database

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font family not found in Windows font database</code></pre>
<pre><code>## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x,
## x$y, : font family not found in Windows font database</code></pre>
<pre><code>## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font family not found in Windows font database

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font family not found in Windows font database</code></pre>
<pre><code>## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x,
## x$y, : font family not found in Windows font database</code></pre>
<p><img src="index_files/figure-html/annual%20richness-2.png" width="672" /></p>
<hr />
<p>Annual Floral Density number of all blooms in quadrat</p>
<div class="sourceCode" id="cb337"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb337-1" title="1"><span class="kw">mean</span>(visits<span class="op">$</span>het.annual.floral.density, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.965368</code></pre>
<div class="sourceCode" id="cb339"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb339-1" title="1"><span class="kw">sd</span>(visits<span class="op">$</span>het.annual.floral.density, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 3.114987</code></pre>
<div class="sourceCode" id="cb341"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb341-1" title="1"><span class="kw">ggplot</span>(visits, <span class="kw">aes</span>(het.annual.floral.density)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_density</span>()</a></code></pre></div>
<pre><code>## Warning: Removed 4 rows containing non-finite values (stat_density).</code></pre>
<p><img src="index_files/figure-html/annual%20floral%20density-1.png" width="672" /></p>
<div class="sourceCode" id="cb343"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb343-1" title="1">g3.nb &lt;-<span class="st"> </span><span class="kw">glmmTMB</span>(het.annual.floral.density <span class="op">~</span><span class="st"> </span>flowering <span class="op">*</span><span class="st"> </span>treatment <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>repID), <span class="dt">family =</span> <span class="st">&quot;nbinom2&quot;</span>, <span class="dt">data =</span> visits)</a>
<a class="sourceLine" id="cb343-2" title="2"></a>
<a class="sourceLine" id="cb343-3" title="3">g3.nb<span class="fl">.1</span> &lt;-<span class="st"> </span><span class="kw">glmmTMB</span>(het.annual.floral.density <span class="op">~</span><span class="st"> </span>flowering <span class="op">+</span><span class="st"> </span>treatment <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>repID), <span class="dt">family =</span> <span class="st">&quot;nbinom2&quot;</span>, <span class="dt">data =</span> visits)</a>
<a class="sourceLine" id="cb343-4" title="4"></a>
<a class="sourceLine" id="cb343-5" title="5">g3.nb.null &lt;-<span class="st"> </span><span class="kw">glmmTMB</span>(het.annual.floral.density <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>repID), <span class="dt">family =</span> <span class="st">&quot;nbinom2&quot;</span>, <span class="dt">data =</span> visits)</a>
<a class="sourceLine" id="cb343-6" title="6"></a>
<a class="sourceLine" id="cb343-7" title="7">g3.p &lt;-<span class="st"> </span><span class="kw">glmmTMB</span>(het.annual.floral.density <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>repID), <span class="dt">family =</span> <span class="st">&quot;poisson&quot;</span>, <span class="dt">data =</span> visits)</a>
<a class="sourceLine" id="cb343-8" title="8"></a>
<a class="sourceLine" id="cb343-9" title="9">g3.nb.type1 &lt;-<span class="st"> </span><span class="kw">glmmTMB</span>(het.annual.floral.density <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>repID), <span class="dt">family =</span> <span class="st">&quot;nbinom1&quot;</span>, <span class="dt">data =</span> visits) </a>
<a class="sourceLine" id="cb343-10" title="10"></a>
<a class="sourceLine" id="cb343-11" title="11"><span class="kw">summary</span>(g3.nb)</a></code></pre></div>
<pre><code>##  Family: nbinom2  ( log )
## Formula:          
## het.annual.floral.density ~ flowering * treatment + (1 | repID)
## Data: visits
## 
##      AIC      BIC   logLik deviance df.resid 
##    496.9    517.6   -242.4    484.9      225 
## 
## Random effects:
## 
## Conditional model:
##  Groups Name        Variance  Std.Dev. 
##  repID  (Intercept) 1.802e-08 0.0001342
## Number of obs: 231, groups:  repID, 122
## 
## Overdispersion parameter for nbinom2 family (): 0.161 
## 
## Conditional model:
##                               Estimate Std. Error z value Pr(&gt;|z|)  
## (Intercept)                    0.45676    0.34682   1.317   0.1878  
## floweringbloom                -1.13251    0.51375  -2.204   0.0275 *
## treatmentshrub                -0.06839    0.48708  -0.140   0.8883  
## floweringbloom:treatmentshrub -0.48309    0.73961  -0.653   0.5136  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb345"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb345-1" title="1"><span class="kw">summary</span>(g3.nb<span class="fl">.1</span>)</a></code></pre></div>
<pre><code>##  Family: nbinom2  ( log )
## Formula:          
## het.annual.floral.density ~ flowering + treatment + (1 | repID)
## Data: visits
## 
##      AIC      BIC   logLik deviance df.resid 
##    495.3    512.5   -242.7    485.3      226 
## 
## Random effects:
## 
## Conditional model:
##  Groups Name        Variance  Std.Dev. 
##  repID  (Intercept) 4.096e-08 0.0002024
## Number of obs: 231, groups:  repID, 122
## 
## Overdispersion parameter for nbinom2 family (): 0.16 
## 
## Conditional model:
##                Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)      0.5679     0.3174   1.789 0.073560 .  
## floweringbloom  -1.3664     0.3714  -3.680 0.000234 ***
## treatmentshrub  -0.2787     0.3686  -0.756 0.449489    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb347"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb347-1" title="1"><span class="kw">summary</span>(g3.nb.null)</a></code></pre></div>
<pre><code>##  Family: nbinom2  ( log )
## Formula:          het.annual.floral.density ~ 1 + (1 | repID)
## Data: visits
## 
##      AIC      BIC   logLik deviance df.resid 
##    502.0    512.4   -248.0    496.0      228 
## 
## Random effects:
## 
## Conditional model:
##  Groups Name        Variance Std.Dev.
##  repID  (Intercept) 0.6587   0.8116  
## Number of obs: 231, groups:  repID, 122
## 
## Overdispersion parameter for nbinom2 family (): 0.172 
## 
## Conditional model:
##             Estimate Std. Error z value Pr(&gt;|z|)
## (Intercept)  -0.3425     0.2834  -1.209    0.227</code></pre>
<div class="sourceCode" id="cb349"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb349-1" title="1"><span class="kw">anova</span>(g3.nb, g3.nb.null, g3.nb<span class="fl">.1</span>, g3.p, g3.nb.type1, <span class="dt">test =</span> <span class="st">&quot;Chisq&quot;</span>)</a></code></pre></div>
<pre><code>## Data: visits
## Models:
## g3.p: het.annual.floral.density ~ 1 + (1 | repID), zi=~0, disp=~1
## g3.nb.null: het.annual.floral.density ~ 1 + (1 | repID), zi=~0, disp=~1
## g3.nb.type1: het.annual.floral.density ~ 1 + (1 | repID), zi=~0, disp=~1
## g3.nb.1: het.annual.floral.density ~ flowering + treatment + (1 | repID), zi=~0, disp=~1
## g3.nb: het.annual.floral.density ~ flowering * treatment + (1 | repID), zi=~0, disp=~1
##             Df    AIC    BIC  logLik deviance    Chisq Chi Df Pr(&gt;Chisq)
## g3.p         2 656.25 663.14 -326.13   652.25                           
## g3.nb.null   3 502.04 512.37 -248.02   496.04 156.2088      1  &lt; 2.2e-16
## g3.nb.type1  3 503.76 514.08 -248.88   497.76   0.0000      0   1.000000
## g3.nb.1      5 495.32 512.53 -242.66   485.32  12.4342      2   0.001995
## g3.nb        6 496.90 517.55 -242.45   484.90   0.4255      1   0.514183
##                
## g3.p           
## g3.nb.null  ***
## g3.nb.type1    
## g3.nb.1     ** 
## g3.nb          
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb351"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb351-1" title="1">car<span class="op">::</span><span class="kw">Anova</span>(g3.nb<span class="fl">.1</span>, <span class="dt">type =</span> <span class="dv">2</span>)</a></code></pre></div>
<pre><code>## Analysis of Deviance Table (Type II Wald chisquare tests)
## 
## Response: het.annual.floral.density
##             Chisq Df Pr(&gt;Chisq)    
## flowering 13.5397  1  0.0002336 ***
## treatment  0.5719  1  0.4494890    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb353"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb353-1" title="1"><span class="kw">AIC</span>(g3.nb, g3.nb<span class="fl">.1</span>, g3.p, g3.nb.type1, g3.nb.null)</a></code></pre></div>
<pre><code>##             df      AIC
## g3.nb        6 496.8968
## g3.nb.1      5 495.3223
## g3.p         2 656.2507
## g3.nb.type1  3 503.7565
## g3.nb.null   3 502.0419</code></pre>
<div class="sourceCode" id="cb355"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb355-1" title="1"><span class="co">#negative binomial type 2, additive model</span></a>
<a class="sourceLine" id="cb355-2" title="2"></a>
<a class="sourceLine" id="cb355-3" title="3"><span class="kw">ggplot</span>(visits, <span class="kw">aes</span>(treatment, het.annual.floral.density)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_boxplot</span>() <span class="op">+</span><span class="st"> </span><span class="kw">facet_grid</span>(<span class="op">~</span>flowering, <span class="dt">labeller=</span><span class="kw">labeller</span>(<span class="dt">flowering =</span> labels)) <span class="op">+</span><span class="st"> </span><span class="kw">theme_Publication</span>() <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Microsite&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Heterospecific Annual Floral Density&quot;</span>)</a></code></pre></div>
<pre><code>## Warning: `legend.margin` must be specified using `margin()`. For the old
## behavior use legend.spacing</code></pre>
<pre><code>## Warning: Removed 4 rows containing non-finite values (stat_boxplot).</code></pre>
<pre><code>## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font family not found in Windows font database

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font family not found in Windows font database

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font family not found in Windows font database</code></pre>
<pre><code>## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x,
## x$y, : font family not found in Windows font database</code></pre>
<pre><code>## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font family not found in Windows font database

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font family not found in Windows font database</code></pre>
<pre><code>## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x,
## x$y, : font family not found in Windows font database</code></pre>
<p><img src="index_files/figure-html/annual%20floral%20density-2.png" width="672" /></p>
<hr />
<p>Blooming shrub density</p>
<div class="sourceCode" id="cb362"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb362-1" title="1"><span class="kw">mean</span>(visits<span class="op">$</span>het.shrub.blooming.neighbours, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 1.744589</code></pre>
<div class="sourceCode" id="cb364"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb364-1" title="1"><span class="kw">sd</span>(visits<span class="op">$</span>het.shrub.blooming.neighbours, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 2.375537</code></pre>
<div class="sourceCode" id="cb366"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb366-1" title="1"><span class="kw">ggplot</span>(visits, <span class="kw">aes</span>(het.shrub.blooming.neighbours)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_density</span>(<span class="dt">kernel =</span> <span class="st">&quot;gaussian&quot;</span>)</a></code></pre></div>
<pre><code>## Warning: Removed 4 rows containing non-finite values (stat_density).</code></pre>
<p><img src="index_files/figure-html/shrub%20density-1.png" width="672" /></p>
<div class="sourceCode" id="cb368"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb368-1" title="1">g4.nb &lt;-<span class="st"> </span><span class="kw">glmmTMB</span>(het.shrub.blooming.neighbours <span class="op">~</span><span class="st"> </span>flowering <span class="op">*</span><span class="st"> </span>treatment <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>repID), <span class="dt">family =</span> <span class="st">&quot;nbinom2&quot;</span>, <span class="dt">data =</span> visits)</a></code></pre></div>
<pre><code>## Warning in fitTMB(TMBStruc): Model convergence problem; non-positive-
## definite Hessian matrix. See vignette(&#39;troubleshooting&#39;)</code></pre>
<pre><code>## Warning in fitTMB(TMBStruc): Model convergence problem; false convergence
## (8). See vignette(&#39;troubleshooting&#39;)</code></pre>
<div class="sourceCode" id="cb371"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb371-1" title="1">g4.nb<span class="fl">.1</span> &lt;-<span class="st"> </span><span class="kw">glmmTMB</span>(het.shrub.blooming.neighbours <span class="op">~</span><span class="st"> </span>flowering <span class="op">+</span><span class="st"> </span>treatment <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>repID), <span class="dt">family =</span> <span class="st">&quot;nbinom2&quot;</span>,<span class="dt">data =</span> visits)</a></code></pre></div>
<pre><code>## Warning in fitTMB(TMBStruc): Model convergence problem; false convergence
## (8). See vignette(&#39;troubleshooting&#39;)</code></pre>
<div class="sourceCode" id="cb373"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb373-1" title="1">g4.nb.null &lt;-<span class="st"> </span><span class="kw">glmmTMB</span>(het.shrub.blooming.neighbours <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>repID), <span class="dt">family =</span> <span class="st">&quot;nbinom2&quot;</span>,<span class="dt">data =</span> visits)</a>
<a class="sourceLine" id="cb373-2" title="2"><span class="kw">summary</span>(g4.nb)</a></code></pre></div>
<pre><code>##  Family: nbinom2  ( log )
## Formula:          
## het.shrub.blooming.neighbours ~ flowering * treatment + (1 |      repID)
## Data: visits
## 
##      AIC      BIC   logLik deviance df.resid 
##       NA       NA       NA       NA      225 
## 
## Random effects:
## 
## Conditional model:
##  Groups Name        Variance Std.Dev.
##  repID  (Intercept) 0.575    0.7583  
## Number of obs: 231, groups:  repID, 122
## 
## Overdispersion parameter for nbinom2 family (): 4.71e+06 
## 
## Conditional model:
##                               Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)                   -1.02649    0.22277  -4.608 4.07e-06 ***
## floweringbloom                 1.62654    0.20924   7.774 7.62e-15 ***
## treatmentshrub                 0.30524    0.29057   1.050    0.293    
## floweringbloom:treatmentshrub  0.07431    0.27527   0.270    0.787    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb375"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb375-1" title="1"><span class="kw">summary</span>(g4.nb<span class="fl">.1</span>)</a></code></pre></div>
<pre><code>##  Family: nbinom2  ( log )
## Formula:          
## het.shrub.blooming.neighbours ~ flowering + treatment + (1 |      repID)
## Data: visits
## 
##      AIC      BIC   logLik deviance df.resid 
##    738.0    755.3   -364.0    728.0      226 
## 
## Random effects:
## 
## Conditional model:
##  Groups Name        Variance Std.Dev.
##  repID  (Intercept) 0.5751   0.7584  
## Number of obs: 231, groups:  repID, 122
## 
## Overdispersion parameter for nbinom2 family (): 1.04e+07 
## 
## Conditional model:
##                Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)     -1.0623     0.1807  -5.880  4.1e-09 ***
## floweringbloom   1.6699     0.1360  12.278  &lt; 2e-16 ***
## treatmentshrub   0.3666     0.1813   2.022   0.0432 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb377"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb377-1" title="1"><span class="kw">summary</span>(g4.nb.null)</a></code></pre></div>
<pre><code>##  Family: nbinom2  ( log )
## Formula:          het.shrub.blooming.neighbours ~ 1 + (1 | repID)
## Data: visits
## 
##      AIC      BIC   logLik deviance df.resid 
##    832.8    843.1   -413.4    826.8      228 
## 
## Random effects:
## 
## Conditional model:
##  Groups Name        Variance  Std.Dev. 
##  repID  (Intercept) 3.744e-09 6.119e-05
## Number of obs: 231, groups:  repID, 122
## 
## Overdispersion parameter for nbinom2 family (): 0.695 
## 
## Conditional model:
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)  0.55652    0.09332   5.963 2.47e-09 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb379"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb379-1" title="1"><span class="kw">anova</span>(g4.nb, g4.nb.null, g4.nb<span class="fl">.1</span>, <span class="dt">test =</span> <span class="st">&quot;Chisq&quot;</span>)</a></code></pre></div>
<pre><code>## Data: visits
## Models:
## g4.nb.null: het.shrub.blooming.neighbours ~ 1 + (1 | repID), zi=~0, disp=~1
## g4.nb.1: het.shrub.blooming.neighbours ~ flowering + treatment + (1 | , zi=~0, disp=~1
## g4.nb.1:     repID), zi=~0, disp=~1
## g4.nb: het.shrub.blooming.neighbours ~ flowering * treatment + (1 | , zi=~0, disp=~1
## g4.nb:     repID), zi=~0, disp=~1
##            Df    AIC    BIC  logLik deviance  Chisq Chi Df Pr(&gt;Chisq)    
## g4.nb.null  3 832.76 843.09 -413.38   826.76                             
## g4.nb.1     5 738.04 755.25 -364.02   728.04 98.721      2  &lt; 2.2e-16 ***
## g4.nb       6                                            1               
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb381"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb381-1" title="1">car<span class="op">::</span><span class="kw">Anova</span>(g4.nb<span class="fl">.1</span>, <span class="dt">type =</span> <span class="dv">2</span>)</a></code></pre></div>
<pre><code>## Analysis of Deviance Table (Type II Wald chisquare tests)
## 
## Response: het.shrub.blooming.neighbours
##              Chisq Df Pr(&gt;Chisq)    
## flowering 150.7484  1    &lt; 2e-16 ***
## treatment   4.0892  1    0.04316 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb383"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb383-1" title="1"><span class="kw">AIC</span>(g4.nb, g4.nb<span class="fl">.1</span>, g4.nb.null)</a></code></pre></div>
<pre><code>##            df      AIC
## g4.nb       6       NA
## g4.nb.1     5 738.0419
## g4.nb.null  3 832.7629</code></pre>
<div class="sourceCode" id="cb385"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb385-1" title="1"><span class="kw">ggplot</span>(visits, <span class="kw">aes</span>(treatment, het.shrub.blooming.neighbours)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_boxplot</span>() <span class="op">+</span><span class="st"> </span><span class="kw">theme_Publication</span>() <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Blooming Shrubs within 2 m&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Microsite&quot;</span>)   </a></code></pre></div>
<pre><code>## Warning: `legend.margin` must be specified using `margin()`. For the old
## behavior use legend.spacing</code></pre>
<pre><code>## Warning: Removed 4 rows containing non-finite values (stat_boxplot).</code></pre>
<pre><code>## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font family not found in Windows font database

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font family not found in Windows font database

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font family not found in Windows font database

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font family not found in Windows font database

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font family not found in Windows font database

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font family not found in Windows font database

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font family not found in Windows font database</code></pre>
<pre><code>## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x,
## x$y, : font family not found in Windows font database</code></pre>
<p><img src="index_files/figure-html/shrub%20density-2.png" width="672" /></p>
<div class="sourceCode" id="cb390"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb390-1" title="1"><span class="kw">ggplot</span>(visits, <span class="kw">aes</span>(treatment, het.shrub.blooming.neighbours)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_boxplot</span>() <span class="op">+</span><span class="st"> </span><span class="kw">theme_Publication</span>() <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Blooming Shrubs within 2 m&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Microsite&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">facet_grid</span>(<span class="op">~</span>flowering,<span class="dt">labeller=</span><span class="kw">labeller</span>(<span class="dt">flowering =</span> labels)) </a></code></pre></div>
<pre><code>## Warning: `legend.margin` must be specified using `margin()`. For the old
## behavior use legend.spacing</code></pre>
<pre><code>## Warning: Removed 4 rows containing non-finite values (stat_boxplot).</code></pre>
<pre><code>## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font family not found in Windows font database

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font family not found in Windows font database

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font family not found in Windows font database</code></pre>
<pre><code>## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x,
## x$y, : font family not found in Windows font database</code></pre>
<pre><code>## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font family not found in Windows font database

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font family not found in Windows font database</code></pre>
<pre><code>## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x,
## x$y, : font family not found in Windows font database</code></pre>
<p><img src="index_files/figure-html/shrub%20density-3.png" width="672" /></p>
<hr />
<p>Blooming cactus density</p>
<div class="sourceCode" id="cb397"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb397-1" title="1"><span class="kw">mean</span>(visits<span class="op">$</span>het.cactus.blooming.neighbours, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.1341991</code></pre>
<div class="sourceCode" id="cb399"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb399-1" title="1"><span class="kw">sd</span>(visits<span class="op">$</span>het.cactus.blooming.neighbours, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.6214983</code></pre>
<div class="sourceCode" id="cb401"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb401-1" title="1"><span class="kw">ggplot</span>(visits, <span class="kw">aes</span>(het.cactus.blooming.neighbours)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_density</span>(<span class="dt">kernel =</span> <span class="st">&quot;gaussian&quot;</span>)</a></code></pre></div>
<pre><code>## Warning: Removed 4 rows containing non-finite values (stat_density).</code></pre>
<p><img src="index_files/figure-html/cactus%20density-1.png" width="672" /></p>
<div class="sourceCode" id="cb403"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb403-1" title="1">g5.nb &lt;-<span class="st"> </span><span class="kw">glmmTMB</span>(het.cactus.blooming.neighbours <span class="op">~</span><span class="st"> </span>flowering <span class="op">*</span><span class="st"> </span>treatment <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>repID), <span class="dt">family =</span> <span class="st">&quot;nbinom2&quot;</span>, <span class="dt">data =</span> visits)</a></code></pre></div>
<pre><code>## Warning in fitTMB(TMBStruc): Model convergence problem; false convergence
## (8). See vignette(&#39;troubleshooting&#39;)</code></pre>
<div class="sourceCode" id="cb405"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb405-1" title="1">g5.ps &lt;-<span class="st"> </span><span class="kw">glmmTMB</span>(het.cactus.blooming.neighbours <span class="op">~</span><span class="st"> </span>flowering <span class="op">*</span><span class="st"> </span>treatment <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>repID), <span class="dt">family =</span> <span class="kw">poisson</span>(<span class="dt">link =</span> <span class="st">&quot;log&quot;</span>), <span class="dt">data =</span> visits)</a>
<a class="sourceLine" id="cb405-2" title="2">g5.ps<span class="fl">.1</span> &lt;-<span class="st"> </span><span class="kw">glmmTMB</span>(het.cactus.blooming.neighbours <span class="op">~</span><span class="st"> </span>flowering <span class="op">+</span><span class="st"> </span>treatment <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>repID), <span class="dt">family =</span> <span class="kw">poisson</span>(<span class="dt">link =</span> <span class="st">&quot;log&quot;</span>), <span class="dt">data =</span> visits)</a>
<a class="sourceLine" id="cb405-3" title="3">g5.ps.null &lt;-<span class="st"> </span><span class="kw">glmmTMB</span>(het.cactus.blooming.neighbours <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>repID), <span class="dt">family =</span> <span class="kw">poisson</span>(<span class="dt">link =</span><span class="st">&quot;log&quot;</span>), <span class="dt">data =</span> visits)</a>
<a class="sourceLine" id="cb405-4" title="4"></a>
<a class="sourceLine" id="cb405-5" title="5"></a>
<a class="sourceLine" id="cb405-6" title="6"><span class="kw">summary</span>(g5.ps)</a></code></pre></div>
<pre><code>##  Family: poisson  ( log )
## Formula:          
## het.cactus.blooming.neighbours ~ flowering * treatment + (1 |      repID)
## Data: visits
## 
##      AIC      BIC   logLik deviance df.resid 
##    157.5    174.7    -73.7    147.5      226 
## 
## Random effects:
## 
## Conditional model:
##  Groups Name        Variance Std.Dev.
##  repID  (Intercept) 3.831    1.957   
## Number of obs: 231, groups:  repID, 122
## 
## Conditional model:
##                               Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)                    -5.8452     1.2449  -4.695 2.66e-06 ***
## floweringbloom                  2.8423     1.0296   2.761  0.00577 ** 
## treatmentshrub                  0.3961     1.4973   0.265  0.79136    
## floweringbloom:treatmentshrub  -0.3329     1.4649  -0.227  0.82024    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb407"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb407-1" title="1"><span class="kw">summary</span>(g5.ps<span class="fl">.1</span>)</a></code></pre></div>
<pre><code>##  Family: poisson  ( log )
## Formula:          
## het.cactus.blooming.neighbours ~ flowering + treatment + (1 |      repID)
## Data: visits
## 
##      AIC      BIC   logLik deviance df.resid 
##    155.5    169.3    -73.8    147.5      227 
## 
## Random effects:
## 
## Conditional model:
##  Groups Name        Variance Std.Dev.
##  repID  (Intercept) 3.83     1.957   
## Number of obs: 231, groups:  repID, 122
## 
## Conditional model:
##                Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)    -5.70199    1.03652  -5.501 3.77e-08 ***
## floweringbloom  2.68982    0.73167   3.676 0.000237 ***
## treatmentshrub  0.08604    0.61835   0.139 0.889333    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb409"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb409-1" title="1"><span class="kw">summary</span>(g5.ps.null)</a></code></pre></div>
<pre><code>##  Family: poisson  ( log )
## Formula:          het.cactus.blooming.neighbours ~ 1 + (1 | repID)
## Data: visits
## 
##      AIC      BIC   logLik deviance df.resid 
##    180.0    186.9    -88.0    176.0      229 
## 
## Random effects:
## 
## Conditional model:
##  Groups Name        Variance Std.Dev.
##  repID  (Intercept) 3.847    1.961   
## Number of obs: 231, groups:  repID, 122
## 
## Conditional model:
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)  -3.6166     0.6807  -5.313 1.08e-07 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb411"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb411-1" title="1"><span class="kw">anova</span>(g5.nb, g5.ps, g5.ps.null, g5.ps<span class="fl">.1</span>, <span class="dt">test =</span> <span class="st">&quot;Chisq&quot;</span>)</a></code></pre></div>
<pre><code>## Data: visits
## Models:
## g5.ps.null: het.cactus.blooming.neighbours ~ 1 + (1 | repID), zi=~0, disp=~1
## g5.ps.1: het.cactus.blooming.neighbours ~ flowering + treatment + (1 | , zi=~0, disp=~1
## g5.ps.1:     repID), zi=~0, disp=~1
## g5.ps: het.cactus.blooming.neighbours ~ flowering * treatment + (1 | , zi=~0, disp=~1
## g5.ps:     repID), zi=~0, disp=~1
## g5.nb: het.cactus.blooming.neighbours ~ flowering * treatment + (1 | , zi=~0, disp=~1
## g5.nb:     repID), zi=~0, disp=~1
##            Df    AIC    BIC  logLik deviance   Chisq Chi Df Pr(&gt;Chisq)    
## g5.ps.null  2 179.99 186.87 -87.993   175.99                              
## g5.ps.1     4 155.55 169.32 -73.773   147.55 28.4391      2  6.676e-07 ***
## g5.ps       5 157.50 174.71 -73.747   147.50  0.0515      1     0.8206    
## g5.nb       6 159.49 180.15 -73.747   147.49  0.0006      1     0.9805    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb413"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb413-1" title="1">car<span class="op">::</span><span class="kw">Anova</span>(g5.ps<span class="fl">.1</span>, <span class="dt">type =</span> <span class="dv">2</span>)</a></code></pre></div>
<pre><code>## Analysis of Deviance Table (Type II Wald chisquare tests)
## 
## Response: het.cactus.blooming.neighbours
##             Chisq Df Pr(&gt;Chisq)    
## flowering 13.5150  1  0.0002367 ***
## treatment  0.0194  1  0.8893330    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb415"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb415-1" title="1"><span class="kw">AIC</span>(g5.nb, g5.ps, g5.ps<span class="fl">.1</span>, g5.ps.null)</a></code></pre></div>
<pre><code>##            df      AIC
## g5.nb       6 159.4941
## g5.ps       5 157.4947
## g5.ps.1     4 155.5462
## g5.ps.null  2 179.9853</code></pre>
<div class="sourceCode" id="cb417"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb417-1" title="1"><span class="co">#poisson additive is best</span></a>
<a class="sourceLine" id="cb417-2" title="2"></a>
<a class="sourceLine" id="cb417-3" title="3"></a>
<a class="sourceLine" id="cb417-4" title="4"><span class="kw">ggplot</span>(visits, <span class="kw">aes</span>(treatment, het.cactus.blooming.neighbours)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_boxplot</span>() <span class="op">+</span><span class="st"> </span><span class="kw">facet_grid</span>(<span class="op">~</span>flowering, <span class="dt">labeller=</span><span class="kw">labeller</span>(<span class="dt">flowering =</span> labels)) <span class="op">+</span><span class="st"> </span><span class="kw">theme_Publication</span>() <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Microsite&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Blooming Cactus Density within 2m&quot;</span>)</a></code></pre></div>
<pre><code>## Warning: `legend.margin` must be specified using `margin()`. For the old
## behavior use legend.spacing</code></pre>
<pre><code>## Warning: Removed 4 rows containing non-finite values (stat_boxplot).</code></pre>
<pre><code>## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font family not found in Windows font database

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font family not found in Windows font database

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font family not found in Windows font database</code></pre>
<pre><code>## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x,
## x$y, : font family not found in Windows font database</code></pre>
<pre><code>## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font family not found in Windows font database

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font family not found in Windows font database</code></pre>
<pre><code>## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x,
## x$y, : font family not found in Windows font database</code></pre>
<p><img src="index_files/figure-html/cactus%20density-2.png" width="672" /></p>
<hr />
</div>
<div id="pan-traps" class="section level3">
<h3>Pan traps</h3>
<p>These are models for abundance, species richness, bee abundance and bee richness from pan traps.</p>
<hr />
</div>
<div id="pan-trap-diversity-calculations" class="section level3">
<h3>Pan trap diversity calculations</h3>
<p>This sections calculates diversity indices and exports full env/metadata .csv</p>
<p>Calculations excluding Melyrid beetles</p>
<div class="sourceCode" id="cb424"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb424-1" title="1">insects &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;Output Data/pantraps_wide.csv&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb424-2" title="2"><span class="kw">row.names</span>(insects) &lt;-<span class="st"> </span>insects<span class="op">$</span>uniID</a>
<a class="sourceLine" id="cb424-3" title="3">insects &lt;-<span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(insects, <span class="op">-</span>X, <span class="op">-</span>uniID)</a>
<a class="sourceLine" id="cb424-4" title="4"></a>
<a class="sourceLine" id="cb424-5" title="5"><span class="co">#filter out Melyrid beetles</span></a>
<a class="sourceLine" id="cb424-6" title="6">insects &lt;-<span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(insects, <span class="op">-</span>Melyridae)</a>
<a class="sourceLine" id="cb424-7" title="7">metadata &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;Clean Data/pantraps_cov.csv&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb424-8" title="8">metadata &lt;-<span class="st"> </span><span class="kw">filter</span>(metadata, species <span class="op">!=</span><span class="st"> &quot;buckhorn&quot;</span>)</a>
<a class="sourceLine" id="cb424-9" title="9">metadata<span class="op">$</span>plant.id &lt;-<span class="st"> </span><span class="kw">as.character</span>(metadata<span class="op">$</span>plant.id)</a>
<a class="sourceLine" id="cb424-10" title="10"><span class="kw">str</span>(metadata)</a></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    228 obs. of  8 variables:
##  $ plant.id     : chr  &quot;296&quot; &quot;296&quot; &quot;189&quot; &quot;189&quot; ...
##  $ species      : Factor w/ 2 levels &quot;buckhorn&quot;,&quot;larrea&quot;: 2 2 2 2 2 2 2 2 2 2 ...
##  $ treatment    : Factor w/ 2 levels &quot;open&quot;,&quot;shrub&quot;: 2 1 2 1 2 1 2 1 2 1 ...
##  $ blooming     : Factor w/ 2 levels &quot;post&quot;,&quot;pre&quot;: 2 2 2 2 2 2 2 2 2 2 ...
##  $ date         : Factor w/ 21 levels &quot;4.10.2017&quot;,&quot;4.11.2017&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
##  $ percent.cover: int  15 3 25 2 40 15 40 3 70 10 ...
##  $ perennial    : Factor w/ 5 levels &quot;&quot;,&quot;1&quot;,&quot;2&quot;,&quot;3&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
##  $ X            : Factor w/ 6 levels &quot;&quot;,&quot;blue and white knocked over&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...</code></pre>
<div class="sourceCode" id="cb426"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb426-1" title="1">metadata<span class="op">$</span>uniID &lt;-<span class="st"> </span><span class="kw">paste</span>(metadata<span class="op">$</span>date, metadata<span class="op">$</span>plant.id, metadata<span class="op">$</span>treatment)</a>
<a class="sourceLine" id="cb426-2" title="2"><span class="kw">row.names</span>(metadata) &lt;-<span class="st"> </span>metadata<span class="op">$</span>uniID</a>
<a class="sourceLine" id="cb426-3" title="3"></a>
<a class="sourceLine" id="cb426-4" title="4"></a>
<a class="sourceLine" id="cb426-5" title="5"><span class="co">#check all ids in datasheets are found in the other</span></a>
<a class="sourceLine" id="cb426-6" title="6"><span class="co">#zero.row &lt;- anti_join(metadata, insects, by = &quot;uniID&quot;)</span></a>
<a class="sourceLine" id="cb426-7" title="7"><span class="co">#missing &lt;- anti_join(insects, metadata, by = &quot;uniID&quot;)</span></a>
<a class="sourceLine" id="cb426-8" title="8"><span class="co">#write.csv(zero.row, &quot;zeroreps.csv&quot;)</span></a>
<a class="sourceLine" id="cb426-9" title="9"></a>
<a class="sourceLine" id="cb426-10" title="10"><span class="co">#check if insects and metadata are the same</span></a>
<a class="sourceLine" id="cb426-11" title="11"><span class="kw">all.equal</span>(<span class="kw">rownames</span>(insects), <span class="kw">rownames</span>(metadata))</a></code></pre></div>
<pre><code>## [1] &quot;214 string mismatches&quot;</code></pre>
<div class="sourceCode" id="cb428"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb428-1" title="1"><span class="co">#sort into the same order</span></a>
<a class="sourceLine" id="cb428-2" title="2">metadata &lt;-<span class="st"> </span>metadata[<span class="kw">rownames</span>(insects), ]</a>
<a class="sourceLine" id="cb428-3" title="3"><span class="co">#confirm - woo!</span></a>
<a class="sourceLine" id="cb428-4" title="4"><span class="kw">all.equal</span>(<span class="kw">rownames</span>(insects), <span class="kw">rownames</span>(metadata))</a></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb430"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb430-1" title="1"><span class="co">#grab and wrangle weather stn data</span></a>
<a class="sourceLine" id="cb430-2" title="2">weather &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;Clean Data/pantraps_weather.csv&quot;</span>)</a>
<a class="sourceLine" id="cb430-3" title="3"><span class="kw">str</span>(weather)</a></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    152 obs. of  12 variables:
##  $ date            : Factor w/ 19 levels &quot;4.10.2017&quot;,&quot;4.11.2017&quot;,..: 1 2 3 4 5 6 7 8 9 10 ...
##  $ Hour            : Factor w/ 8 levels &quot;1:00 PM&quot;,&quot;10:00 AM&quot;,..: 2 2 2 2 2 2 2 2 2 2 ...
##  $ Solar           : num  0.81 0.79 0.8 0.81 0.81 0.8 0.63 0.82 0.84 0.76 ...
##  $ Wind            : num  3.9 4.1 5.1 4.9 4.5 3.2 3.3 4.3 4.6 4.7 ...
##  $ Max             : num  9 10.7 9.7 8.6 7.8 7.6 7.2 8.2 8.2 8.2 ...
##  $ Air.Temperature : num  15 15.6 16.9 18.5 19.8 21 21.1 20.7 20.2 18.8 ...
##  $ Soil.Temperature: num  18.9 18.8 18.7 18.8 19 19.3 19.8 20.4 21 21.5 ...
##  $ Humidity        : int  43 42 38 32 29 27 26 26 26 25 ...
##  $ Dew             : num  2.4 2.6 2.4 1.7 1.4 1.1 1.1 0.8 -0.1 -1.6 ...
##  $ Wet             : num  8.2 8.6 9.1 9.5 9.9 10.3 10.3 10 9.5 8.5 ...
##  $ Baro.           : int  873 873 873 873 872 872 872 872 871 871 ...
##  $ Total           : int  0 0 0 0 0 0 0 0 0 0 ...</code></pre>
<div class="sourceCode" id="cb432"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb432-1" title="1">weather.av &lt;-<span class="st"> </span>weather <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(., date) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarise</span>(., <span class="dt">mean.Solar =</span> <span class="kw">mean</span>(Solar), <span class="dt">mean.Wind =</span> <span class="kw">mean</span>(Wind), <span class="dt">mean.MaxWind =</span> <span class="kw">mean</span>(Max), <span class="dt">mean.Temp =</span> <span class="kw">mean</span>(Air.Temperature))</a>
<a class="sourceLine" id="cb432-2" title="2">metadata &lt;-<span class="st"> </span><span class="kw">right_join</span>(weather.av, metadata, <span class="dt">by =</span> <span class="st">&quot;date&quot;</span>)</a></code></pre></div>
<pre><code>## Warning: Column `date` joining factors with different levels, coercing to
## character vector</code></pre>
<div class="sourceCode" id="cb434"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb434-1" title="1"><span class="co">#calculate abundances using vegan</span></a>
<a class="sourceLine" id="cb434-2" title="2">metadata<span class="op">$</span>abun &lt;-<span class="st"> </span><span class="kw">apply</span>(insects, <span class="dv">1</span>, sum)</a>
<a class="sourceLine" id="cb434-3" title="3"><span class="co">#check for total</span></a>
<a class="sourceLine" id="cb434-4" title="4"><span class="kw">sum</span>(metadata<span class="op">$</span>abun)</a></code></pre></div>
<pre><code>## [1] 2144</code></pre>
<div class="sourceCode" id="cb436"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb436-1" title="1">H &lt;-<span class="st"> </span><span class="kw">diversity</span>(insects)</a>
<a class="sourceLine" id="cb436-2" title="2">simp &lt;-<span class="st"> </span><span class="kw">diversity</span>(insects, <span class="st">&quot;simpson&quot;</span>)</a>
<a class="sourceLine" id="cb436-3" title="3">S &lt;-<span class="st"> </span><span class="kw">specnumber</span>(insects)</a>
<a class="sourceLine" id="cb436-4" title="4">J &lt;-<span class="st"> </span>H<span class="op">/</span><span class="kw">log</span>(S)</a>
<a class="sourceLine" id="cb436-5" title="5">metadata<span class="op">$</span>H &lt;-<span class="st"> </span>H</a>
<a class="sourceLine" id="cb436-6" title="6">metadata<span class="op">$</span>Simpson &lt;-<span class="st"> </span>simp</a>
<a class="sourceLine" id="cb436-7" title="7">metadata<span class="op">$</span>Species &lt;-<span class="st"> </span>S</a>
<a class="sourceLine" id="cb436-8" title="8">metadata<span class="op">$</span>Even &lt;-<span class="st"> </span>J</a>
<a class="sourceLine" id="cb436-9" title="9"></a>
<a class="sourceLine" id="cb436-10" title="10"><span class="kw">summary</span>(metadata)</a></code></pre></div>
<pre><code>##      date             mean.Solar       mean.Wind      mean.MaxWind   
##  Length:228         Min.   :0.5737   Min.   :3.525   Min.   : 9.238  
##  Class :character   1st Qu.:0.6663   1st Qu.:4.787   1st Qu.: 9.625  
##  Mode  :character   Median :0.7688   Median :5.175   Median :10.050  
##                     Mean   :0.7419   Mean   :5.241   Mean   :10.184  
##                     3rd Qu.:0.7987   3rd Qu.:6.025   3rd Qu.:10.512  
##                     Max.   :0.8125   Max.   :6.662   Max.   :11.537  
##                                                                      
##    mean.Temp       plant.id             species    treatment   blooming  
##  Min.   :17.16   Length:228         buckhorn:  0   open :114   post:120  
##  1st Qu.:17.40   Class :character   larrea  :228   shrub:114   pre :108  
##  Median :17.86   Mode  :character                                        
##  Mean   :18.46                                                           
##  3rd Qu.:18.56                                                           
##  Max.   :28.51                                                           
##                                                                          
##  percent.cover   perennial                            X      
##  Min.   : 1.00       :223                              :227  
##  1st Qu.: 2.00   1   :  4   blue and white knocked over:  1  
##  Median :10.00   2   :  1   east                       :  0  
##  Mean   :18.82   3   :  0   east side                  :  0  
##  3rd Qu.:30.00   east:  0   north                      :  0  
##  Max.   :80.00              yellow knocked over        :  0  
##                                                              
##     uniID                abun              H            Simpson      
##  Length:228         Min.   : 0.000   Min.   :0.000   Min.   :0.0000  
##  Class :character   1st Qu.: 5.000   1st Qu.:1.332   1st Qu.:0.7321  
##  Mode  :character   Median : 9.000   Median :1.748   Median :0.8056  
##                     Mean   : 9.404   Mean   :1.583   Mean   :0.7569  
##                     3rd Qu.:12.000   3rd Qu.:1.994   3rd Qu.:0.8571  
##                     Max.   :30.000   Max.   :2.516   Max.   :1.0000  
##                                                                      
##     Species            Even       
##  Min.   : 0.000   Min.   :0.0000  
##  1st Qu.: 4.000   1st Qu.:0.9138  
##  Median : 6.000   Median :0.9577  
##  Mean   : 6.254   Mean   :0.9104  
##  3rd Qu.: 8.000   3rd Qu.:0.9821  
##  Max.   :15.000   Max.   :1.0000  
##                   NA&#39;s   :6</code></pre>
<div class="sourceCode" id="cb438"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb438-1" title="1"><span class="co">#no Melyrid beetle output</span></a>
<a class="sourceLine" id="cb438-2" title="2"><span class="kw">write.csv</span>(metadata, <span class="st">&quot;Output Data/metadata_nobeetle.csv&quot;</span>)</a>
<a class="sourceLine" id="cb438-3" title="3"><span class="kw">write.csv</span>(insects, <span class="st">&quot;Output Data/wide_nobeetle.csv&quot;</span>)</a></code></pre></div>
<p>Calculations including Melyrid beetles</p>
<div class="sourceCode" id="cb439"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb439-1" title="1"><span class="co">#with beetles</span></a>
<a class="sourceLine" id="cb439-2" title="2">insects &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;Output Data/pantraps_wide.csv&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb439-3" title="3"><span class="kw">row.names</span>(insects) &lt;-<span class="st"> </span>insects<span class="op">$</span>uniID</a>
<a class="sourceLine" id="cb439-4" title="4">insects &lt;-<span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(insects, <span class="op">-</span>X, <span class="op">-</span>uniID, <span class="op">-</span>Zeroes)</a>
<a class="sourceLine" id="cb439-5" title="5"><span class="co">#filter out beetles</span></a>
<a class="sourceLine" id="cb439-6" title="6"><span class="co">#insects &lt;- dplyr::select(insects, -Melyridae, -Melyridae.)</span></a>
<a class="sourceLine" id="cb439-7" title="7">metadata &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;Clean Data/pantraps_cov.csv&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb439-8" title="8">metadata &lt;-<span class="st"> </span><span class="kw">filter</span>(metadata, species <span class="op">!=</span><span class="st"> &quot;buckhorn&quot;</span>)</a>
<a class="sourceLine" id="cb439-9" title="9">metadata<span class="op">$</span>plant.id &lt;-<span class="st"> </span><span class="kw">as.character</span>(metadata<span class="op">$</span>plant.id)</a>
<a class="sourceLine" id="cb439-10" title="10"><span class="kw">str</span>(metadata)</a></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    228 obs. of  8 variables:
##  $ plant.id     : chr  &quot;296&quot; &quot;296&quot; &quot;189&quot; &quot;189&quot; ...
##  $ species      : Factor w/ 2 levels &quot;buckhorn&quot;,&quot;larrea&quot;: 2 2 2 2 2 2 2 2 2 2 ...
##  $ treatment    : Factor w/ 2 levels &quot;open&quot;,&quot;shrub&quot;: 2 1 2 1 2 1 2 1 2 1 ...
##  $ blooming     : Factor w/ 2 levels &quot;post&quot;,&quot;pre&quot;: 2 2 2 2 2 2 2 2 2 2 ...
##  $ date         : Factor w/ 21 levels &quot;4.10.2017&quot;,&quot;4.11.2017&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
##  $ percent.cover: int  15 3 25 2 40 15 40 3 70 10 ...
##  $ perennial    : Factor w/ 5 levels &quot;&quot;,&quot;1&quot;,&quot;2&quot;,&quot;3&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
##  $ X            : Factor w/ 6 levels &quot;&quot;,&quot;blue and white knocked over&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...</code></pre>
<div class="sourceCode" id="cb441"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb441-1" title="1">metadata<span class="op">$</span>uniID &lt;-<span class="st"> </span><span class="kw">paste</span>(metadata<span class="op">$</span>date, metadata<span class="op">$</span>plant.id, metadata<span class="op">$</span>treatment)</a>
<a class="sourceLine" id="cb441-2" title="2"><span class="kw">row.names</span>(metadata) &lt;-<span class="st"> </span>metadata<span class="op">$</span>uniID</a>
<a class="sourceLine" id="cb441-3" title="3"></a>
<a class="sourceLine" id="cb441-4" title="4"></a>
<a class="sourceLine" id="cb441-5" title="5"><span class="co">#check all ids in datasheets are found in the other</span></a>
<a class="sourceLine" id="cb441-6" title="6"><span class="co">#zero.row &lt;- anti_join(metadata, insects, by = &quot;uniID&quot;)</span></a>
<a class="sourceLine" id="cb441-7" title="7"><span class="co">#missing &lt;- anti_join(insects, metadata, by = &quot;uniID&quot;)</span></a>
<a class="sourceLine" id="cb441-8" title="8"><span class="co">#write.csv(zero.row, &quot;zeroreps.csv&quot;)</span></a>
<a class="sourceLine" id="cb441-9" title="9"><span class="co">#check if insects and metadata are the same</span></a>
<a class="sourceLine" id="cb441-10" title="10"><span class="kw">all.equal</span>(<span class="kw">rownames</span>(insects), <span class="kw">rownames</span>(metadata))</a></code></pre></div>
<pre><code>## [1] &quot;214 string mismatches&quot;</code></pre>
<div class="sourceCode" id="cb443"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb443-1" title="1"><span class="co">#sort into the same order</span></a>
<a class="sourceLine" id="cb443-2" title="2">metadata &lt;-<span class="st"> </span>metadata[<span class="kw">rownames</span>(insects), ]</a>
<a class="sourceLine" id="cb443-3" title="3"><span class="co">#confirm - woo!</span></a>
<a class="sourceLine" id="cb443-4" title="4"><span class="kw">all.equal</span>(<span class="kw">rownames</span>(insects), <span class="kw">rownames</span>(metadata))</a></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb445"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb445-1" title="1"><span class="co">#grab and wrangle weather stn data</span></a>
<a class="sourceLine" id="cb445-2" title="2">weather &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;Clean Data/pantraps_weather.csv&quot;</span>)</a>
<a class="sourceLine" id="cb445-3" title="3"><span class="kw">str</span>(weather)</a></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    152 obs. of  12 variables:
##  $ date            : Factor w/ 19 levels &quot;4.10.2017&quot;,&quot;4.11.2017&quot;,..: 1 2 3 4 5 6 7 8 9 10 ...
##  $ Hour            : Factor w/ 8 levels &quot;1:00 PM&quot;,&quot;10:00 AM&quot;,..: 2 2 2 2 2 2 2 2 2 2 ...
##  $ Solar           : num  0.81 0.79 0.8 0.81 0.81 0.8 0.63 0.82 0.84 0.76 ...
##  $ Wind            : num  3.9 4.1 5.1 4.9 4.5 3.2 3.3 4.3 4.6 4.7 ...
##  $ Max             : num  9 10.7 9.7 8.6 7.8 7.6 7.2 8.2 8.2 8.2 ...
##  $ Air.Temperature : num  15 15.6 16.9 18.5 19.8 21 21.1 20.7 20.2 18.8 ...
##  $ Soil.Temperature: num  18.9 18.8 18.7 18.8 19 19.3 19.8 20.4 21 21.5 ...
##  $ Humidity        : int  43 42 38 32 29 27 26 26 26 25 ...
##  $ Dew             : num  2.4 2.6 2.4 1.7 1.4 1.1 1.1 0.8 -0.1 -1.6 ...
##  $ Wet             : num  8.2 8.6 9.1 9.5 9.9 10.3 10.3 10 9.5 8.5 ...
##  $ Baro.           : int  873 873 873 873 872 872 872 872 871 871 ...
##  $ Total           : int  0 0 0 0 0 0 0 0 0 0 ...</code></pre>
<div class="sourceCode" id="cb447"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb447-1" title="1">weather.av &lt;-<span class="st"> </span>weather <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(., date) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarise</span>(., <span class="dt">mean.Solar =</span> <span class="kw">mean</span>(Solar), <span class="dt">mean.Wind =</span> <span class="kw">mean</span>(Wind), <span class="dt">mean.MaxWind =</span> <span class="kw">mean</span>(Max), <span class="dt">mean.Temp =</span> <span class="kw">mean</span>(Air.Temperature))</a>
<a class="sourceLine" id="cb447-2" title="2">metadata &lt;-<span class="st"> </span><span class="kw">right_join</span>(weather.av, metadata, <span class="dt">by =</span> <span class="st">&quot;date&quot;</span>)</a></code></pre></div>
<pre><code>## Warning: Column `date` joining factors with different levels, coercing to
## character vector</code></pre>
<div class="sourceCode" id="cb449"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb449-1" title="1">metadata<span class="op">$</span>abun &lt;-<span class="st"> </span><span class="kw">apply</span>(insects, <span class="dv">1</span>, sum)</a>
<a class="sourceLine" id="cb449-2" title="2"><span class="co">#check for total</span></a>
<a class="sourceLine" id="cb449-3" title="3"><span class="kw">sum</span>(metadata<span class="op">$</span>abun)</a></code></pre></div>
<pre><code>## [1] 3387</code></pre>
<div class="sourceCode" id="cb451"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb451-1" title="1">H &lt;-<span class="st"> </span><span class="kw">diversity</span>(insects)</a>
<a class="sourceLine" id="cb451-2" title="2">simp &lt;-<span class="st"> </span><span class="kw">diversity</span>(insects, <span class="st">&quot;simpson&quot;</span>)</a>
<a class="sourceLine" id="cb451-3" title="3">S &lt;-<span class="st"> </span><span class="kw">specnumber</span>(insects)</a>
<a class="sourceLine" id="cb451-4" title="4">J &lt;-<span class="st"> </span>H<span class="op">/</span><span class="kw">log</span>(S)</a>
<a class="sourceLine" id="cb451-5" title="5">metadata<span class="op">$</span>H &lt;-<span class="st"> </span>H</a>
<a class="sourceLine" id="cb451-6" title="6">metadata<span class="op">$</span>Simpson &lt;-<span class="st"> </span>simp</a>
<a class="sourceLine" id="cb451-7" title="7">metadata<span class="op">$</span>Species &lt;-<span class="st"> </span>S</a>
<a class="sourceLine" id="cb451-8" title="8">metadata<span class="op">$</span>Even &lt;-<span class="st"> </span>J</a>
<a class="sourceLine" id="cb451-9" title="9"></a>
<a class="sourceLine" id="cb451-10" title="10"><span class="kw">summary</span>(metadata)</a></code></pre></div>
<pre><code>##      date             mean.Solar       mean.Wind      mean.MaxWind   
##  Length:228         Min.   :0.5737   Min.   :3.525   Min.   : 9.238  
##  Class :character   1st Qu.:0.6663   1st Qu.:4.787   1st Qu.: 9.625  
##  Mode  :character   Median :0.7688   Median :5.175   Median :10.050  
##                     Mean   :0.7419   Mean   :5.241   Mean   :10.184  
##                     3rd Qu.:0.7987   3rd Qu.:6.025   3rd Qu.:10.512  
##                     Max.   :0.8125   Max.   :6.662   Max.   :11.537  
##                                                                      
##    mean.Temp       plant.id             species    treatment   blooming  
##  Min.   :17.16   Length:228         buckhorn:  0   open :114   post:120  
##  1st Qu.:17.40   Class :character   larrea  :228   shrub:114   pre :108  
##  Median :17.86   Mode  :character                                        
##  Mean   :18.46                                                           
##  3rd Qu.:18.56                                                           
##  Max.   :28.51                                                           
##                                                                          
##  percent.cover   perennial                            X      
##  Min.   : 1.00       :223                              :227  
##  1st Qu.: 2.00   1   :  4   blue and white knocked over:  1  
##  Median :10.00   2   :  1   east                       :  0  
##  Mean   :18.82   3   :  0   east side                  :  0  
##  3rd Qu.:30.00   east:  0   north                      :  0  
##  Max.   :80.00              yellow knocked over        :  0  
##                                                              
##     uniID                abun             H            Simpson      
##  Length:228         Min.   : 0.00   Min.   :0.000   Min.   :0.0000  
##  Class :character   1st Qu.:10.00   1st Qu.:1.233   1st Qu.:0.6239  
##  Mode  :character   Median :14.00   Median :1.699   Median :0.7769  
##                     Mean   :14.86   Mean   :1.570   Mean   :0.7034  
##                     3rd Qu.:19.00   3rd Qu.:1.991   3rd Qu.:0.8344  
##                     Max.   :55.00   Max.   :2.552   Max.   :1.0000  
##                                                                     
##     Species           Even       
##  Min.   : 0.00   Min.   :0.0000  
##  1st Qu.: 5.00   1st Qu.:0.7950  
##  Median : 7.00   Median :0.8842  
##  Mean   : 7.11   Mean   :0.8413  
##  3rd Qu.: 9.00   3rd Qu.:0.9464  
##  Max.   :16.00   Max.   :1.0000  
##                  NA&#39;s   :6</code></pre>
<div class="sourceCode" id="cb453"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb453-1" title="1"><span class="co">#beetle output</span></a>
<a class="sourceLine" id="cb453-2" title="2"><span class="kw">write.csv</span>(metadata, <span class="st">&quot;Output Data/metadata_yesbeetle.csv&quot;</span>)</a>
<a class="sourceLine" id="cb453-3" title="3"><span class="kw">write.csv</span>(insects, <span class="st">&quot;Output Data/wide_yesbeetle.csv&quot;</span>)</a></code></pre></div>
<p>Calculations for only Melyrid beetles</p>
<div class="sourceCode" id="cb454"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb454-1" title="1"><span class="co">##beetles only</span></a>
<a class="sourceLine" id="cb454-2" title="2">insects &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;Output Data/pantraps_wide.csv&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb454-3" title="3"><span class="kw">row.names</span>(insects) &lt;-<span class="st"> </span>insects<span class="op">$</span>uniID</a>
<a class="sourceLine" id="cb454-4" title="4">insects &lt;-<span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(insects, <span class="op">-</span>X, <span class="op">-</span>uniID)</a>
<a class="sourceLine" id="cb454-5" title="5"><span class="co">#filter out beetles</span></a>
<a class="sourceLine" id="cb454-6" title="6">insects &lt;-<span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(insects, Melyridae)</a>
<a class="sourceLine" id="cb454-7" title="7">metadata &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;Clean Data/pantraps_cov.csv&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb454-8" title="8">metadata &lt;-<span class="st"> </span><span class="kw">filter</span>(metadata, species <span class="op">!=</span><span class="st"> &quot;buckhorn&quot;</span>)</a>
<a class="sourceLine" id="cb454-9" title="9">metadata<span class="op">$</span>plant.id &lt;-<span class="st"> </span><span class="kw">as.character</span>(metadata<span class="op">$</span>plant.id)</a>
<a class="sourceLine" id="cb454-10" title="10"><span class="kw">str</span>(metadata)</a></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    228 obs. of  8 variables:
##  $ plant.id     : chr  &quot;296&quot; &quot;296&quot; &quot;189&quot; &quot;189&quot; ...
##  $ species      : Factor w/ 2 levels &quot;buckhorn&quot;,&quot;larrea&quot;: 2 2 2 2 2 2 2 2 2 2 ...
##  $ treatment    : Factor w/ 2 levels &quot;open&quot;,&quot;shrub&quot;: 2 1 2 1 2 1 2 1 2 1 ...
##  $ blooming     : Factor w/ 2 levels &quot;post&quot;,&quot;pre&quot;: 2 2 2 2 2 2 2 2 2 2 ...
##  $ date         : Factor w/ 21 levels &quot;4.10.2017&quot;,&quot;4.11.2017&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
##  $ percent.cover: int  15 3 25 2 40 15 40 3 70 10 ...
##  $ perennial    : Factor w/ 5 levels &quot;&quot;,&quot;1&quot;,&quot;2&quot;,&quot;3&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
##  $ X            : Factor w/ 6 levels &quot;&quot;,&quot;blue and white knocked over&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...</code></pre>
<div class="sourceCode" id="cb456"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb456-1" title="1">metadata<span class="op">$</span>uniID &lt;-<span class="st"> </span><span class="kw">paste</span>(metadata<span class="op">$</span>date, metadata<span class="op">$</span>plant.id, metadata<span class="op">$</span>treatment)</a>
<a class="sourceLine" id="cb456-2" title="2"><span class="kw">row.names</span>(metadata) &lt;-<span class="st"> </span>metadata<span class="op">$</span>uniID</a>
<a class="sourceLine" id="cb456-3" title="3"></a>
<a class="sourceLine" id="cb456-4" title="4"><span class="co">#check if insects and metadata are the same</span></a>
<a class="sourceLine" id="cb456-5" title="5"><span class="kw">all.equal</span>(<span class="kw">rownames</span>(insects), <span class="kw">rownames</span>(metadata))</a></code></pre></div>
<pre><code>## [1] &quot;214 string mismatches&quot;</code></pre>
<div class="sourceCode" id="cb458"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb458-1" title="1"><span class="co">#sort into the same order</span></a>
<a class="sourceLine" id="cb458-2" title="2">metadata &lt;-<span class="st"> </span>metadata[<span class="kw">rownames</span>(insects), ]</a>
<a class="sourceLine" id="cb458-3" title="3"><span class="co">#confirm - woo!</span></a>
<a class="sourceLine" id="cb458-4" title="4"><span class="kw">all.equal</span>(<span class="kw">rownames</span>(insects), <span class="kw">rownames</span>(metadata))</a></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb460"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb460-1" title="1"><span class="co">#grab and wrangle weather stn data</span></a>
<a class="sourceLine" id="cb460-2" title="2">weather &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;Clean Data/pantraps_weather.csv&quot;</span>)</a>
<a class="sourceLine" id="cb460-3" title="3"><span class="kw">str</span>(weather)</a></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    152 obs. of  12 variables:
##  $ date            : Factor w/ 19 levels &quot;4.10.2017&quot;,&quot;4.11.2017&quot;,..: 1 2 3 4 5 6 7 8 9 10 ...
##  $ Hour            : Factor w/ 8 levels &quot;1:00 PM&quot;,&quot;10:00 AM&quot;,..: 2 2 2 2 2 2 2 2 2 2 ...
##  $ Solar           : num  0.81 0.79 0.8 0.81 0.81 0.8 0.63 0.82 0.84 0.76 ...
##  $ Wind            : num  3.9 4.1 5.1 4.9 4.5 3.2 3.3 4.3 4.6 4.7 ...
##  $ Max             : num  9 10.7 9.7 8.6 7.8 7.6 7.2 8.2 8.2 8.2 ...
##  $ Air.Temperature : num  15 15.6 16.9 18.5 19.8 21 21.1 20.7 20.2 18.8 ...
##  $ Soil.Temperature: num  18.9 18.8 18.7 18.8 19 19.3 19.8 20.4 21 21.5 ...
##  $ Humidity        : int  43 42 38 32 29 27 26 26 26 25 ...
##  $ Dew             : num  2.4 2.6 2.4 1.7 1.4 1.1 1.1 0.8 -0.1 -1.6 ...
##  $ Wet             : num  8.2 8.6 9.1 9.5 9.9 10.3 10.3 10 9.5 8.5 ...
##  $ Baro.           : int  873 873 873 873 872 872 872 872 871 871 ...
##  $ Total           : int  0 0 0 0 0 0 0 0 0 0 ...</code></pre>
<div class="sourceCode" id="cb462"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb462-1" title="1">weather.av &lt;-<span class="st"> </span>weather <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(., date) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarise</span>(., <span class="dt">mean.Solar =</span> <span class="kw">mean</span>(Solar), <span class="dt">mean.Wind =</span> <span class="kw">mean</span>(Wind), <span class="dt">mean.MaxWind =</span> <span class="kw">mean</span>(Max), <span class="dt">mean.Temp =</span> <span class="kw">mean</span>(Air.Temperature))</a>
<a class="sourceLine" id="cb462-2" title="2">metadata &lt;-<span class="st"> </span><span class="kw">right_join</span>(weather.av, metadata, <span class="dt">by =</span> <span class="st">&quot;date&quot;</span>)</a></code></pre></div>
<pre><code>## Warning: Column `date` joining factors with different levels, coercing to
## character vector</code></pre>
<div class="sourceCode" id="cb464"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb464-1" title="1">metadata<span class="op">$</span>abun &lt;-<span class="st"> </span><span class="kw">apply</span>(insects, <span class="dv">1</span>, sum)</a>
<a class="sourceLine" id="cb464-2" title="2"><span class="co">#check for total</span></a>
<a class="sourceLine" id="cb464-3" title="3"><span class="kw">sum</span>(metadata<span class="op">$</span>abun)</a></code></pre></div>
<pre><code>## [1] 1243</code></pre>
<div class="sourceCode" id="cb466"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb466-1" title="1">H &lt;-<span class="st"> </span><span class="kw">diversity</span>(insects)</a>
<a class="sourceLine" id="cb466-2" title="2">simp &lt;-<span class="st"> </span><span class="kw">diversity</span>(insects, <span class="st">&quot;simpson&quot;</span>)</a>
<a class="sourceLine" id="cb466-3" title="3">S &lt;-<span class="st"> </span><span class="kw">specnumber</span>(insects)</a>
<a class="sourceLine" id="cb466-4" title="4">J &lt;-<span class="st"> </span>H<span class="op">/</span><span class="kw">log</span>(S)</a>
<a class="sourceLine" id="cb466-5" title="5">metadata<span class="op">$</span>H &lt;-<span class="st"> </span>H</a>
<a class="sourceLine" id="cb466-6" title="6">metadata<span class="op">$</span>Simpson &lt;-<span class="st"> </span>simp</a>
<a class="sourceLine" id="cb466-7" title="7">metadata<span class="op">$</span>Species &lt;-<span class="st"> </span>S</a>
<a class="sourceLine" id="cb466-8" title="8">metadata<span class="op">$</span>Even &lt;-<span class="st"> </span>J</a>
<a class="sourceLine" id="cb466-9" title="9"></a>
<a class="sourceLine" id="cb466-10" title="10"></a>
<a class="sourceLine" id="cb466-11" title="11"><span class="kw">summary</span>(metadata)</a></code></pre></div>
<pre><code>##      date             mean.Solar       mean.Wind      mean.MaxWind   
##  Length:228         Min.   :0.5737   Min.   :3.525   Min.   : 9.238  
##  Class :character   1st Qu.:0.6663   1st Qu.:4.787   1st Qu.: 9.625  
##  Mode  :character   Median :0.7688   Median :5.175   Median :10.050  
##                     Mean   :0.7419   Mean   :5.241   Mean   :10.184  
##                     3rd Qu.:0.7987   3rd Qu.:6.025   3rd Qu.:10.512  
##                     Max.   :0.8125   Max.   :6.662   Max.   :11.537  
##    mean.Temp       plant.id             species    treatment   blooming  
##  Min.   :17.16   Length:228         buckhorn:  0   open :114   post:120  
##  1st Qu.:17.40   Class :character   larrea  :228   shrub:114   pre :108  
##  Median :17.86   Mode  :character                                        
##  Mean   :18.46                                                           
##  3rd Qu.:18.56                                                           
##  Max.   :28.51                                                           
##  percent.cover   perennial                            X      
##  Min.   : 1.00       :223                              :227  
##  1st Qu.: 2.00   1   :  4   blue and white knocked over:  1  
##  Median :10.00   2   :  1   east                       :  0  
##  Mean   :18.82   3   :  0   east side                  :  0  
##  3rd Qu.:30.00   east:  0   north                      :  0  
##  Max.   :80.00              yellow knocked over        :  0  
##     uniID                abun              H            Simpson      
##  Length:228         Min.   : 0.000   Min.   :4.908   Min.   :0.9899  
##  Class :character   1st Qu.: 1.750   1st Qu.:4.908   1st Qu.:0.9899  
##  Mode  :character   Median : 4.000   Median :4.908   Median :0.9899  
##                     Mean   : 5.452   Mean   :4.908   Mean   :0.9899  
##                     3rd Qu.: 7.000   3rd Qu.:4.908   3rd Qu.:0.9899  
##                     Max.   :46.000   Max.   :4.908   Max.   :0.9899  
##     Species            Even    
##  Min.   :0.0000   Min.   :  0  
##  1st Qu.:1.0000   1st Qu.:Inf  
##  Median :1.0000   Median :Inf  
##  Mean   :0.8553   Mean   :Inf  
##  3rd Qu.:1.0000   3rd Qu.:Inf  
##  Max.   :1.0000   Max.   :Inf</code></pre>
<div class="sourceCode" id="cb468"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb468-1" title="1"><span class="co">#no beetle output</span></a>
<a class="sourceLine" id="cb468-2" title="2"><span class="kw">write.csv</span>(metadata, <span class="st">&quot;Output Data/metadata_onlybeetle.csv&quot;</span>)</a>
<a class="sourceLine" id="cb468-3" title="3"><span class="kw">write.csv</span>(insects, <span class="st">&quot;Output Data/wide_onlybeetle.csv&quot;</span>)</a></code></pre></div>
<p>Arthropod abundance - Melyridae beetles excluded</p>
<div class="sourceCode" id="cb469"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb469-1" title="1">metadata &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;Output Data/metadata_nobeetle.csv&quot;</span>)</a>
<a class="sourceLine" id="cb469-2" title="2">metadata<span class="op">$</span>repID &lt;-<span class="st"> </span><span class="kw">paste</span>(metadata<span class="op">$</span>plant.id, metadata<span class="op">$</span>treatment)</a>
<a class="sourceLine" id="cb469-3" title="3">metadata<span class="op">$</span>blooming &lt;-<span class="st"> </span><span class="kw">relevel</span>(metadata<span class="op">$</span>blooming, <span class="st">&quot;pre&quot;</span>)</a>
<a class="sourceLine" id="cb469-4" title="4"><span class="kw">sum</span>(metadata<span class="op">$</span>abun)</a></code></pre></div>
<pre><code>## [1] 2144</code></pre>
<div class="sourceCode" id="cb471"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb471-1" title="1"><span class="kw">str</span>(metadata)</a></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    228 obs. of  20 variables:
##  $ X.1          : int  1 2 3 4 5 6 7 8 9 10 ...
##  $ date         : Factor w/ 19 levels &quot;4.10.2017&quot;,&quot;4.11.2017&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
##  $ mean.Solar   : num  0.762 0.762 0.762 0.762 0.762 ...
##  $ mean.Wind    : num  5.15 5.15 5.15 5.15 5.15 5.15 5.15 5.15 5.15 5.15 ...
##  $ mean.MaxWind : num  9.78 9.78 9.78 9.78 9.78 ...
##  $ mean.Temp    : num  18.4 18.4 18.4 18.4 18.4 ...
##  $ plant.id     : int  184 184 189 189 192 192 194 194 275 275 ...
##  $ species      : Factor w/ 1 level &quot;larrea&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ treatment    : Factor w/ 2 levels &quot;open&quot;,&quot;shrub&quot;: 1 2 1 2 1 2 1 2 1 2 ...
##  $ blooming     : Factor w/ 2 levels &quot;pre&quot;,&quot;post&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ percent.cover: int  10 70 2 25 15 40 3 40 2 20 ...
##  $ perennial    : int  NA NA NA NA NA NA NA NA NA NA ...
##  $ X            : Factor w/ 2 levels &quot;&quot;,&quot;blue and white knocked over&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ uniID        : Factor w/ 228 levels &quot;4.10.2017 184 open&quot;,..: 1 2 3 4 5 6 7 8 9 10 ...
##  $ abun         : int  12 14 18 16 21 30 13 11 0 27 ...
##  $ H            : num  1.31 1.22 2.43 1.75 1.72 ...
##  $ Simpson      : num  0.667 0.612 0.895 0.773 0.789 ...
##  $ Species      : int  5 5 13 8 7 12 6 6 0 10 ...
##  $ Even         : num  0.817 0.755 0.947 0.844 0.886 ...
##  $ repID        : chr  &quot;184 open&quot; &quot;184 shrub&quot; &quot;189 open&quot; &quot;189 shrub&quot; ...</code></pre>
<div class="sourceCode" id="cb473"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb473-1" title="1"><span class="kw">ggplot</span>(<span class="dt">data =</span> metadata, <span class="kw">aes</span>(abun)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_freqpoly</span>()</a></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="index_files/figure-html/arthropod%20abundance%20m%20excluded-1.png" width="672" /></p>
<div class="sourceCode" id="cb475"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb475-1" title="1"><span class="kw">mean</span>(metadata<span class="op">$</span>abun)</a></code></pre></div>
<pre><code>## [1] 9.403509</code></pre>
<div class="sourceCode" id="cb477"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb477-1" title="1"><span class="kw">sd</span>(metadata<span class="op">$</span>abun)</a></code></pre></div>
<pre><code>## [1] 5.939073</code></pre>
<div class="sourceCode" id="cb479"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb479-1" title="1"><span class="kw">shapiro.test</span>(metadata<span class="op">$</span>abun)</a></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  metadata$abun
## W = 0.9356, p-value = 1.843e-08</code></pre>
<div class="sourceCode" id="cb481"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb481-1" title="1"><span class="kw">ggplot</span>(<span class="dt">data =</span> metadata, <span class="kw">aes</span>(treatment, abun)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_boxplot</span>() <span class="op">+</span><span class="st"> </span><span class="kw">facet_grid</span>(<span class="op">~</span>blooming)</a></code></pre></div>
<p><img src="index_files/figure-html/arthropod%20abundance%20m%20excluded-2.png" width="672" /></p>
<div class="sourceCode" id="cb482"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb482-1" title="1">m1 &lt;-<span class="st"> </span><span class="kw">glmmTMB</span>(abun <span class="op">~</span><span class="st"> </span>treatment <span class="op">*</span><span class="st"> </span>blooming <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>repID), <span class="dt">family =</span> <span class="st">&quot;nbinom2&quot;</span>, <span class="dt">data =</span> metadata)</a>
<a class="sourceLine" id="cb482-2" title="2"><span class="kw">summary</span>(m1)</a></code></pre></div>
<pre><code>##  Family: nbinom2  ( log )
## Formula:          abun ~ treatment * blooming + (1 | repID)
## Data: metadata
## 
##      AIC      BIC   logLik deviance df.resid 
##   1370.7   1391.3   -679.4   1358.7      222 
## 
## Random effects:
## 
## Conditional model:
##  Groups Name        Variance  Std.Dev. 
##  repID  (Intercept) 3.076e-09 5.546e-05
## Number of obs: 228, groups:  repID, 126
## 
## Overdispersion parameter for nbinom2 family (): 4.97 
## 
## Conditional model:
##                             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)                  2.27060    0.07511  30.230  &lt; 2e-16 ***
## treatmentshrub               0.40610    0.10317   3.936 8.28e-05 ***
## bloomingpost                -0.39623    0.10750  -3.686 0.000228 ***
## treatmentshrub:bloomingpost -0.27674    0.14887  -1.859 0.063043 .  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb484"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb484-1" title="1"><span class="co">#lsmeans(m1, pairwise~blooming*treatment)</span></a>
<a class="sourceLine" id="cb484-2" title="2">car<span class="op">::</span><span class="kw">Anova</span>(m1, <span class="dt">type =</span> <span class="dv">3</span>)</a></code></pre></div>
<pre><code>## Analysis of Deviance Table (Type III Wald chisquare tests)
## 
## Response: abun
##                       Chisq Df Pr(&gt;Chisq)    
## (Intercept)        913.8679  1  &lt; 2.2e-16 ***
## treatment           15.4928  1  8.282e-05 ***
## blooming            13.5866  1  0.0002278 ***
## treatment:blooming   3.4555  1  0.0630428 .  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb486"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb486-1" title="1">m2 &lt;-<span class="st"> </span><span class="kw">glmmTMB</span>(abun <span class="op">~</span><span class="st"> </span>treatment <span class="op">+</span><span class="st"> </span>blooming <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>repID), <span class="dt">family =</span> <span class="st">&quot;nbinom2&quot;</span>, <span class="dt">data =</span> metadata)</a>
<a class="sourceLine" id="cb486-2" title="2"><span class="kw">summary</span>(m2)</a></code></pre></div>
<pre><code>##  Family: nbinom2  ( log )
## Formula:          abun ~ treatment + blooming + (1 | repID)
## Data: metadata
## 
##      AIC      BIC   logLik deviance df.resid 
##   1372.2   1389.3   -681.1   1362.2      223 
## 
## Random effects:
## 
## Conditional model:
##  Groups Name        Variance  Std.Dev. 
##  repID  (Intercept) 2.635e-09 5.133e-05
## Number of obs: 228, groups:  repID, 126
## 
## Overdispersion parameter for nbinom2 family (): 4.83 
## 
## Conditional model:
##                Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)     2.34192    0.06597   35.50  &lt; 2e-16 ***
## treatmentshrub  0.27310    0.07508    3.64 0.000275 ***
## bloomingpost   -0.54087    0.07504   -7.21 5.68e-13 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb488"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb488-1" title="1">m3 &lt;-<span class="st"> </span><span class="kw">glmmTMB</span>(abun <span class="op">~</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>repID), <span class="dt">family =</span> <span class="st">&quot;nbinom2&quot;</span>, <span class="dt">data =</span> metadata)</a>
<a class="sourceLine" id="cb488-2" title="2"></a>
<a class="sourceLine" id="cb488-3" title="3">m4.nb1 &lt;-<span class="st"> </span><span class="kw">glmmTMB</span>(abun <span class="op">~</span><span class="st"> </span>treatment <span class="op">+</span><span class="st"> </span>blooming <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>repID), <span class="dt">family =</span> <span class="st">&quot;nbinom1&quot;</span>, <span class="dt">data =</span> metadata)</a>
<a class="sourceLine" id="cb488-4" title="4"></a>
<a class="sourceLine" id="cb488-5" title="5">m4.nb1.int &lt;-<span class="st"> </span><span class="kw">glmmTMB</span>(abun <span class="op">~</span><span class="st"> </span>treatment <span class="op">*</span><span class="st"> </span>blooming <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>repID), <span class="dt">family =</span> <span class="st">&quot;nbinom1&quot;</span>, <span class="dt">data =</span> metadata)</a>
<a class="sourceLine" id="cb488-6" title="6"></a>
<a class="sourceLine" id="cb488-7" title="7"><span class="kw">anova</span>(m1, m2, m3, m4.nb1, m4.nb1.int, <span class="dt">test =</span> <span class="st">&quot;Chisq&quot;</span>)</a></code></pre></div>
<pre><code>## Data: metadata
## Models:
## m3: abun ~ (1 | repID), zi=~0, disp=~1
## m2: abun ~ treatment + blooming + (1 | repID), zi=~0, disp=~1
## m4.nb1: abun ~ treatment + blooming + (1 | repID), zi=~0, disp=~1
## m1: abun ~ treatment * blooming + (1 | repID), zi=~0, disp=~1
## m4.nb1.int: abun ~ treatment * blooming + (1 | repID), zi=~0, disp=~1
##            Df    AIC    BIC  logLik deviance   Chisq Chi Df Pr(&gt;Chisq)    
## m3          3 1426.5 1436.8 -710.27   1420.5                              
## m2          5 1372.2 1389.3 -681.08   1362.2 58.3768      2  2.107e-13 ***
## m4.nb1      5 1370.3 1387.5 -680.15   1360.3  1.8557      0  &lt; 2.2e-16 ***
## m1          6 1370.7 1391.3 -679.37   1358.7  1.5697      1     0.2103    
## m4.nb1.int  6 1368.7 1389.2 -678.33   1356.7  2.0728      0  &lt; 2.2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb490"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb490-1" title="1"><span class="kw">AIC</span>(m1, m2, m3, m4.nb1, m4.nb1.int)</a></code></pre></div>
<pre><code>##            df      AIC
## m1          6 1370.733
## m2          5 1372.159
## m3          3 1426.535
## m4.nb1      5 1370.303
## m4.nb1.int  6 1368.660</code></pre>
<div class="sourceCode" id="cb492"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb492-1" title="1"><span class="co">#looks like nbinom1 (negative binomial type one, additive model)</span></a>
<a class="sourceLine" id="cb492-2" title="2"></a>
<a class="sourceLine" id="cb492-3" title="3"><span class="kw">anova</span>(m4.nb1, m4.nb1.int)</a></code></pre></div>
<pre><code>## Data: metadata
## Models:
## m4.nb1: abun ~ treatment + blooming + (1 | repID), zi=~0, disp=~1
## m4.nb1.int: abun ~ treatment * blooming + (1 | repID), zi=~0, disp=~1
##            Df    AIC    BIC  logLik deviance  Chisq Chi Df Pr(&gt;Chisq)  
## m4.nb1      5 1370.3 1387.5 -680.15   1360.3                           
## m4.nb1.int  6 1368.7 1389.2 -678.33   1356.7 3.6425      1    0.05632 .
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb494"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb494-1" title="1"><span class="co">#additive and interactive models are not different - using simpler model</span></a>
<a class="sourceLine" id="cb494-2" title="2"></a>
<a class="sourceLine" id="cb494-3" title="3"><span class="kw">summary</span>(m4.nb1)</a></code></pre></div>
<pre><code>##  Family: nbinom1  ( log )
## Formula:          abun ~ treatment + blooming + (1 | repID)
## Data: metadata
## 
##      AIC      BIC   logLik deviance df.resid 
##   1370.3   1387.4   -680.2   1360.3      223 
## 
## Random effects:
## 
## Conditional model:
##  Groups Name        Variance Std.Dev.
##  repID  (Intercept) 0.01365  0.1168  
## Number of obs: 228, groups:  repID, 126
## 
## Overdispersion parameter for nbinom1 family (): 1.81 
## 
## Conditional model:
##                Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)     2.33246    0.06313   36.95  &lt; 2e-16 ***
## treatmentshrub  0.28835    0.07460    3.87 0.000111 ***
## bloomingpost   -0.54964    0.07340   -7.49 6.95e-14 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb496"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb496-1" title="1">car<span class="op">::</span><span class="kw">Anova</span>(m4.nb1, <span class="dt">type =</span> <span class="dv">2</span>)</a></code></pre></div>
<pre><code>## Analysis of Deviance Table (Type II Wald chisquare tests)
## 
## Response: abun
##            Chisq Df Pr(&gt;Chisq)    
## treatment 14.940  1   0.000111 ***
## blooming  56.082  1   6.95e-14 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<hr />
<p>Including Melyridae beetles</p>
<div class="sourceCode" id="cb498"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb498-1" title="1">beetle &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;Output Data/metadata_yesbeetle.csv&quot;</span>)</a>
<a class="sourceLine" id="cb498-2" title="2">beetle<span class="op">$</span>repID &lt;-<span class="st"> </span><span class="kw">paste</span>(beetle<span class="op">$</span>plant.id, beetle<span class="op">$</span>treatment)</a>
<a class="sourceLine" id="cb498-3" title="3">beetle<span class="op">$</span>blooming &lt;-<span class="st"> </span><span class="kw">relevel</span>(beetle<span class="op">$</span>blooming, <span class="st">&quot;pre&quot;</span>)</a>
<a class="sourceLine" id="cb498-4" title="4"><span class="kw">sum</span>(beetle<span class="op">$</span>abun)</a></code></pre></div>
<pre><code>## [1] 3387</code></pre>
<div class="sourceCode" id="cb500"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb500-1" title="1"><span class="kw">str</span>(beetle)</a></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    228 obs. of  20 variables:
##  $ X.1          : int  1 2 3 4 5 6 7 8 9 10 ...
##  $ date         : Factor w/ 19 levels &quot;4.10.2017&quot;,&quot;4.11.2017&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
##  $ mean.Solar   : num  0.762 0.762 0.762 0.762 0.762 ...
##  $ mean.Wind    : num  5.15 5.15 5.15 5.15 5.15 5.15 5.15 5.15 5.15 5.15 ...
##  $ mean.MaxWind : num  9.78 9.78 9.78 9.78 9.78 ...
##  $ mean.Temp    : num  18.4 18.4 18.4 18.4 18.4 ...
##  $ plant.id     : int  184 184 189 189 192 192 194 194 275 275 ...
##  $ species      : Factor w/ 1 level &quot;larrea&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ treatment    : Factor w/ 2 levels &quot;open&quot;,&quot;shrub&quot;: 1 2 1 2 1 2 1 2 1 2 ...
##  $ blooming     : Factor w/ 2 levels &quot;pre&quot;,&quot;post&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ percent.cover: int  10 70 2 25 15 40 3 40 2 20 ...
##  $ perennial    : int  NA NA NA NA NA NA NA NA NA NA ...
##  $ X            : Factor w/ 2 levels &quot;&quot;,&quot;blue and white knocked over&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ uniID        : Factor w/ 228 levels &quot;4.10.2017 184 open&quot;,..: 1 2 3 4 5 6 7 8 9 10 ...
##  $ abun         : int  18 16 20 18 22 30 20 11 0 29 ...
##  $ H            : num  1.51 1.44 2.51 1.91 1.83 ...
##  $ Simpson      : num  0.741 0.688 0.905 0.809 0.806 ...
##  $ Species      : int  6 6 14 9 8 12 7 6 0 11 ...
##  $ Even         : num  0.844 0.804 0.951 0.868 0.88 ...
##  $ repID        : chr  &quot;184 open&quot; &quot;184 shrub&quot; &quot;189 open&quot; &quot;189 shrub&quot; ...</code></pre>
<div class="sourceCode" id="cb502"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb502-1" title="1"><span class="kw">sum</span>(beetle<span class="op">$</span>H)</a></code></pre></div>
<pre><code>## [1] 357.8503</code></pre>
<div class="sourceCode" id="cb504"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb504-1" title="1"><span class="kw">ggplot</span>(<span class="dt">data =</span> beetle, <span class="kw">aes</span>(abun)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_freqpoly</span>()</a></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="index_files/figure-html/melyride%20included-1.png" width="672" /></p>
<div class="sourceCode" id="cb506"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb506-1" title="1"><span class="kw">mean</span>(beetle<span class="op">$</span>abun)</a></code></pre></div>
<pre><code>## [1] 14.85526</code></pre>
<div class="sourceCode" id="cb508"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb508-1" title="1"><span class="kw">sd</span>(beetle<span class="op">$</span>abun)</a></code></pre></div>
<pre><code>## [1] 8.305357</code></pre>
<div class="sourceCode" id="cb510"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb510-1" title="1">m1 &lt;-<span class="st"> </span><span class="kw">glmmTMB</span>(abun <span class="op">~</span><span class="st"> </span>blooming <span class="op">+</span><span class="st"> </span>treatment <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>repID), <span class="dt">family =</span> <span class="st">&quot;nbinom2&quot;</span>, <span class="dt">data =</span> beetle)</a>
<a class="sourceLine" id="cb510-2" title="2"><span class="kw">summary</span>(m1)</a></code></pre></div>
<pre><code>##  Family: nbinom2  ( log )
## Formula:          abun ~ blooming + treatment + (1 | repID)
## Data: beetle
## 
##      AIC      BIC   logLik deviance df.resid 
##   1560.1   1577.2   -775.0   1550.1      223 
## 
## Random effects:
## 
## Conditional model:
##  Groups Name        Variance Std.Dev.
##  repID  (Intercept) 0.02625  0.162   
## Number of obs: 228, groups:  repID, 126
## 
## Overdispersion parameter for nbinom2 family (): 5.39 
## 
## Conditional model:
##                Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)     2.92260    0.06280   46.54  &lt; 2e-16 ***
## bloomingpost   -0.39360    0.06822   -5.77 7.95e-09 ***
## treatmentshrub -0.09887    0.07367   -1.34     0.18    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb512"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb512-1" title="1">m2 &lt;-<span class="st"> </span><span class="kw">glmmTMB</span>(abun <span class="op">~</span><span class="st"> </span>blooming <span class="op">*</span><span class="st"> </span>treatment <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>repID), <span class="dt">family =</span> <span class="st">&quot;nbinom2&quot;</span>, <span class="dt">data =</span> beetle)</a>
<a class="sourceLine" id="cb512-2" title="2"><span class="kw">summary</span>(m2)</a></code></pre></div>
<pre><code>##  Family: nbinom2  ( log )
## Formula:          abun ~ blooming * treatment + (1 | repID)
## Data: beetle
## 
##      AIC      BIC   logLik deviance df.resid 
##   1561.8   1582.4   -774.9   1549.8      222 
## 
## Random effects:
## 
## Conditional model:
##  Groups Name        Variance Std.Dev.
##  repID  (Intercept) 0.02622  0.1619  
## Number of obs: 228, groups:  repID, 126
## 
## Overdispersion parameter for nbinom2 family ():  5.4 
## 
## Conditional model:
##                             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)                  2.90434    0.07104   40.88  &lt; 2e-16 ***
## bloomingpost                -0.35767    0.09558   -3.74 0.000183 ***
## treatmentshrub              -0.06233    0.10016   -0.62 0.533761    
## bloomingpost:treatmentshrub -0.07273    0.13537   -0.54 0.591111    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb514"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb514-1" title="1">m3 &lt;-<span class="st"> </span><span class="kw">glmmTMB</span>(abun <span class="op">~</span><span class="st">  </span>(<span class="dv">1</span><span class="op">|</span>repID),<span class="dt">family =</span> <span class="st">&quot;nbinom2&quot;</span>,  <span class="dt">data =</span> beetle)</a>
<a class="sourceLine" id="cb514-2" title="2"><span class="kw">summary</span>(m3)</a></code></pre></div>
<pre><code>##  Family: nbinom2  ( log )
## Formula:          abun ~ (1 | repID)
## Data: beetle
## 
##      AIC      BIC   logLik deviance df.resid 
##   1586.9   1597.2   -790.5   1580.9      225 
## 
## Random effects:
## 
## Conditional model:
##  Groups Name        Variance  Std.Dev. 
##  repID  (Intercept) 8.308e-09 9.115e-05
## Number of obs: 228, groups:  repID, 126
## 
## Overdispersion parameter for nbinom2 family (): 3.91 
## 
## Conditional model:
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)  2.69835    0.03764   71.69   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb516"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb516-1" title="1">m4 &lt;-<span class="st">  </span><span class="kw">glmmTMB</span>(abun <span class="op">~</span><span class="st"> </span>blooming <span class="op">+</span><span class="st"> </span>treatment <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>repID), <span class="dt">family =</span> <span class="st">&quot;nbinom1&quot;</span>, <span class="dt">data =</span> beetle)</a>
<a class="sourceLine" id="cb516-2" title="2"><span class="kw">summary</span>(m4)  </a></code></pre></div>
<pre><code>##  Family: nbinom1  ( log )
## Formula:          abun ~ blooming + treatment + (1 | repID)
## Data: beetle
## 
##      AIC      BIC   logLik deviance df.resid 
##   1556.6   1573.8   -773.3   1546.6      223 
## 
## Random effects:
## 
## Conditional model:
##  Groups Name        Variance Std.Dev.
##  repID  (Intercept) 0.04362  0.2088  
## Number of obs: 228, groups:  repID, 126
## 
## Overdispersion parameter for nbinom1 family (): 2.45 
## 
## Conditional model:
##                Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)     2.90596    0.05872   49.48  &lt; 2e-16 ***
## bloomingpost   -0.39826    0.06402   -6.22 4.93e-10 ***
## treatmentshrub -0.07724    0.07354   -1.05    0.294    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb518"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb518-1" title="1"><span class="kw">anova</span>(m1, m2, m3, m4)</a></code></pre></div>
<pre><code>## Data: beetle
## Models:
## m3: abun ~ (1 | repID), zi=~0, disp=~1
## m1: abun ~ blooming + treatment + (1 | repID), zi=~0, disp=~1
## m4: abun ~ blooming + treatment + (1 | repID), zi=~0, disp=~1
## m2: abun ~ blooming * treatment + (1 | repID), zi=~0, disp=~1
##    Df    AIC    BIC  logLik deviance   Chisq Chi Df Pr(&gt;Chisq)    
## m3  3 1586.9 1597.2 -790.46   1580.9                              
## m1  5 1560.1 1577.2 -775.04   1550.1 30.8357      2  2.014e-07 ***
## m4  5 1556.6 1573.8 -773.30   1546.6  3.4774      0  &lt; 2.2e-16 ***
## m2  6 1561.8 1582.4 -774.90   1549.8  0.0000      1          1    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb520"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb520-1" title="1"><span class="kw">AIC</span>(m1, m2, m3, m4)</a></code></pre></div>
<pre><code>##    df      AIC
## m1  5 1560.081
## m2  6 1561.792
## m3  3 1586.917
## m4  5 1556.603</code></pre>
<div class="sourceCode" id="cb522"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb522-1" title="1"><span class="co">#one and two are pretty much the same, going with simpler, #4 is best (nbinom1)</span></a>
<a class="sourceLine" id="cb522-2" title="2">car<span class="op">::</span><span class="kw">Anova</span>(m4, <span class="dt">type =</span> <span class="dv">2</span>)</a></code></pre></div>
<pre><code>## Analysis of Deviance Table (Type II Wald chisquare tests)
## 
## Response: abun
##             Chisq Df Pr(&gt;Chisq)    
## blooming  38.7043  1  4.931e-10 ***
## treatment  1.1031  1     0.2936    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<hr />
<p>Melyridae only</p>
<div class="sourceCode" id="cb524"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb524-1" title="1">onlybeetle &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;Output Data/metadata_onlybeetle.csv&quot;</span>)</a>
<a class="sourceLine" id="cb524-2" title="2">onlybeetle<span class="op">$</span>repID &lt;-<span class="st"> </span><span class="kw">paste</span>(onlybeetle<span class="op">$</span>plant.id, onlybeetle<span class="op">$</span>treatment)</a>
<a class="sourceLine" id="cb524-3" title="3">onlybeetle<span class="op">$</span>blooming &lt;-<span class="st"> </span><span class="kw">relevel</span>(onlybeetle<span class="op">$</span>blooming, <span class="st">&quot;pre&quot;</span>)</a>
<a class="sourceLine" id="cb524-4" title="4"><span class="kw">sum</span>(onlybeetle<span class="op">$</span>abun)</a></code></pre></div>
<pre><code>## [1] 1243</code></pre>
<div class="sourceCode" id="cb526"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb526-1" title="1"><span class="kw">str</span>(beetle)</a></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    228 obs. of  20 variables:
##  $ X.1          : int  1 2 3 4 5 6 7 8 9 10 ...
##  $ date         : Factor w/ 19 levels &quot;4.10.2017&quot;,&quot;4.11.2017&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
##  $ mean.Solar   : num  0.762 0.762 0.762 0.762 0.762 ...
##  $ mean.Wind    : num  5.15 5.15 5.15 5.15 5.15 5.15 5.15 5.15 5.15 5.15 ...
##  $ mean.MaxWind : num  9.78 9.78 9.78 9.78 9.78 ...
##  $ mean.Temp    : num  18.4 18.4 18.4 18.4 18.4 ...
##  $ plant.id     : int  184 184 189 189 192 192 194 194 275 275 ...
##  $ species      : Factor w/ 1 level &quot;larrea&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ treatment    : Factor w/ 2 levels &quot;open&quot;,&quot;shrub&quot;: 1 2 1 2 1 2 1 2 1 2 ...
##  $ blooming     : Factor w/ 2 levels &quot;pre&quot;,&quot;post&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ percent.cover: int  10 70 2 25 15 40 3 40 2 20 ...
##  $ perennial    : int  NA NA NA NA NA NA NA NA NA NA ...
##  $ X            : Factor w/ 2 levels &quot;&quot;,&quot;blue and white knocked over&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ uniID        : Factor w/ 228 levels &quot;4.10.2017 184 open&quot;,..: 1 2 3 4 5 6 7 8 9 10 ...
##  $ abun         : int  18 16 20 18 22 30 20 11 0 29 ...
##  $ H            : num  1.51 1.44 2.51 1.91 1.83 ...
##  $ Simpson      : num  0.741 0.688 0.905 0.809 0.806 ...
##  $ Species      : int  6 6 14 9 8 12 7 6 0 11 ...
##  $ Even         : num  0.844 0.804 0.951 0.868 0.88 ...
##  $ repID        : chr  &quot;184 open&quot; &quot;184 shrub&quot; &quot;189 open&quot; &quot;189 shrub&quot; ...</code></pre>
<div class="sourceCode" id="cb528"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb528-1" title="1"><span class="kw">ggplot</span>(<span class="dt">data =</span> onlybeetle, <span class="kw">aes</span>(abun)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_freqpoly</span>()</a></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="index_files/figure-html/melyridae%20abundance%20only-1.png" width="672" /></p>
<div class="sourceCode" id="cb530"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb530-1" title="1"><span class="kw">mean</span>(onlybeetle<span class="op">$</span>abun)</a></code></pre></div>
<pre><code>## [1] 5.451754</code></pre>
<div class="sourceCode" id="cb532"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb532-1" title="1"><span class="kw">sd</span>(onlybeetle<span class="op">$</span>abun)</a></code></pre></div>
<pre><code>## [1] 6.256088</code></pre>
<div class="sourceCode" id="cb534"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb534-1" title="1">m1 &lt;-<span class="st"> </span><span class="kw">glmmTMB</span>(abun <span class="op">~</span><span class="st"> </span>blooming <span class="op">*</span><span class="st"> </span>treatment <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>repID), <span class="dt">family =</span> <span class="st">&quot;nbinom2&quot;</span>, <span class="dt">data =</span> onlybeetle)</a>
<a class="sourceLine" id="cb534-2" title="2"></a>
<a class="sourceLine" id="cb534-3" title="3"><span class="kw">summary</span>(m1)</a></code></pre></div>
<pre><code>##  Family: nbinom2  ( log )
## Formula:          abun ~ blooming * treatment + (1 | repID)
## Data: onlybeetle
## 
##      AIC      BIC   logLik deviance df.resid 
##   1233.7   1254.3   -610.9   1221.7      222 
## 
## Random effects:
## 
## Conditional model:
##  Groups Name        Variance Std.Dev.
##  repID  (Intercept) 0.154    0.3924  
## Number of obs: 228, groups:  repID, 126
## 
## Overdispersion parameter for nbinom2 family (): 1.77 
## 
## Conditional model:
##                             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)                   2.1046     0.1302  16.170  &lt; 2e-16 ***
## bloomingpost                 -0.3004     0.1652  -1.819  0.06894 .  
## treatmentshrub               -1.2018     0.1960  -6.132 8.67e-10 ***
## bloomingpost:treatmentshrub   0.6585     0.2476   2.660  0.00781 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb536"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb536-1" title="1">m2 &lt;-<span class="st"> </span><span class="kw">glmmTMB</span>(abun <span class="op">~</span><span class="st"> </span>blooming <span class="op">+</span><span class="st"> </span>treatment <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>repID), <span class="dt">family =</span> <span class="st">&quot;nbinom2&quot;</span>, <span class="dt">data =</span> onlybeetle)</a>
<a class="sourceLine" id="cb536-2" title="2"></a>
<a class="sourceLine" id="cb536-3" title="3">m3 &lt;-<span class="st"> </span><span class="kw">glmmTMB</span>(abun <span class="op">~</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>repID), <span class="dt">family =</span> <span class="st">&quot;nbinom2&quot;</span>,<span class="dt">data =</span> onlybeetle)</a>
<a class="sourceLine" id="cb536-4" title="4"></a>
<a class="sourceLine" id="cb536-5" title="5"></a>
<a class="sourceLine" id="cb536-6" title="6"><span class="kw">AIC</span>(m1, m2, m3)</a></code></pre></div>
<pre><code>##    df      AIC
## m1  6 1233.725
## m2  5 1238.643
## m3  3 1266.804</code></pre>
<div class="sourceCode" id="cb538"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb538-1" title="1"><span class="kw">anova</span>(m1, m2, m3)</a></code></pre></div>
<pre><code>## Data: onlybeetle
## Models:
## m3: abun ~ (1 | repID), zi=~0, disp=~1
## m2: abun ~ blooming + treatment + (1 | repID), zi=~0, disp=~1
## m1: abun ~ blooming * treatment + (1 | repID), zi=~0, disp=~1
##    Df    AIC    BIC  logLik deviance   Chisq Chi Df Pr(&gt;Chisq)    
## m3  3 1266.8 1277.1 -630.40   1260.8                              
## m2  5 1238.6 1255.8 -614.32   1228.6 32.1613      2  1.038e-07 ***
## m1  6 1233.7 1254.3 -610.86   1221.7  6.9176      1   0.008535 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb540"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb540-1" title="1"><span class="kw">summary</span>(m1)</a></code></pre></div>
<pre><code>##  Family: nbinom2  ( log )
## Formula:          abun ~ blooming * treatment + (1 | repID)
## Data: onlybeetle
## 
##      AIC      BIC   logLik deviance df.resid 
##   1233.7   1254.3   -610.9   1221.7      222 
## 
## Random effects:
## 
## Conditional model:
##  Groups Name        Variance Std.Dev.
##  repID  (Intercept) 0.154    0.3924  
## Number of obs: 228, groups:  repID, 126
## 
## Overdispersion parameter for nbinom2 family (): 1.77 
## 
## Conditional model:
##                             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)                   2.1046     0.1302  16.170  &lt; 2e-16 ***
## bloomingpost                 -0.3004     0.1652  -1.819  0.06894 .  
## treatmentshrub               -1.2018     0.1960  -6.132 8.67e-10 ***
## bloomingpost:treatmentshrub   0.6585     0.2476   2.660  0.00781 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb542"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb542-1" title="1">car<span class="op">::</span><span class="kw">Anova</span>(m1, <span class="dt">type =</span> <span class="dv">3</span>)</a></code></pre></div>
<pre><code>## Analysis of Deviance Table (Type III Wald chisquare tests)
## 
## Response: abun
##                       Chisq Df Pr(&gt;Chisq)    
## (Intercept)        261.4755  1  &lt; 2.2e-16 ***
## blooming             3.3081  1   0.068938 .  
## treatment           37.6021  1  8.675e-10 ***
## blooming:treatment   7.0759  1   0.007813 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb544"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb544-1" title="1"><span class="kw">lsmeans</span>(m1, pairwise<span class="op">~</span>blooming<span class="op">*</span>treatment)</a></code></pre></div>
<pre><code>## $lsmeans
##  blooming treatment lsmean    SE  df lower.CL upper.CL
##  pre      open       2.105 0.130 222    1.848     2.36
##  post     open       1.804 0.127 222    1.553     2.06
##  pre      shrub      0.903 0.152 222    0.603     1.20
##  post     shrub      1.261 0.137 222    0.991     1.53
## 
## Results are given on the log (not the response) scale. 
## Confidence level used: 0.95 
## 
## $contrasts
##  contrast               estimate    SE  df t.ratio p.value
##  pre,open - post,open      0.300 0.165 222  1.819  0.2672 
##  pre,open - pre,shrub      1.202 0.196 222  6.132  &lt;.0001 
##  pre,open - post,shrub     0.844 0.185 222  4.562  &lt;.0001 
##  post,open - pre,shrub     0.901 0.193 222  4.663  &lt;.0001 
##  post,open - post,shrub    0.543 0.182 222  2.982  0.0167 
##  pre,shrub - post,shrub   -0.358 0.184 222 -1.943  0.2132 
## 
## Results are given on the log (not the response) scale. 
## P value adjustment: tukey method for comparing a family of 4 estimates</code></pre>
<div class="sourceCode" id="cb546"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb546-1" title="1"><span class="kw">ggplot</span>(metadata, <span class="kw">aes</span>(blooming, abun)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_boxplot</span>() <span class="op">+</span><span class="st"> </span><span class="kw">facet_grid</span>(<span class="op">~</span>treatment)</a></code></pre></div>
<p><img src="index_files/figure-html/melyridae%20abundance%20only-2.png" width="672" /></p>
<hr />
<p>Arthropod Richness</p>
<div class="sourceCode" id="cb547"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb547-1" title="1">s1 &lt;-<span class="st"> </span><span class="kw">glmmTMB</span>(Species <span class="op">~</span><span class="st"> </span>blooming <span class="op">+</span><span class="st"> </span>treatment <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>repID), <span class="dt">family =</span> poisson, <span class="dt">data =</span> beetle)</a>
<a class="sourceLine" id="cb547-2" title="2"><span class="kw">summary</span>(s1)</a></code></pre></div>
<pre><code>##  Family: poisson  ( log )
## Formula:          Species ~ blooming + treatment + (1 | repID)
## Data: beetle
## 
##      AIC      BIC   logLik deviance df.resid 
##   1142.5   1156.2   -567.2   1134.5      224 
## 
## Random effects:
## 
## Conditional model:
##  Groups Name        Variance Std.Dev.
##  repID  (Intercept) 0.02127  0.1458  
## Number of obs: 228, groups:  repID, 126
## 
## Conditional model:
##                Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)     2.00415    0.04739   42.29  &lt; 2e-16 ***
## bloomingpost   -0.25442    0.05030   -5.06 4.24e-07 ***
## treatmentshrub  0.14540    0.05652    2.57   0.0101 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb549"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb549-1" title="1">s1.nb &lt;-<span class="st"> </span><span class="kw">glmmTMB</span>(Species <span class="op">~</span><span class="st"> </span>blooming <span class="op">+</span><span class="st"> </span>treatment <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>repID), <span class="dt">family =</span> <span class="st">&quot;nbinom1&quot;</span>, <span class="dt">data =</span> beetle)</a>
<a class="sourceLine" id="cb549-2" title="2"><span class="kw">summary</span>(s1.nb)</a></code></pre></div>
<pre><code>##  Family: nbinom1  ( log )
## Formula:          Species ~ blooming + treatment + (1 | repID)
## Data: beetle
## 
##      AIC      BIC   logLik deviance df.resid 
##   1144.1   1161.3   -567.1   1134.1      223 
## 
## Random effects:
## 
## Conditional model:
##  Groups Name        Variance Std.Dev.
##  repID  (Intercept) 0.01633  0.1278  
## Number of obs: 228, groups:  repID, 126
## 
## Overdispersion parameter for nbinom1 family (): 0.0795 
## 
## Conditional model:
##                Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)     2.00597    0.04813   41.68  &lt; 2e-16 ***
## bloomingpost   -0.25487    0.05213   -4.89 1.01e-06 ***
## treatmentshrub  0.14564    0.05679    2.56   0.0103 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb551"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb551-1" title="1">s2 &lt;-<span class="st"> </span><span class="kw">glmmTMB</span>(Species <span class="op">~</span><span class="st"> </span>blooming <span class="op">*</span><span class="st"> </span>treatment <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>repID), <span class="dt">family =</span> poisson, <span class="dt">data =</span> beetle)</a>
<a class="sourceLine" id="cb551-2" title="2"><span class="kw">summary</span>(s2)</a></code></pre></div>
<pre><code>##  Family: poisson  ( log )
## Formula:          Species ~ blooming * treatment + (1 | repID)
## Data: beetle
## 
##      AIC      BIC   logLik deviance df.resid 
##   1143.0   1160.2   -566.5   1133.0      223 
## 
## Random effects:
## 
## Conditional model:
##  Groups Name        Variance Std.Dev.
##  repID  (Intercept) 0.02112  0.1453  
## Number of obs: 228, groups:  repID, 126
## 
## Conditional model:
##                             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)                  1.97358    0.05438   36.29  &lt; 2e-16 ***
## bloomingpost                -0.19014    0.07365   -2.58  0.00983 ** 
## treatmentshrub               0.20177    0.07371    2.74  0.00619 ** 
## bloomingpost:treatmentshrub -0.12001    0.10062   -1.19  0.23296    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb553"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb553-1" title="1">s3 &lt;-<span class="st"> </span><span class="kw">glmmTMB</span>(Species <span class="op">~</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>repID), <span class="dt">family =</span> poisson, <span class="dt">data =</span> beetle)</a>
<a class="sourceLine" id="cb553-2" title="2"><span class="kw">summary</span>(s3)</a></code></pre></div>
<pre><code>##  Family: poisson  ( log )
## Formula:          Species ~ (1 | repID)
## Data: beetle
## 
##      AIC      BIC   logLik deviance df.resid 
##   1170.9   1177.7   -583.4   1166.9      226 
## 
## Random effects:
## 
## Conditional model:
##  Groups Name        Variance Std.Dev.
##  repID  (Intercept) 0.02362  0.1537  
## Number of obs: 228, groups:  repID, 126
## 
## Conditional model:
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)  1.95137    0.02897   67.35   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb555"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb555-1" title="1"><span class="kw">AIC</span>(s1, s1.nb, s2, s3)</a></code></pre></div>
<pre><code>##       df      AIC
## s1     4 1142.469
## s1.nb  5 1144.141
## s2     5 1143.046
## s3     2 1170.885</code></pre>
<div class="sourceCode" id="cb557"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb557-1" title="1"><span class="co">#poisson best here</span></a>
<a class="sourceLine" id="cb557-2" title="2"><span class="kw">anova</span>(s1,s2, s3)</a></code></pre></div>
<pre><code>## Data: beetle
## Models:
## s3: Species ~ (1 | repID), zi=~0, disp=~1
## s1: Species ~ blooming + treatment + (1 | repID), zi=~0, disp=~1
## s2: Species ~ blooming * treatment + (1 | repID), zi=~0, disp=~1
##    Df    AIC    BIC  logLik deviance   Chisq Chi Df Pr(&gt;Chisq)    
## s3  2 1170.9 1177.7 -583.44   1166.9                              
## s1  4 1142.5 1156.2 -567.23   1134.5 32.4159      2  9.141e-08 ***
## s2  5 1143.0 1160.2 -566.52   1133.0  1.4229      1     0.2329    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb559"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb559-1" title="1">car<span class="op">::</span><span class="kw">Anova</span>(s1, <span class="dt">type =</span> <span class="dv">2</span>)</a></code></pre></div>
<pre><code>## Analysis of Deviance Table (Type II Wald chisquare tests)
## 
## Response: Species
##             Chisq Df Pr(&gt;Chisq)    
## blooming  25.5826  1  4.239e-07 ***
## treatment  6.6195  1    0.01009 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb561"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb561-1" title="1"><span class="kw">ggplot</span>(beetle, <span class="kw">aes</span>(blooming, Species)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_boxplot</span>() <span class="op">+</span><span class="st"> </span><span class="kw">facet_grid</span>(<span class="op">~</span>treatment)</a></code></pre></div>
<p><img src="index_files/figure-html/arthropod%20richness-1.png" width="672" /></p>
<div class="sourceCode" id="cb562"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb562-1" title="1"><span class="kw">ggplot</span>(beetle, <span class="kw">aes</span>(treatment, Species)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_boxplot</span>() <span class="op">+</span><span class="st"> </span><span class="kw">facet_grid</span>(<span class="op">~</span>blooming)</a></code></pre></div>
<p><img src="index_files/figure-html/arthropod%20richness-2.png" width="672" /></p>
<div class="sourceCode" id="cb563"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb563-1" title="1"><span class="co">#species accumulation</span></a>
<a class="sourceLine" id="cb563-2" title="2">insects &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;Output Data/wide_yesbeetle.csv&quot;</span>)</a>
<a class="sourceLine" id="cb563-3" title="3"><span class="kw">row.names</span>(insects) &lt;-<span class="st"> </span>insects<span class="op">$</span>X</a>
<a class="sourceLine" id="cb563-4" title="4">insects &lt;-<span class="st"> </span><span class="kw">select</span>(insects, <span class="op">-</span>X)</a>
<a class="sourceLine" id="cb563-5" title="5"><span class="kw">plot</span>(<span class="kw">specaccum</span>(insects), <span class="dt">xlab =</span> <span class="st">&quot;# of samples&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;# of species&quot;</span>)</a></code></pre></div>
<p><img src="index_files/figure-html/species%20accumulation-1.png" width="672" /></p>
<div class="sourceCode" id="cb564"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb564-1" title="1">insects &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;Output Data/wide_yesbeetle.csv&quot;</span>)</a>
<a class="sourceLine" id="cb564-2" title="2">bees &lt;-<span class="st"> </span><span class="kw">select</span>(insects, <span class="dv">5</span><span class="op">:</span><span class="dv">7</span>,<span class="dv">12</span>,<span class="dv">14</span>,<span class="dv">16</span>,<span class="dv">36</span>,<span class="dv">37</span>,<span class="dv">42</span>,<span class="dv">43</span>,<span class="dv">49</span>,<span class="dv">50</span>,<span class="dv">61</span>,<span class="dv">64</span>,<span class="dv">65</span>,<span class="dv">67</span>,<span class="dv">72</span>,<span class="dv">73</span>,<span class="dv">75</span>,<span class="dv">87</span>,<span class="dv">92</span>,<span class="dv">96</span>)</a>
<a class="sourceLine" id="cb564-3" title="3"></a>
<a class="sourceLine" id="cb564-4" title="4"></a>
<a class="sourceLine" id="cb564-5" title="5">metadata &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;Clean Data/pantraps_cov.csv&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb564-6" title="6">metadata &lt;-<span class="st"> </span><span class="kw">filter</span>(metadata, species <span class="op">!=</span><span class="st"> &quot;buckhorn&quot;</span>)</a>
<a class="sourceLine" id="cb564-7" title="7">metadata<span class="op">$</span>plant.id &lt;-<span class="st"> </span><span class="kw">as.character</span>(metadata<span class="op">$</span>plant.id)</a>
<a class="sourceLine" id="cb564-8" title="8"><span class="kw">str</span>(metadata)</a></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    228 obs. of  8 variables:
##  $ plant.id     : chr  &quot;296&quot; &quot;296&quot; &quot;189&quot; &quot;189&quot; ...
##  $ species      : Factor w/ 2 levels &quot;buckhorn&quot;,&quot;larrea&quot;: 2 2 2 2 2 2 2 2 2 2 ...
##  $ treatment    : Factor w/ 2 levels &quot;open&quot;,&quot;shrub&quot;: 2 1 2 1 2 1 2 1 2 1 ...
##  $ blooming     : Factor w/ 2 levels &quot;post&quot;,&quot;pre&quot;: 2 2 2 2 2 2 2 2 2 2 ...
##  $ date         : Factor w/ 21 levels &quot;4.10.2017&quot;,&quot;4.11.2017&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
##  $ percent.cover: int  15 3 25 2 40 15 40 3 70 10 ...
##  $ perennial    : Factor w/ 5 levels &quot;&quot;,&quot;1&quot;,&quot;2&quot;,&quot;3&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
##  $ X            : Factor w/ 6 levels &quot;&quot;,&quot;blue and white knocked over&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...</code></pre>
<div class="sourceCode" id="cb566"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb566-1" title="1">metadata<span class="op">$</span>uniID &lt;-<span class="st"> </span><span class="kw">paste</span>(metadata<span class="op">$</span>date, metadata<span class="op">$</span>plant.id, metadata<span class="op">$</span>treatment)</a>
<a class="sourceLine" id="cb566-2" title="2"><span class="kw">row.names</span>(metadata) &lt;-<span class="st"> </span>metadata<span class="op">$</span>uniID</a>
<a class="sourceLine" id="cb566-3" title="3"></a>
<a class="sourceLine" id="cb566-4" title="4"></a>
<a class="sourceLine" id="cb566-5" title="5">beemeta &lt;-<span class="st"> </span>metadata</a>
<a class="sourceLine" id="cb566-6" title="6"></a>
<a class="sourceLine" id="cb566-7" title="7">beemeta<span class="op">$</span>abun &lt;-<span class="st"> </span><span class="kw">apply</span>(bees, <span class="dv">1</span>, sum)</a>
<a class="sourceLine" id="cb566-8" title="8"><span class="co">#check for total</span></a>
<a class="sourceLine" id="cb566-9" title="9"><span class="kw">sum</span>(beemeta<span class="op">$</span>abun)</a></code></pre></div>
<pre><code>## [1] 144</code></pre>
<div class="sourceCode" id="cb568"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb568-1" title="1">H &lt;-<span class="st"> </span><span class="kw">diversity</span>(bees)</a>
<a class="sourceLine" id="cb568-2" title="2">simp &lt;-<span class="st"> </span><span class="kw">diversity</span>(bees, <span class="st">&quot;simpson&quot;</span>)</a>
<a class="sourceLine" id="cb568-3" title="3">S &lt;-<span class="st"> </span><span class="kw">specnumber</span>(bees)</a>
<a class="sourceLine" id="cb568-4" title="4">J &lt;-<span class="st"> </span>H<span class="op">/</span><span class="kw">log</span>(S)</a>
<a class="sourceLine" id="cb568-5" title="5">beemeta<span class="op">$</span>H &lt;-<span class="st"> </span>H</a>
<a class="sourceLine" id="cb568-6" title="6">beemeta<span class="op">$</span>Simpson &lt;-<span class="st"> </span>simp</a>
<a class="sourceLine" id="cb568-7" title="7">beemeta<span class="op">$</span>Species &lt;-<span class="st"> </span>S</a>
<a class="sourceLine" id="cb568-8" title="8">beemeta<span class="op">$</span>Even &lt;-<span class="st"> </span>J</a>
<a class="sourceLine" id="cb568-9" title="9"></a>
<a class="sourceLine" id="cb568-10" title="10"></a>
<a class="sourceLine" id="cb568-11" title="11"><span class="kw">t.test</span>(beemeta<span class="op">$</span>Species <span class="op">~</span><span class="st"> </span>beemeta<span class="op">$</span>blooming)</a></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  beemeta$Species by beemeta$blooming
## t = 0.30599, df = 224.71, p-value = 0.7599
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -0.1662234  0.2273345
## sample estimates:
## mean in group post  mean in group pre 
##          0.5583333          0.5277778</code></pre>
<div class="sourceCode" id="cb570"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb570-1" title="1"><span class="kw">library</span>(glmmTMB)</a>
<a class="sourceLine" id="cb570-2" title="2">m1 &lt;-<span class="st"> </span><span class="kw">glmmTMB</span>(Species <span class="op">~</span><span class="st"> </span>treatment <span class="op">+</span><span class="st"> </span>blooming <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>plant.id), <span class="dt">family =</span> <span class="st">&quot;nbinom2&quot;</span>, beemeta)</a>
<a class="sourceLine" id="cb570-3" title="3"><span class="kw">summary</span>(m1)</a></code></pre></div>
<pre><code>##  Family: nbinom2  ( log )
## Formula:          Species ~ treatment + blooming + (1 | plant.id)
## Data: beemeta
## 
##      AIC      BIC   logLik deviance df.resid 
##    454.3    471.5   -222.2    444.3      223 
## 
## Random effects:
## 
## Conditional model:
##  Groups   Name        Variance  Std.Dev. 
##  plant.id (Intercept) 2.836e-08 0.0001684
## Number of obs: 228, groups:  plant.id, 63
## 
## Overdispersion parameter for nbinom2 family (): 15.7 
## 
## Conditional model:
##                Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)    -0.55101    0.15266  -3.610 0.000307 ***
## treatmentshrub -0.06457    0.18278  -0.353 0.723867    
## bloomingpre    -0.05632    0.18327  -0.307 0.758605    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb572"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb572-1" title="1">car<span class="op">::</span><span class="kw">Anova</span>(m1, <span class="dt">type =</span> <span class="dv">2</span>)</a></code></pre></div>
<pre><code>## Analysis of Deviance Table (Type II Wald chisquare tests)
## 
## Response: Species
##            Chisq Df Pr(&gt;Chisq)
## treatment 0.1248  1     0.7239
## blooming  0.0944  1     0.7586</code></pre>
<div class="sourceCode" id="cb574"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb574-1" title="1">m2 &lt;-<span class="st"> </span><span class="kw">glmmTMB</span>(Species <span class="op">~</span><span class="st"> </span>treatment <span class="op">+</span><span class="st"> </span>blooming <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>plant.id), <span class="dt">family =</span> <span class="st">&quot;poisson&quot;</span>, beemeta)</a>
<a class="sourceLine" id="cb574-2" title="2"></a>
<a class="sourceLine" id="cb574-3" title="3"><span class="kw">summary</span>(m2)</a></code></pre></div>
<pre><code>##  Family: poisson  ( log )
## Formula:          Species ~ treatment + blooming + (1 | plant.id)
## Data: beemeta
## 
##      AIC      BIC   logLik deviance df.resid 
##    452.4    466.2   -222.2    444.4      224 
## 
## Random effects:
## 
## Conditional model:
##  Groups   Name        Variance Std.Dev.
##  plant.id (Intercept) 0.01397  0.1182  
## Number of obs: 228, groups:  plant.id, 63
## 
## Conditional model:
##                Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)    -0.55806    0.15905  -3.509  0.00045 ***
## treatmentshrub -0.06454    0.17970  -0.359  0.71948    
## bloomingpre    -0.05522    0.18050  -0.306  0.75966    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb576"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb576-1" title="1">m3 &lt;-<span class="st"> </span><span class="kw">glmmTMB</span>(Species <span class="op">~</span><span class="st"> </span>treatment <span class="op">*</span><span class="st"> </span>blooming <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>plant.id), <span class="dt">family =</span> <span class="st">&quot;poisson&quot;</span>, beemeta)</a>
<a class="sourceLine" id="cb576-2" title="2"></a>
<a class="sourceLine" id="cb576-3" title="3">null &lt;-<span class="st"> </span><span class="kw">glmmTMB</span>(Species <span class="op">~</span><span class="st">  </span>(<span class="dv">1</span><span class="op">|</span>plant.id), <span class="dt">family =</span> <span class="st">&quot;poisson&quot;</span>, beemeta)</a>
<a class="sourceLine" id="cb576-4" title="4"></a>
<a class="sourceLine" id="cb576-5" title="5"><span class="co">#poisson is best</span></a>
<a class="sourceLine" id="cb576-6" title="6"><span class="kw">AIC</span>(m1, m2, m3, null)</a></code></pre></div>
<pre><code>##      df      AIC
## m1    5 454.3296
## m2    4 452.4455
## m3    5 454.4016
## null  2 448.6682</code></pre>
<div class="sourceCode" id="cb578"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb578-1" title="1"><span class="co">#null model has lowest AIC</span></a>
<a class="sourceLine" id="cb578-2" title="2">car<span class="op">::</span><span class="kw">Anova</span>(m2, <span class="dt">type =</span> <span class="dv">2</span>)</a></code></pre></div>
<pre><code>## Analysis of Deviance Table (Type II Wald chisquare tests)
## 
## Response: Species
##            Chisq Df Pr(&gt;Chisq)
## treatment 0.1290  1     0.7195
## blooming  0.0936  1     0.7597</code></pre>
<div class="sourceCode" id="cb580"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb580-1" title="1"><span class="co">#bee abundance</span></a>
<a class="sourceLine" id="cb580-2" title="2"></a>
<a class="sourceLine" id="cb580-3" title="3">m1 &lt;-<span class="st"> </span><span class="kw">glmmTMB</span>(abun <span class="op">~</span><span class="st"> </span>treatment <span class="op">+</span><span class="st"> </span>blooming <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>plant.id), <span class="dt">family =</span> <span class="st">&quot;nbinom2&quot;</span>, beemeta)</a>
<a class="sourceLine" id="cb580-4" title="4"><span class="kw">summary</span>(m1)</a></code></pre></div>
<pre><code>##  Family: nbinom2  ( log )
## Formula:          abun ~ treatment + blooming + (1 | plant.id)
## Data: beemeta
## 
##      AIC      BIC   logLik deviance df.resid 
##    503.7    520.9   -246.9    493.7      223 
## 
## Random effects:
## 
## Conditional model:
##  Groups   Name        Variance Std.Dev.
##  plant.id (Intercept) 0.005254 0.07249 
## Number of obs: 228, groups:  plant.id, 63
## 
## Overdispersion parameter for nbinom2 family (): 1.86 
## 
## Conditional model:
##                Estimate Std. Error z value Pr(&gt;|z|)   
## (Intercept)    -0.47282    0.17801  -2.656   0.0079 **
## treatmentshrub -0.05412    0.19352  -0.280   0.7797   
## bloomingpre     0.07755    0.19354   0.401   0.6886   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb582"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb582-1" title="1">car<span class="op">::</span><span class="kw">Anova</span>(m1, <span class="dt">type =</span> <span class="dv">2</span>)</a></code></pre></div>
<pre><code>## Analysis of Deviance Table (Type II Wald chisquare tests)
## 
## Response: abun
##            Chisq Df Pr(&gt;Chisq)
## treatment 0.0782  1     0.7797
## blooming  0.1606  1     0.6886</code></pre>
<div class="sourceCode" id="cb584"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb584-1" title="1">m2 &lt;-<span class="st"> </span><span class="kw">glmmTMB</span>(abun <span class="op">~</span><span class="st"> </span>treatment <span class="op">+</span><span class="st"> </span>blooming <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>plant.id), <span class="dt">family =</span> <span class="st">&quot;poisson&quot;</span>, beemeta)</a>
<a class="sourceLine" id="cb584-2" title="2"></a>
<a class="sourceLine" id="cb584-3" title="3"><span class="kw">summary</span>(m2)</a></code></pre></div>
<pre><code>##  Family: poisson  ( log )
## Formula:          abun ~ treatment + blooming + (1 | plant.id)
## Data: beemeta
## 
##      AIC      BIC   logLik deviance df.resid 
##    507.6    521.3   -249.8    499.6      224 
## 
## Random effects:
## 
## Conditional model:
##  Groups   Name        Variance Std.Dev.
##  plant.id (Intercept) 0.1509   0.3884  
## Number of obs: 228, groups:  plant.id, 63
## 
## Conditional model:
##                Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)    -0.54750    0.15925  -3.438 0.000586 ***
## treatmentshrub -0.05558    0.16673  -0.333 0.738882    
## bloomingpre     0.09348    0.16864   0.554 0.579347    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb586"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb586-1" title="1">m3 &lt;-<span class="st"> </span><span class="kw">glmmTMB</span>(abun <span class="op">~</span><span class="st"> </span>treatment <span class="op">*</span><span class="st"> </span>blooming <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>plant.id), <span class="dt">family =</span> <span class="st">&quot;poisson&quot;</span>, beemeta)</a>
<a class="sourceLine" id="cb586-2" title="2"></a>
<a class="sourceLine" id="cb586-3" title="3">null &lt;-<span class="st"> </span><span class="kw">glmmTMB</span>(abun <span class="op">~</span><span class="st">  </span>(<span class="dv">1</span><span class="op">|</span>plant.id), <span class="dt">family =</span> <span class="st">&quot;poisson&quot;</span>, beemeta)</a>
<a class="sourceLine" id="cb586-4" title="4"></a>
<a class="sourceLine" id="cb586-5" title="5"><span class="co">#poisson is best</span></a>
<a class="sourceLine" id="cb586-6" title="6"><span class="kw">AIC</span>(m1, m2, m3, null)</a></code></pre></div>
<pre><code>##      df      AIC
## m1    5 503.7089
## m2    4 507.5898
## m3    5 509.3348
## null  2 504.0082</code></pre>
<div class="sourceCode" id="cb588"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb588-1" title="1"><span class="co">#null model has lowest AIC</span></a>
<a class="sourceLine" id="cb588-2" title="2">car<span class="op">::</span><span class="kw">Anova</span>(m2, <span class="dt">type =</span> <span class="dv">2</span>)</a></code></pre></div>
<pre><code>## Analysis of Deviance Table (Type II Wald chisquare tests)
## 
## Response: abun
##            Chisq Df Pr(&gt;Chisq)
## treatment 0.1111  1     0.7389
## blooming  0.3073  1     0.5793</code></pre>
<p>Need to add code for bee abundance and bee diversity. Bee abundance won’t change, diversity is unlikely.</p>
<p>###Visitation to L. tridentata In-situ observation of visitation to L. tridentata, to determine which pollinators were visiting and if visitation was related to flower number and/or height</p>
<div class="sourceCode" id="cb590"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb590-1" title="1">larrea &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;Clean Data/larreavisits.csv&quot;</span>)</a>
<a class="sourceLine" id="cb590-2" title="2">cov &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;Clean Data/insitu_cov_larrea.csv&quot;</span>)</a>
<a class="sourceLine" id="cb590-3" title="3">sizes &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;Clean Data/video_larreadimensions.csv&quot;</span>)</a>
<a class="sourceLine" id="cb590-4" title="4">cov &lt;-<span class="st"> </span><span class="kw">distinct</span>(cov)</a>
<a class="sourceLine" id="cb590-5" title="5">cov &lt;-<span class="st"> </span><span class="kw">select</span>(cov, <span class="op">-</span>date)</a>
<a class="sourceLine" id="cb590-6" title="6">cov<span class="op">$</span>repID &lt;-<span class="st"> </span><span class="kw">paste</span>(cov<span class="op">$</span>plant.id, <span class="st">&quot;post&quot;</span>)</a>
<a class="sourceLine" id="cb590-7" title="7"></a>
<a class="sourceLine" id="cb590-8" title="8">larrea<span class="op">$</span>repID &lt;-<span class="st"> </span><span class="kw">paste</span>(larrea<span class="op">$</span>PlantID, larrea<span class="op">$</span>pre.post)</a>
<a class="sourceLine" id="cb590-9" title="9">cov &lt;-<span class="st"> </span><span class="kw">inner_join</span>(cov, sizes, <span class="dt">by =</span> <span class="st">&quot;plant.id&quot;</span>)</a></code></pre></div>
<pre><code>## Warning: Column `plant.id` joining factors with different levels, coercing
## to character vector</code></pre>
<div class="sourceCode" id="cb592"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb592-1" title="1">cov &lt;-<span class="st"> </span><span class="kw">select</span>(cov, <span class="op">-</span>plant.id)</a>
<a class="sourceLine" id="cb592-2" title="2">larrea &lt;-<span class="st"> </span><span class="kw">left_join</span>(larrea, cov, <span class="dt">by =</span> <span class="st">&quot;repID&quot;</span>)</a>
<a class="sourceLine" id="cb592-3" title="3"></a>
<a class="sourceLine" id="cb592-4" title="4"><span class="co">#N.FLOWER is only applicable to post. it was just easier to join this way!</span></a>
<a class="sourceLine" id="cb592-5" title="5"></a>
<a class="sourceLine" id="cb592-6" title="6"><span class="kw">count</span>(larrea, pre.post)</a></code></pre></div>
<pre><code>## # A tibble: 2 x 2
##   pre.post     n
##   &lt;fct&gt;    &lt;int&gt;
## 1 post       401
## 2 pre        138</code></pre>
<div class="sourceCode" id="cb594"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb594-1" title="1"><span class="co">#how does floral visitation relate to #flowers</span></a>
<a class="sourceLine" id="cb594-2" title="2">fl &lt;-<span class="st"> </span><span class="kw">filter</span>(larrea, part.used <span class="op">==</span><span class="st"> &quot;flower&quot;</span>)</a>
<a class="sourceLine" id="cb594-3" title="3">fl.count &lt;-<span class="st"> </span>fl <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">count</span>(repID)</a>
<a class="sourceLine" id="cb594-4" title="4"></a>
<a class="sourceLine" id="cb594-5" title="5">lar.all &lt;-<span class="st"> </span><span class="kw">left_join</span>(cov, fl.count, <span class="dt">by =</span> <span class="st">&quot;repID&quot;</span>)</a>
<a class="sourceLine" id="cb594-6" title="6"></a>
<a class="sourceLine" id="cb594-7" title="7"><span class="co">#there are 58 because of the wind </span></a>
<a class="sourceLine" id="cb594-8" title="8"></a>
<a class="sourceLine" id="cb594-9" title="9"><span class="co">#attach neighbour density</span></a>
<a class="sourceLine" id="cb594-10" title="10">pans &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;Output Data/metadata_yesbeetle.csv&quot;</span>)</a>
<a class="sourceLine" id="cb594-11" title="11">pans<span class="op">$</span>repID &lt;-<span class="st"> </span><span class="kw">paste</span>(pans<span class="op">$</span>plant.id, pans<span class="op">$</span>blooming)</a>
<a class="sourceLine" id="cb594-12" title="12">pans &lt;-<span class="st"> </span><span class="kw">filter</span>(pans, blooming <span class="op">==</span><span class="st"> &quot;post&quot;</span> <span class="op">&amp;</span><span class="st"> </span>treatment <span class="op">==</span><span class="st"> &quot;shrub&quot;</span>)</a>
<a class="sourceLine" id="cb594-13" title="13">lar.all &lt;-<span class="st"> </span><span class="kw">left_join</span>(lar.all, pans, <span class="dt">by =</span> <span class="st">&quot;repID&quot;</span>)</a>
<a class="sourceLine" id="cb594-14" title="14"></a>
<a class="sourceLine" id="cb594-15" title="15">lar.all<span class="op">$</span>n[<span class="kw">is.na</span>(lar.all<span class="op">$</span>n)] &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb594-16" title="16"></a>
<a class="sourceLine" id="cb594-17" title="17"><span class="co">#join video covariates</span></a>
<a class="sourceLine" id="cb594-18" title="18">vid.cov &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;Clean Data/video_cov.csv&quot;</span>)</a>
<a class="sourceLine" id="cb594-19" title="19">vid.cov<span class="op">$</span>flowering &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&quot;bloom&quot;</span>, <span class="st">&quot;post&quot;</span>, vid.cov<span class="op">$</span>flowering)</a>
<a class="sourceLine" id="cb594-20" title="20">vid.cov<span class="op">$</span>repID &lt;-<span class="st"> </span><span class="kw">paste</span>(vid.cov<span class="op">$</span>PlantID, vid.cov<span class="op">$</span>flowering)</a>
<a class="sourceLine" id="cb594-21" title="21">lar.all &lt;-<span class="st"> </span>vid.cov <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(flowering <span class="op">==</span><span class="st"> &quot;post&quot;</span> <span class="op">&amp;</span><span class="st"> </span>treatment <span class="op">==</span><span class="st"> &quot;shrub&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">left_join</span>(lar.all, vid.cov, <span class="dt">by =</span> <span class="st">&quot;repID&quot;</span>)</a>
<a class="sourceLine" id="cb594-22" title="22"></a>
<a class="sourceLine" id="cb594-23" title="23"><span class="kw">ggplot</span>(lar.all, <span class="kw">aes</span>(n)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_density</span>()</a></code></pre></div>
<pre><code>## Warning: Removed 1 rows containing non-finite values (stat_density).</code></pre>
<p><img src="index_files/figure-html/larrea%20visitation-1.png" width="672" /></p>
<div class="sourceCode" id="cb596"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb596-1" title="1">visitors &lt;-<span class="st"> </span>fl <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(., pre.post, part.used) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">count</span>(., v.species)</a>
<a class="sourceLine" id="cb596-2" title="2"><span class="kw">sum</span>(visitors<span class="op">$</span>n)</a></code></pre></div>
<pre><code>## [1] 197</code></pre>
<div class="sourceCode" id="cb598"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb598-1" title="1"><span class="co">#modelling</span></a>
<a class="sourceLine" id="cb598-2" title="2">cov &lt;-<span class="st"> </span><span class="kw">left_join</span>(cov, fl.count, <span class="dt">by =</span> <span class="st">&quot;repID&quot;</span>)</a>
<a class="sourceLine" id="cb598-3" title="3">cov<span class="op">$</span>n[<span class="kw">is.na</span>(cov<span class="op">$</span>n)] &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb598-4" title="4"></a>
<a class="sourceLine" id="cb598-5" title="5">m1 &lt;-<span class="st"> </span><span class="kw">glm</span>(<span class="dt">data =</span> cov, <span class="dt">family =</span> <span class="st">&quot;quasipoisson&quot;</span>(<span class="dt">link=</span><span class="st">&quot;log&quot;</span>), n <span class="op">~</span><span class="st"> </span>n.flowers)</a>
<a class="sourceLine" id="cb598-6" title="6"></a>
<a class="sourceLine" id="cb598-7" title="7"><span class="kw">summary</span>(m1)</a></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = n ~ n.flowers, family = quasipoisson(link = &quot;log&quot;), 
##     data = cov)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -2.6742  -1.5054  -0.4227   0.8007   5.2371  
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)   
## (Intercept) 0.7820540  0.2417340   3.235  0.00204 **
## n.flowers   0.0013408  0.0005728   2.341  0.02283 * 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for quasipoisson family taken to be 3.367143)
## 
##     Null deviance: 198.46  on 57  degrees of freedom
## Residual deviance: 182.84  on 56  degrees of freedom
## AIC: NA
## 
## Number of Fisher Scoring iterations: 5</code></pre>
<div class="sourceCode" id="cb600"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb600-1" title="1">car<span class="op">::</span><span class="kw">Anova</span>(m1)</a></code></pre></div>
<pre><code>## Analysis of Deviance Table (Type II tests)
## 
## Response: n
##           LR Chisq Df Pr(&gt;Chisq)  
## n.flowers   4.6383  1    0.03127 *
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb602"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb602-1" title="1">m2 &lt;-<span class="st"> </span><span class="kw">glm</span>(<span class="dt">data =</span> cov, <span class="dt">family =</span> <span class="st">&quot;quasipoisson&quot;</span>(<span class="dt">link=</span><span class="st">&quot;log&quot;</span>), n <span class="op">~</span><span class="st"> </span>n.flowers <span class="op">+</span><span class="st"> </span>height)</a>
<a class="sourceLine" id="cb602-2" title="2">m3 &lt;-<span class="st"> </span><span class="kw">glm</span>(<span class="dt">data =</span> cov, <span class="dt">family =</span> <span class="st">&quot;quasipoisson&quot;</span>(<span class="dt">link=</span><span class="st">&quot;log&quot;</span>), n <span class="op">~</span><span class="st"> </span>height)</a>
<a class="sourceLine" id="cb602-3" title="3"></a>
<a class="sourceLine" id="cb602-4" title="4"><span class="kw">summary</span>(m2)</a></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = n ~ n.flowers + height, family = quasipoisson(link = &quot;log&quot;), 
##     data = cov)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -2.8819  -1.5538  -0.3812   1.0401   4.7540  
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)  
## (Intercept) -8.865e-05  6.637e-01   0.000   0.9999  
## n.flowers    1.069e-03  6.084e-04   1.756   0.0847 .
## height       4.010e-03  3.087e-03   1.299   0.1995  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for quasipoisson family taken to be 3.265603)
## 
##     Null deviance: 197.77  on 56  degrees of freedom
## Residual deviance: 177.29  on 54  degrees of freedom
##   (1 observation deleted due to missingness)
## AIC: NA
## 
## Number of Fisher Scoring iterations: 5</code></pre>
<div class="sourceCode" id="cb604"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb604-1" title="1"><span class="kw">summary</span>(m3)</a></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = n ~ height, family = quasipoisson(link = &quot;log&quot;), 
##     data = cov)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -3.1211  -1.6240  -0.5905   1.1983   4.6031  
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)  
## (Intercept) 0.044102   0.638327   0.069    0.945  
## height      0.005400   0.002824   1.913    0.061 .
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for quasipoisson family taken to be 3.209795)
## 
##     Null deviance: 197.77  on 56  degrees of freedom
## Residual deviance: 186.19  on 55  degrees of freedom
##   (1 observation deleted due to missingness)
## AIC: NA
## 
## Number of Fisher Scoring iterations: 5</code></pre>
<div class="sourceCode" id="cb606"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb606-1" title="1">car<span class="op">::</span><span class="kw">Anova</span>(m3, <span class="dt">type =</span> <span class="dv">2</span>)</a></code></pre></div>
<pre><code>## Analysis of Deviance Table (Type II tests)
## 
## Response: n
##        LR Chisq Df Pr(&gt;Chisq)  
## height   3.6066  1    0.05755 .
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb608"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb608-1" title="1"><span class="kw">ggplot</span>(cov, <span class="kw">aes</span>(n.flowers, n)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="dt">shape =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_smooth</span>(<span class="dt">color =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">size =</span> <span class="fl">0.5</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme_Publication</span>() <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Floral abundance&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Visits per 15 min&quot;</span>)</a></code></pre></div>
<pre><code>## Warning: `legend.margin` must be specified using `margin()`. For the old
## behavior use legend.spacing</code></pre>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<pre><code>## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font family not found in Windows font database</code></pre>
<pre><code>## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font family not found in Windows font database

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font family not found in Windows font database

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font family not found in Windows font database

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font family not found in Windows font database

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font family not found in Windows font database

## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font family not found in Windows font database</code></pre>
<pre><code>## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x,
## x$y, : font family not found in Windows font database</code></pre>
<p><img src="index_files/figure-html/larrea%20visitation-2.png" width="672" /></p>
<div class="sourceCode" id="cb614"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb614-1" title="1"><span class="co">#cor.test(repcounts.all$n.flowers, repcounts.all$width)</span></a>
<a class="sourceLine" id="cb614-2" title="2"><span class="kw">cor.test</span>(lar.all<span class="op">$</span>n.flowers, lar.all<span class="op">$</span>height)</a></code></pre></div>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  lar.all$n.flowers and lar.all$height
## t = 2.6659, df = 56, p-value = 0.01002
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  0.08463171 0.54651435
## sample estimates:
##       cor 
## 0.3355914</code></pre>
<div class="sourceCode" id="cb616"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb616-1" title="1"><span class="co">#cor.test(repcounts.all$width, repcounts.all$height)</span></a>
<a class="sourceLine" id="cb616-2" title="2"></a>
<a class="sourceLine" id="cb616-3" title="3"><span class="kw">mean</span>(lar.all<span class="op">$</span>height)</a></code></pre></div>
<pre><code>## [1] NA</code></pre>
<hr />
<p>#Abiotic effects 16 data loggers were placed in shrub/open microsites (8 and 8).</p>
<div class="sourceCode" id="cb618"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb618-1" title="1"><span class="kw">setwd</span>(<span class="st">&quot;Clean Data/loggers&quot;</span>)</a>
<a class="sourceLine" id="cb618-2" title="2">temp &lt;-<span class="st"> </span><span class="kw">list.files</span>(<span class="dt">pattern=</span><span class="st">&quot;*.csv&quot;</span>)</a>
<a class="sourceLine" id="cb618-3" title="3">name &lt;-<span class="st"> </span><span class="kw">list.files</span>(<span class="dt">pattern=</span><span class="st">&quot;*.csv&quot;</span>)</a>
<a class="sourceLine" id="cb618-4" title="4">datalist &lt;-<span class="st"> </span><span class="kw">list</span>()</a>
<a class="sourceLine" id="cb618-5" title="5"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(temp)) {</a>
<a class="sourceLine" id="cb618-6" title="6">  ob &lt;-<span class="st"> </span><span class="kw">read.csv</span>(temp[i], <span class="dt">header =</span> <span class="ot">FALSE</span>)    <span class="co">#read in csv</span></a>
<a class="sourceLine" id="cb618-7" title="7">  ob &lt;-<span class="st"> </span>ob[<span class="op">-</span><span class="dv">1</span>,] <span class="co">#delete weird first row</span></a>
<a class="sourceLine" id="cb618-8" title="8">  <span class="co">#colnames(ob) &lt;- as.character(unlist(ob[1,]))</span></a>
<a class="sourceLine" id="cb618-9" title="9">  ob &lt;-<span class="st"> </span>ob[<span class="op">-</span><span class="dv">1</span>,]</a>
<a class="sourceLine" id="cb618-10" title="10"></a>
<a class="sourceLine" id="cb618-11" title="11">  ob<span class="op">$</span>loggername &lt;-<span class="st"> </span>name[i]</a>
<a class="sourceLine" id="cb618-12" title="12">  datalist[[i]] &lt;-<span class="st"> </span>ob</a>
<a class="sourceLine" id="cb618-13" title="13">}</a>
<a class="sourceLine" id="cb618-14" title="14"></a>
<a class="sourceLine" id="cb618-15" title="15">allLoggers &lt;-<span class="st"> </span><span class="kw">bind_rows</span>(datalist)</a>
<a class="sourceLine" id="cb618-16" title="16"><span class="kw">colnames</span>(allLoggers) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;1&quot;</span>, <span class="st">&quot;date.time&quot;</span>, <span class="st">&quot;temp&quot;</span>, <span class="st">&quot;light.intensity&quot;</span>, <span class="st">&quot;coupler.detached&quot;</span>, <span class="st">&quot;coupler.attached&quot;</span>, <span class="st">&quot;host.connected&quot;</span>, <span class="st">&quot;stopped&quot;</span>, <span class="st">&quot;logger.name&quot;</span>, <span class="st">&quot;end.of.file&quot;</span>, <span class="st">&quot;empty col&quot;</span>)</a>
<a class="sourceLine" id="cb618-17" title="17"></a>
<a class="sourceLine" id="cb618-18" title="18"><span class="co">#now for some wrangling</span></a>
<a class="sourceLine" id="cb618-19" title="19"><span class="co"># split day and time column</span></a>
<a class="sourceLine" id="cb618-20" title="20"></a>
<a class="sourceLine" id="cb618-21" title="21"> </a>
<a class="sourceLine" id="cb618-22" title="22">allLoggers &lt;-<span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(allLoggers, <span class="dv">-11</span>)  </a>
<a class="sourceLine" id="cb618-23" title="23">allLoggers &lt;-<span class="st"> </span><span class="kw">separate</span>(allLoggers, date.time, <span class="kw">c</span>(<span class="st">&quot;Date&quot;</span>, <span class="st">&quot;time&quot;</span>), <span class="dt">sep =</span> <span class="dv">9</span>) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span><span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">separate</span>(<span class="st">&quot;logger.name&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;plant.id&quot;</span>, <span class="st">&quot;treatment&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;-&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(Date<span class="op">:</span>light.intensity, plant.id<span class="op">:</span>treatment) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">separate</span>(plant.id, <span class="kw">c</span>(<span class="st">&quot;species&quot;</span>, <span class="st">&quot;id&quot;</span>), <span class="dt">sep =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb618-24" title="24"></a>
<a class="sourceLine" id="cb618-25" title="25"><span class="co">#delete rows from first days and last days</span></a>
<a class="sourceLine" id="cb618-26" title="26"><span class="co">#delete rows from last day</span></a>
<a class="sourceLine" id="cb618-27" title="27"></a>
<a class="sourceLine" id="cb618-28" title="28">allLoggers<span class="op">$</span>Date &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&quot; &quot;</span>,<span class="st">&quot;&quot;</span>, allLoggers<span class="op">$</span>Date)</a>
<a class="sourceLine" id="cb618-29" title="29">allLoggers &lt;-<span class="st"> </span><span class="kw">filter</span>(allLoggers, Date <span class="op">!=</span><span class="st"> &quot;05/11/17&quot;</span> <span class="op">&amp;</span><span class="st"> </span>Date <span class="op">!=</span><span class="st"> &quot;03/17/17&quot;</span> <span class="op">&amp;</span><span class="st"> </span>Date <span class="op">!=</span><span class="st"> &quot;03/18/17&quot;</span>) </a>
<a class="sourceLine" id="cb618-30" title="30">allLoggers &lt;-<span class="st"> </span><span class="kw">filter</span>(allLoggers, Date <span class="op">!=</span><span class="st"> &quot;&quot;</span>) </a>
<a class="sourceLine" id="cb618-31" title="31">                     </a>
<a class="sourceLine" id="cb618-32" title="32"><span class="co">#convert time from 12 to 24 hours</span></a>
<a class="sourceLine" id="cb618-33" title="33">allLoggers<span class="op">$</span>time &lt;-<span class="st"> </span><span class="kw">format</span>(<span class="kw">strptime</span>(allLoggers<span class="op">$</span>time, <span class="st">&quot;%I:%M:%S %p&quot;</span>), <span class="dt">format=</span><span class="st">&quot;%H:%M:%S&quot;</span>)</a>
<a class="sourceLine" id="cb618-34" title="34"></a>
<a class="sourceLine" id="cb618-35" title="35">allLoggers<span class="op">$</span>hour &lt;-<span class="st"> </span><span class="kw">substr</span>(allLoggers<span class="op">$</span>time,<span class="dv">1</span>,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb618-36" title="36">allLoggers<span class="op">$</span>temp &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(allLoggers<span class="op">$</span>temp)</a>
<a class="sourceLine" id="cb618-37" title="37"><span class="co">#EDA</span></a>
<a class="sourceLine" id="cb618-38" title="38"></a>
<a class="sourceLine" id="cb618-39" title="39"><span class="kw">str</span>(allLoggers)</a></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    81408 obs. of  8 variables:
##  $ Date           : chr  &quot;03/19/17&quot; &quot;03/19/17&quot; &quot;03/19/17&quot; &quot;03/19/17&quot; ...
##  $ time           : chr  &quot;00:00:00&quot; &quot;00:30:00&quot; &quot;01:00:00&quot; &quot;01:30:00&quot; ...
##  $ temp           : num  52.6 53.1 47.4 45.3 44.6 ...
##  $ light.intensity: chr  &quot;0.0&quot; &quot;0.0&quot; &quot;0.0&quot; &quot;0.0&quot; ...
##  $ species        : chr  &quot;B&quot; &quot;B&quot; &quot;B&quot; &quot;B&quot; ...
##  $ id             : chr  &quot;253&quot; &quot;253&quot; &quot;253&quot; &quot;253&quot; ...
##  $ treatment      : chr  &quot;Open&quot; &quot;Open&quot; &quot;Open&quot; &quot;Open&quot; ...
##  $ hour           : chr  &quot;00&quot; &quot;00&quot; &quot;01&quot; &quot;01&quot; ...</code></pre>
<div class="sourceCode" id="cb620"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb620-1" title="1"><span class="co">#larrea only</span></a>
<a class="sourceLine" id="cb620-2" title="2"></a>
<a class="sourceLine" id="cb620-3" title="3">larrea &lt;-<span class="st"> </span><span class="kw">filter</span>(allLoggers, species <span class="op">==</span><span class="st"> &quot;L&quot;</span>)</a>
<a class="sourceLine" id="cb620-4" title="4">dailymax &lt;-<span class="st"> </span>larrea <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(treatment, Date, id) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarise</span>(<span class="dt">maxTemp =</span> <span class="kw">max</span>(temp))</a>
<a class="sourceLine" id="cb620-5" title="5"><span class="kw">ggplot</span>(<span class="dt">data =</span> dailymax, <span class="kw">aes</span>(Date, maxTemp, <span class="dt">color =</span> treatment)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() </a></code></pre></div>
<p><img src="index_files/figure-html/data%20loggers-1.png" width="672" /></p>
<div class="sourceCode" id="cb621"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb621-1" title="1">dailymin &lt;-<span class="st"> </span>larrea <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(treatment, Date, id) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarise</span>(<span class="dt">minTemp =</span> <span class="kw">min</span>(temp))</a>
<a class="sourceLine" id="cb621-2" title="2"><span class="kw">ggplot</span>(<span class="dt">data =</span> dailymin, <span class="kw">aes</span>(Date, minTemp, <span class="dt">color =</span> treatment)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() </a></code></pre></div>
<p><img src="index_files/figure-html/data%20loggers-2.png" width="672" /></p>
<div class="sourceCode" id="cb622"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb622-1" title="1">larrea<span class="op">$</span>temp &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(larrea<span class="op">$</span>temp)</a>
<a class="sourceLine" id="cb622-2" title="2">larrea<span class="op">$</span>hour &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(larrea<span class="op">$</span>hour)</a>
<a class="sourceLine" id="cb622-3" title="3">daytime &lt;-<span class="st"> </span><span class="kw">filter</span>(larrea, hour <span class="op">&gt;=</span><span class="st"> </span><span class="dv">9</span> <span class="op">&amp;</span><span class="st"> </span>hour<span class="op">&lt;</span><span class="dv">21</span>)</a>
<a class="sourceLine" id="cb622-4" title="4">daytime &lt;-<span class="st"> </span><span class="kw">na.omit</span>(daytime)</a>
<a class="sourceLine" id="cb622-5" title="5">nighttime &lt;-<span class="st"> </span><span class="kw">filter</span>(larrea, hour <span class="op">&gt;=</span><span class="dv">21</span> <span class="op">|</span><span class="st"> </span>hour<span class="op">&lt;</span><span class="dv">9</span>)</a>
<a class="sourceLine" id="cb622-6" title="6">nighttime &lt;-<span class="kw">na.omit</span>(nighttime)</a>
<a class="sourceLine" id="cb622-7" title="7">all &lt;-<span class="st"> </span>larrea <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(treatment, Date, id) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarise</span>(<span class="dt">meanTemp =</span> <span class="kw">mean</span>(temp), <span class="dt">varTemp =</span> <span class="kw">sd</span>(temp))</a>
<a class="sourceLine" id="cb622-8" title="8"></a>
<a class="sourceLine" id="cb622-9" title="9"></a>
<a class="sourceLine" id="cb622-10" title="10">meanday &lt;-<span class="st"> </span>daytime <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(treatment, Date, id) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarise</span>(<span class="dt">meanTemp =</span> <span class="kw">mean</span>(temp), <span class="dt">varTemp =</span> <span class="kw">sd</span>(temp))</a>
<a class="sourceLine" id="cb622-11" title="11"></a>
<a class="sourceLine" id="cb622-12" title="12">meannight&lt;-<span class="st"> </span>nighttime <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(treatment, Date, id) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarise</span>(<span class="dt">meanTemp =</span> <span class="kw">mean</span>(temp), <span class="dt">varTemp =</span> <span class="kw">sd</span>(temp))</a>
<a class="sourceLine" id="cb622-13" title="13"></a>
<a class="sourceLine" id="cb622-14" title="14"><span class="kw">str</span>(larrea)</a></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    40704 obs. of  8 variables:
##  $ Date           : chr  &quot;03/19/17&quot; &quot;03/19/17&quot; &quot;03/19/17&quot; &quot;03/19/17&quot; ...
##  $ time           : chr  &quot;00:27:13&quot; &quot;00:57:13&quot; &quot;01:27:13&quot; &quot;01:57:13&quot; ...
##  $ temp           : num  46.9 44.4 42.7 42.4 41.4 ...
##  $ light.intensity: chr  &quot;0.0&quot; &quot;0.0&quot; &quot;0.0&quot; &quot;0.0&quot; ...
##  $ species        : chr  &quot;L&quot; &quot;L&quot; &quot;L&quot; &quot;L&quot; ...
##  $ id             : chr  &quot;104&quot; &quot;104&quot; &quot;104&quot; &quot;104&quot; ...
##  $ treatment      : chr  &quot;Open&quot; &quot;Open&quot; &quot;Open&quot; &quot;Open&quot; ...
##  $ hour           : num  0 0 1 1 2 2 3 3 4 4 ...</code></pre>
<div class="sourceCode" id="cb624"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb624-1" title="1">larrea<span class="op">$</span>hour &lt;-<span class="st"> </span><span class="kw">as.factor</span>(larrea<span class="op">$</span>hour)</a>
<a class="sourceLine" id="cb624-2" title="2"></a>
<a class="sourceLine" id="cb624-3" title="3"><span class="co">#figure for all</span></a>
<a class="sourceLine" id="cb624-4" title="4"><span class="kw">ggplot</span>(<span class="dt">data =</span> larrea, <span class="kw">aes</span>(hour, ((temp<span class="dv">-32</span>)<span class="op">*</span><span class="fl">0.5556</span>))) <span class="op">+</span><span class="st"> </span><span class="kw">geom_boxplot</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> treatment)) <span class="op">+</span><span class="st"> </span><span class="kw">theme_Publication</span>() <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Hour&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Temperature in °C&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_manual</span>(<span class="dt">values=</span><span class="kw">c</span>(<span class="st">&quot;#AF955A&quot;</span>, <span class="st">&quot;darkgreen&quot;</span>), <span class="dt">name =</span> <span class="st">&quot;Microsite&quot;</span>)</a></code></pre></div>
<p><img src="index_files/figure-html/data%20loggers-3.png" width="672" /></p>
<div class="sourceCode" id="cb625"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb625-1" title="1">meannight<span class="op">$</span>treatment &lt;-<span class="st"> </span><span class="kw">as.factor</span>(meannight<span class="op">$</span>treatment)</a>
<a class="sourceLine" id="cb625-2" title="2"><span class="kw">kruskal.test</span>(meannight<span class="op">$</span>meanTemp <span class="op">~</span><span class="st"> </span>meannight<span class="op">$</span>treatment)</a></code></pre></div>
<pre><code>## 
##  Kruskal-Wallis rank sum test
## 
## data:  meannight$meanTemp by meannight$treatment
## Kruskal-Wallis chi-squared = 48.314, df = 1, p-value = 3.631e-12</code></pre>
<div class="sourceCode" id="cb627"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb627-1" title="1"><span class="kw">ggplot</span>(meannight, <span class="kw">aes</span>(meanTemp, <span class="dt">fill =</span> treatment)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_density</span>()       </a></code></pre></div>
<p><img src="index_files/figure-html/data%20loggers-4.png" width="672" /></p>
<div class="sourceCode" id="cb628"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb628-1" title="1"><span class="co">#mean nightime temps</span></a>
<a class="sourceLine" id="cb628-2" title="2">meannight<span class="op">$</span>id &lt;-<span class="st"> </span><span class="kw">as.factor</span>(meannight<span class="op">$</span>id)</a>
<a class="sourceLine" id="cb628-3" title="3">m1 &lt;-<span class="st"> </span><span class="kw">glmmTMB</span>(meanTemp <span class="op">~</span><span class="st"> </span>treatment <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>id), <span class="dt">family =</span> <span class="kw">Gamma</span>(<span class="dt">link =</span> <span class="st">&quot;log&quot;</span>), <span class="dt">data =</span> meannight)</a>
<a class="sourceLine" id="cb628-4" title="4"><span class="kw">shapiro.test</span>(<span class="kw">resid</span>(m1))</a></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  resid(m1)
## W = 0.98423, p-value = 6.447e-08</code></pre>
<div class="sourceCode" id="cb630"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb630-1" title="1"><span class="kw">summary</span>(m1)</a></code></pre></div>
<pre><code>##  Family: Gamma  ( log )
## Formula:          meanTemp ~ treatment + (1 | id)
## Data: meannight
## 
##      AIC      BIC   logLik deviance df.resid 
##   5635.6   5654.5  -2813.8   5627.6      844 
## 
## Random effects:
## 
## Conditional model:
##  Groups Name        Variance Std.Dev.
##  id     (Intercept) 0.001156 0.034   
## Number of obs: 848, groups:  id, 8
## 
## Dispersion estimate for Gamma family (sigma^2): 0.0149 
## 
## Conditional model:
##                Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)    3.968319   0.013402  296.09  &lt; 2e-16 ***
## treatmentShrub 0.059057   0.008383    7.05 1.85e-12 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb632"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb632-1" title="1">car<span class="op">::</span><span class="kw">Anova</span>(m1, <span class="dt">type =</span><span class="dv">2</span>)</a></code></pre></div>
<pre><code>## Analysis of Deviance Table (Type II Wald chisquare tests)
## 
## Response: meanTemp
##            Chisq Df Pr(&gt;Chisq)    
## treatment 49.635  1  1.852e-12 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb634"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb634-1" title="1"><span class="co">#mean daytime temps</span></a>
<a class="sourceLine" id="cb634-2" title="2">m2 &lt;-<span class="st"> </span><span class="kw">glmmTMB</span>(meanTemp <span class="op">~</span><span class="st"> </span>treatment <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>id), <span class="dt">family =</span> <span class="kw">Gamma</span>(<span class="dt">link =</span> <span class="st">&quot;log&quot;</span>), <span class="dt">data =</span> meanday)</a>
<a class="sourceLine" id="cb634-3" title="3"><span class="kw">summary</span>(m2)</a></code></pre></div>
<pre><code>##  Family: Gamma  ( log )
## Formula:          meanTemp ~ treatment + (1 | id)
## Data: meanday
## 
##      AIC      BIC   logLik deviance df.resid 
##   6235.0   6253.9  -3113.5   6227.0      844 
## 
## Random effects:
## 
## Conditional model:
##  Groups Name        Variance  Std.Dev.
##  id     (Intercept) 0.0003273 0.01809 
## Number of obs: 848, groups:  id, 8
## 
## Dispersion estimate for Gamma family (sigma^2): 0.0104 
## 
## Conditional model:
##                 Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)     4.563877   0.008092   564.0   &lt;2e-16 ***
## treatmentShrub -0.064621   0.007011    -9.2   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb636"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb636-1" title="1">car<span class="op">::</span><span class="kw">Anova</span>(m2, <span class="dt">type =</span><span class="dv">2</span>)</a></code></pre></div>
<pre><code>## Analysis of Deviance Table (Type II Wald chisquare tests)
## 
## Response: meanTemp
##            Chisq Df Pr(&gt;Chisq)    
## treatment 84.959  1  &lt; 2.2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb638"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb638-1" title="1">meanAll &lt;-<span class="st"> </span><span class="kw">rbind</span>(meanday, meannight)</a>
<a class="sourceLine" id="cb638-2" title="2"></a>
<a class="sourceLine" id="cb638-3" title="3"><span class="co">#overal temperature variation</span></a>
<a class="sourceLine" id="cb638-4" title="4">m3 &lt;-<span class="st"> </span><span class="kw">glmmTMB</span>(varTemp <span class="op">~</span><span class="st"> </span>treatment <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>id), <span class="dt">family =</span> <span class="kw">Gamma</span>(<span class="dt">link =</span> <span class="st">&quot;log&quot;</span>), <span class="dt">data =</span> all)</a>
<a class="sourceLine" id="cb638-5" title="5"><span class="kw">summary</span>(m3)</a></code></pre></div>
<pre><code>##  Family: Gamma  ( log )
## Formula:          varTemp ~ treatment + (1 | id)
## Data: all
## 
##      AIC      BIC   logLik deviance df.resid 
##   5063.6   5082.6  -2527.8   5055.6      844 
## 
## Random effects:
## 
## Conditional model:
##  Groups Name        Variance Std.Dev.
##  id     (Intercept) 0.003514 0.05927 
## Number of obs: 848, groups:  id, 8
## 
## Dispersion estimate for Gamma family (sigma^2): 0.0317 
## 
## Conditional model:
##                Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)     3.42565    0.02268   151.1   &lt;2e-16 ***
## treatmentShrub -0.27953    0.01226   -22.8   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb640"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb640-1" title="1">car<span class="op">::</span><span class="kw">Anova</span>(m3, <span class="dt">type =</span> <span class="dv">2</span>)</a></code></pre></div>
<pre><code>## Analysis of Deviance Table (Type II Wald chisquare tests)
## 
## Response: varTemp
##           Chisq Df Pr(&gt;Chisq)    
## treatment 519.9  1  &lt; 2.2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>#RII This code bootstraps 95% confidence intervals. Adapted from code written by Dr. Alex Filazzola <a href="https://github.com/afilazzola/CommEcolFunctions" class="uri">https://github.com/afilazzola/CommEcolFunctions</a></p>
<div class="sourceCode" id="cb642"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb642-1" title="1">rii.m &lt;-<span class="st"> </span><span class="cf">function</span>(x, j, var)</a>
<a class="sourceLine" id="cb642-2" title="2">{</a>
<a class="sourceLine" id="cb642-3" title="3">  <span class="co">#parse out shrub and open</span></a>
<a class="sourceLine" id="cb642-4" title="4">  s1 &lt;-<span class="st"> </span><span class="kw">subset</span>(x, treatment <span class="op">==</span><span class="st"> &quot;shrub&quot;</span>, <span class="dt">select=</span>var)</a>
<a class="sourceLine" id="cb642-5" title="5">  o1 &lt;-<span class="st"> </span><span class="kw">subset</span>(x, treatment <span class="op">==</span><span class="st"> &quot;open&quot;</span>, <span class="dt">select=</span>var)</a>
<a class="sourceLine" id="cb642-6" title="6">  return1 &lt;-<span class="st"> </span>(s1 <span class="op">-</span><span class="st"> </span>o1) <span class="op">/</span><span class="st"> </span>(s1<span class="op">+</span>o1)  <span class="co"># Rii formula</span></a>
<a class="sourceLine" id="cb642-7" title="7">  <span class="co"># attach factors</span></a>
<a class="sourceLine" id="cb642-8" title="8">  x1 &lt;-<span class="st"> </span>x[<span class="kw">seq</span>(<span class="dv">1</span>, <span class="kw">nrow</span>(x), <span class="dt">by =</span> <span class="dv">2</span>),]</a>
<a class="sourceLine" id="cb642-9" title="9">  return2 &lt;-<span class="st"> </span><span class="kw">cbind</span>(x1[j], return1)</a>
<a class="sourceLine" id="cb642-10" title="10">  return2[<span class="kw">is.na</span>(return2)] &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb642-11" title="11">  <span class="kw">print</span>(return2)</a>
<a class="sourceLine" id="cb642-12" title="12">}</a>
<a class="sourceLine" id="cb642-13" title="13"></a>
<a class="sourceLine" id="cb642-14" title="14">rii.b &lt;-<span class="st"> </span><span class="cf">function</span>(x, j, var)</a>
<a class="sourceLine" id="cb642-15" title="15">{</a>
<a class="sourceLine" id="cb642-16" title="16">  <span class="co">#parse out shrub and open</span></a>
<a class="sourceLine" id="cb642-17" title="17">  s1 &lt;-<span class="st"> </span><span class="kw">subset</span>(x, flowering <span class="op">==</span><span class="st"> &quot;bloom&quot;</span>, <span class="dt">select=</span>var)</a>
<a class="sourceLine" id="cb642-18" title="18">  o1 &lt;-<span class="st"> </span><span class="kw">subset</span>(x, flowering <span class="op">==</span><span class="st"> &quot;pre&quot;</span>, <span class="dt">select=</span>var)</a>
<a class="sourceLine" id="cb642-19" title="19">  return1 &lt;-<span class="st"> </span>(s1 <span class="op">-</span><span class="st"> </span>o1) <span class="op">/</span><span class="st"> </span>(s1<span class="op">+</span>o1)  <span class="co"># Rii formula</span></a>
<a class="sourceLine" id="cb642-20" title="20">  <span class="co"># attach factors</span></a>
<a class="sourceLine" id="cb642-21" title="21">  x1 &lt;-<span class="st"> </span>x[<span class="kw">seq</span>(<span class="dv">1</span>, <span class="kw">nrow</span>(x), <span class="dt">by =</span> <span class="dv">2</span>),]</a>
<a class="sourceLine" id="cb642-22" title="22">  return2 &lt;-<span class="st"> </span><span class="kw">cbind</span>(x1[j], return1)</a>
<a class="sourceLine" id="cb642-23" title="23">  return2[<span class="kw">is.na</span>(return2)] &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb642-24" title="24">  <span class="kw">print</span>(return2)</a>
<a class="sourceLine" id="cb642-25" title="25">}</a>
<a class="sourceLine" id="cb642-26" title="26">bootmean &lt;-<span class="st"> </span><span class="cf">function</span>(d, i) <span class="kw">mean</span>(d[i])</a>
<a class="sourceLine" id="cb642-27" title="27"></a>
<a class="sourceLine" id="cb642-28" title="28">byrep &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;Output Data/byrep_cleaned.csv&quot;</span>)</a>
<a class="sourceLine" id="cb642-29" title="29">metadata &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;Output Data/metadata_nobeetle.csv&quot;</span>)</a>
<a class="sourceLine" id="cb642-30" title="30">yesbeetle &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;Output Data/metadata_yesbeetle.csv&quot;</span>)</a>
<a class="sourceLine" id="cb642-31" title="31">pre &lt;-<span class="st"> </span><span class="kw">filter</span>(byrep, flowering <span class="op">==</span><span class="st"> &quot;pre&quot;</span>)</a>
<a class="sourceLine" id="cb642-32" title="32">pre &lt;-<span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(pre, Date, mean.Solar, mean.Wind, mean.Temp, PlantID, treatment, flowering, understory.richness, visits.per.hour, flowers.per.hour)</a>
<a class="sourceLine" id="cb642-33" title="33"><span class="co">#split into 2 dataframes, rename the visitation columns and then rbind</span></a>
<a class="sourceLine" id="cb642-34" title="34"><span class="co">#there are 2 unmatched reps</span></a>
<a class="sourceLine" id="cb642-35" title="35">pre &lt;-<span class="st"> </span><span class="kw">arrange</span>(pre, PlantID)</a>
<a class="sourceLine" id="cb642-36" title="36">pre &lt;-<span class="st"> </span><span class="kw">filter</span>(pre, PlantID <span class="op">!=</span><span class="st"> </span><span class="dv">266</span> <span class="op">&amp;</span><span class="st"> </span>PlantID <span class="op">!=</span><span class="st"> </span><span class="dv">275</span> <span class="op">&amp;</span><span class="st"> </span>PlantID <span class="op">!=</span><span class="st"> </span><span class="dv">276</span> <span class="op">&amp;</span><span class="st"> </span>PlantID <span class="op">!=</span><span class="st"> </span><span class="dv">196</span>)</a>
<a class="sourceLine" id="cb642-37" title="37">pre.visits &lt;-<span class="st"> </span><span class="kw">rii.m</span>(pre, <span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">7</span>), <span class="dv">8</span><span class="op">:</span><span class="dv">10</span>)</a></code></pre></div>
<pre><code>##          Date mean.Solar mean.Wind mean.Temp PlantID treatment flowering
## 1   4.20.2017  0.7987500  6.125000  17.86250     104      open       pre
## 3   4.19.2017  0.7762500  6.025000  17.90000     114      open       pre
## 5   4.10.2017  0.7625000  5.150000  18.35000     146      open       pre
## 7   4.13.2017  0.7600000  6.112500  18.56250     180      open       pre
## 9   4.19.2017  0.7762500  6.025000  17.90000     181      open       pre
## 11  4.16.2017  0.7387500  5.175000  18.75000     182      open       pre
## 13  4.19.2017  0.7762500  6.025000  17.90000     183      open       pre
## 15  4.14.2017  0.7671429  6.242857  15.88571     184      open       pre
## 17  4.16.2017  0.7387500  5.175000  18.75000     185      open       pre
## 19  4.13.2017  0.7600000  6.112500  18.56250     186      open       pre
## 21  4.10.2017  0.7625000  5.150000  18.35000     187      open       pre
## 23  4.14.2017  0.7671429  6.242857  15.88571     188      open       pre
## 25  4.12.2017  0.7587500  6.662500  18.61250     189      open       pre
## 27  4.12.2017  0.7587500  6.662500  18.61250     190      open       pre
## 29  4.11.2017  0.6100000  6.325000  18.57500     191      open       pre
## 31  4.13.2017  0.7600000  6.112500  18.56250     192      open       pre
## 33  4.10.2017  0.7625000  5.150000  18.35000     193      open       pre
## 35  4.11.2017  0.6100000  6.325000  18.57500     194      open       pre
## 37  4.14.2017  0.7671429  6.242857  15.88571     195      open       pre
## 39  4.14.2017  0.7671429  6.242857  15.88571     197      open       pre
## 41  4.19.2017  0.7762500  6.025000  17.90000     198      open       pre
## 43  4.13.2017  0.7600000  6.112500  18.56250     199      open       pre
## 45  4.20.2017  0.7987500  6.125000  17.86250     261      open       pre
## 47  4.13.2017  0.7600000  6.112500  18.56250     262      open       pre
## 49  4.12.2017  0.7587500  6.662500  18.61250     263      open       pre
## 51  4.16.2017  0.7387500  5.175000  18.75000     264      open       pre
## 53  4.11.2017  0.6100000  6.325000  18.57500     265      open       pre
## 55  4.14.2017  0.7671429  6.242857  15.88571     268      open       pre
## 57  4.14.2017  0.7671429  6.242857  15.88571     269      open       pre
## 59  4.18.2017  0.6685714  6.014286  16.25714     270      open       pre
## 61  4.18.2017  0.6685714  6.014286  16.25714     271      open       pre
## 63  4.12.2017  0.7587500  6.662500  18.61250     272      open       pre
## 65  4.10.2017  0.7625000  5.150000  18.35000     273      open       pre
## 67  4.19.2017  0.7762500  6.025000  17.90000     274      open       pre
## 69  4.15.2017  0.7687500  5.175000  18.50000     278      open       pre
## 71  4.15.2017  0.7687500  5.175000  18.50000     280      open       pre
## 73  4.19.2017  0.7762500  6.025000  17.90000     281      open       pre
## 75  4.15.2017  0.7687500  5.175000  18.50000     282      open       pre
## 77  4.18.2017  0.6685714  6.014286  16.25714     283      open       pre
## 79  4.20.2017  0.7987500  6.125000  17.86250     285      open       pre
## 81  4.16.2017  0.7387500  5.175000  18.75000     286      open       pre
## 83  4.10.2017  0.7625000  5.150000  18.35000     288      open       pre
## 85  4.11.2017  0.6100000  6.325000  18.57500     289      open       pre
## 87  4.18.2017  0.6685714  6.014286  16.25714     290      open       pre
## 89  4.16.2017  0.7387500  5.175000  18.75000     291      open       pre
## 91  4.12.2017  0.7587500  6.662500  18.61250     293      open       pre
## 93  4.15.2017  0.7687500  5.175000  18.50000     294      open       pre
## 95  4.15.2017  0.7687500  5.175000  18.50000     295      open       pre
## 97  4.12.2017  0.7587500  6.662500  18.61250     296      open       pre
## 99  4.18.2017  0.6685714  6.014286  16.25714     297      open       pre
## 101 4.18.2017  0.6685714  6.014286  16.25714     298      open       pre
## 103 4.15.2017  0.7687500  5.175000  18.50000     299      open       pre
## 105 4.13.2017  0.7600000  6.112500  18.56250     300      open       pre
## 107 4.20.2017  0.7987500  6.125000  17.86250     301      open       pre
## 109 4.20.2017  0.7987500  6.125000  17.86250     302      open       pre
## 111 4.20.2017  0.7987500  6.125000  17.86250     303      open       pre
##     understory.richness visits.per.hour flowers.per.hour
## 1            -0.2000000      0.00000000       0.00000000
## 3             0.3333333     -0.32327375      -0.43086291
## 5            -0.2500000     -0.53995650      -0.64828245
## 7             0.1428571     -0.49268367      -0.37631269
## 9             0.2000000      0.09979235       0.09979235
## 11            0.2000000      0.09080377       0.41167651
## 13            0.0000000      1.00000000       1.00000000
## 15            0.2000000      1.00000000       1.00000000
## 17            0.0000000     -0.84112430      -0.84112430
## 19            0.0000000     -0.39470508      -0.44954263
## 21            0.0000000     -0.24053372      -0.39150535
## 23            0.0000000     -0.42573377      -0.53599233
## 25            0.3333333      0.07970170      -0.04068744
## 27            0.1428571     -0.01510029       0.07591301
## 29            0.3333333     -0.13339954      -0.32473562
## 31           -0.2000000     -0.85854322      -0.87413790
## 33            0.1428571     -0.53661648      -0.60419442
## 35            0.2000000     -0.16648570       0.02088555
## 37            0.2000000      0.06795422       0.06795422
## 39           -0.5000000      1.00000000       1.00000000
## 41           -0.1428571     -0.04021855      -0.04021855
## 43           -0.3333333      0.47209055       0.63381000
## 45            0.3333333      1.00000000       1.00000000
## 47           -0.2000000     -0.19191919      -0.19191919
## 49            0.0000000     -0.58408139      -0.70206837
## 51            0.3333333     -0.24078953      -0.15323474
## 53            0.0000000      0.36856445       0.31660500
## 55           -0.2000000     -0.86015705      -0.92754546
## 57            0.0000000     -0.46210327      -0.46210327
## 59            0.2000000      0.41789617       0.41789617
## 61            0.2000000     -0.06500618      -0.06500618
## 63            0.2000000     -0.38523645      -0.16953939
## 65            0.2000000     -0.49155244      -0.62027508
## 67            0.2000000      0.59512283       0.59512283
## 69            0.0000000      0.06763726       0.06763726
## 71           -0.2000000     -0.69652598      -0.38197977
## 73            0.0000000     -1.00000000      -1.00000000
## 75            0.2000000     -0.09849443      -0.09849443
## 77            0.3333333      0.21679413       0.21679413
## 79           -0.2000000      1.00000000       1.00000000
## 81           -0.3333333     -0.75099206      -0.75099206
## 83            0.0000000     -0.39427116      -0.39427116
## 85            0.4285714      1.00000000       1.00000000
## 87            0.0000000      0.00000000       0.00000000
## 89            0.0000000     -0.01779812      -0.01779812
## 91           -0.1428571     -1.00000000      -1.00000000
## 93            0.0000000      0.16324168       0.02087126
## 95            0.3333333      0.41225952       0.41225952
## 97            0.5000000      0.39944808       0.13930504
## 99           -0.5000000     -1.00000000      -1.00000000
## 101           0.0000000      0.00000000       0.00000000
## 103          -0.2000000      0.11282376      -0.16497997
## 105           0.0000000      0.06278348       0.06278348
## 107          -0.2000000     -1.00000000      -1.00000000
## 109           0.0000000      0.56896852       0.56896852
## 111           0.3333333     -0.33248225      -0.33248225</code></pre>
<div class="sourceCode" id="cb644"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb644-1" title="1">post &lt;-<span class="st"> </span><span class="kw">filter</span>(byrep, flowering <span class="op">==</span><span class="st">&quot;bloom&quot;</span>)</a>
<a class="sourceLine" id="cb644-2" title="2">post &lt;-<span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(post, Date, mean.Solar, mean.Wind, mean.Temp, PlantID, treatment, flowering, understory.richness, visits.per.hour, flowers.per.hour)</a>
<a class="sourceLine" id="cb644-3" title="3">post &lt;-<span class="st"> </span><span class="kw">arrange</span>(post, PlantID)</a>
<a class="sourceLine" id="cb644-4" title="4">post &lt;-<span class="st"> </span><span class="kw">filter</span>(post, PlantID <span class="op">!=</span><span class="st"> </span><span class="dv">198</span>)</a>
<a class="sourceLine" id="cb644-5" title="5">post &lt;-<span class="st"> </span><span class="kw">distinct</span>(post)</a>
<a class="sourceLine" id="cb644-6" title="6">post.visits &lt;-<span class="st"> </span><span class="kw">rii.m</span>(post, <span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">7</span>), <span class="dv">8</span><span class="op">:</span><span class="dv">10</span>)</a></code></pre></div>
<pre><code>##          Date mean.Solar mean.Wind mean.Temp PlantID treatment flowering
## 1   4.27.2017  0.6600000  4.125000  17.36250     104      open     bloom
## 3   4.26.2017  0.6562500  5.187500  17.40000     114      open     bloom
## 5   4.22.2017  0.7737500  5.425000  17.20000     146      open     bloom
## 7   4.21.2017  0.7728571  7.128571  15.92857     180      open     bloom
## 9   4.27.2017  0.6600000  4.125000  17.36250     181      open     bloom
## 11  4.21.2017  0.7728571  7.128571  15.92857     182      open     bloom
## 13  4.30.2017  0.8087500  4.787500  17.52500     183      open     bloom
## 15  4.29.2017  0.8125000  5.000000  17.26250     184      open     bloom
## 17   5.2.2017  0.7971429  6.200000  16.20000     185      open     bloom
## 19  4.27.2017  0.6600000  4.125000  17.36250     186      open     bloom
## 21  4.30.2017  0.8087500  4.787500  17.52500     187      open     bloom
## 23  4.25.2017  0.7142857  5.985714  16.41429     188      open     bloom
## 25  4.21.2017  0.7728571  7.128571  15.92857     189     shrub     bloom
## 27  4.26.2017  0.6562500  5.187500  17.40000     190      open     bloom
## 29  4.29.2017  0.8125000  5.000000  17.26250     191      open     bloom
## 31  4.23.2017  0.7775000  4.575000  17.16250     192      open     bloom
## 33   5.2.2017  0.7971429  6.200000  16.20000     193      open     bloom
## 35  4.21.2017  0.7728571  7.128571  15.92857     194      open     bloom
## 37  4.22.2017  0.7737500  5.425000  17.20000     195      open     bloom
## 39  4.23.2017  0.7775000  4.575000  17.16250     196      open     bloom
## 41  4.22.2017  0.7737500  5.425000  17.20000     197      open     bloom
## 43  4.29.2017  0.8125000  5.000000  17.26250     199      open     bloom
## 45   5.1.2017  0.8025000  5.137500  17.43750     261      open     bloom
## 47  4.25.2017  0.7142857  5.985714  16.41429     262      open     bloom
## 49  4.30.2017  0.8087500  4.787500  17.52500     263      open     bloom
## 51  4.23.2017  0.7775000  4.575000  17.16250     264      open     bloom
## 53  4.27.2017  0.6600000  4.125000  17.36250     265      open     bloom
## 55  4.22.2017  0.7737500  5.425000  17.20000     266      open     bloom
## 57  4.27.2017  0.6600000  4.125000  17.36250     268      open     bloom
## 59  4.26.2017  0.6562500  5.187500  17.40000     269      open     bloom
## 61  4.26.2017  0.6562500  5.187500  17.40000     270      open     bloom
## 63  4.29.2017  0.8125000  5.000000  17.26250     271      open     bloom
## 65  4.27.2017  0.6600000  4.125000  17.36250     272      open     bloom
## 67   5.1.2017  0.8025000  5.137500  17.43750     273      open     bloom
## 69  4.30.2017  0.8087500  4.787500  17.52500     274      open     bloom
## 71  4.21.2017  0.7728571  7.128571  15.92857     275     shrub     bloom
## 73  4.21.2017  0.7728571  7.128571  15.92857     276     shrub     bloom
## 75  4.29.2017  0.8125000  5.000000  17.26250     278      open     bloom
## 77   5.1.2017  0.8025000  5.137500  17.43750     280      open     bloom
## 79   5.2.2017  0.7971429  6.200000  16.20000     281      open     bloom
## 81  4.25.2017  0.7142857  5.985714  16.41429     282      open     bloom
## 83   5.1.2017  0.8025000  5.137500  17.43750     283      open     bloom
## 85  4.30.2017  0.8087500  4.787500  17.52500     285      open     bloom
## 87  4.26.2017  0.6562500  5.187500  17.40000     286      open     bloom
## 89  4.26.2017  0.6562500  5.187500  17.40000     288      open     bloom
## 91  4.22.2017  0.7737500  5.425000  17.20000     289      open     bloom
## 93  4.30.2017  0.8087500  4.787500  17.52500     290      open     bloom
## 95   5.1.2017  0.8025000  5.137500  17.43750     291      open     bloom
## 97  4.25.2017  0.7142857  5.985714  16.41429     293      open     bloom
## 99  4.25.2017  0.7142857  5.985714  16.41429     294      open     bloom
## 101 4.23.2017  0.7775000  4.575000  17.16250     295      open     bloom
## 103 4.29.2017  0.8125000  5.000000  17.26250     296      open     bloom
## 105 4.25.2017  0.7142857  5.985714  16.41429     297      open     bloom
## 107 4.23.2017  0.7775000  4.575000  17.16250     298      open     bloom
## 109  5.2.2017  0.7971429  6.200000  16.20000     300      open     bloom
## 111 4.23.2017  0.7775000  4.575000  17.16250     301      open     bloom
## 113  5.2.2017  0.7971429  6.200000  16.20000     302      open     bloom
## 115 4.22.2017  0.7737500  5.425000  17.20000    new1      open     bloom
##     understory.richness visits.per.hour flowers.per.hour
## 1             0.0000000    -0.172437578     -0.114778289
## 3             0.0000000     0.350885157      0.350885157
## 5             0.0000000    -1.000000000     -1.000000000
## 7            -0.5000000    -0.073640483     -0.317789932
## 9             0.0000000     0.640607950      0.678306066
## 11            0.0000000     0.177209078      0.282752815
## 13            0.0000000    -0.388557468     -0.388557468
## 15            0.0000000    -1.000000000     -1.000000000
## 17            0.0000000     1.000000000      1.000000000
## 19            0.5000000     1.000000000      1.000000000
## 21            0.3333333    -0.773864865     -0.898115853
## 23            0.0000000     0.000000000      0.000000000
## 25            0.0000000     0.000000000      0.000000000
## 27            0.0000000     0.000000000      0.000000000
## 29            0.3333333    -1.000000000     -1.000000000
## 31           -0.2000000    -0.651570028     -0.519233414
## 33            0.2000000    -1.000000000     -1.000000000
## 35            0.0000000     0.000000000      0.000000000
## 37            0.2000000     0.466625175      0.466625175
## 39            0.2000000     0.423433376      0.470536847
## 41            0.0000000     0.008340693      0.008340693
## 43            0.0000000    -1.000000000     -1.000000000
## 45           -0.3333333     0.000000000      0.000000000
## 47            0.0000000     1.000000000      1.000000000
## 49           -0.3333333    -0.524814831     -0.621105492
## 51            0.0000000     0.021329726     -0.314237809
## 53            0.5000000     0.000000000      0.000000000
## 55            0.0000000     0.409843861      0.522130709
## 57            0.0000000    -1.000000000     -1.000000000
## 59            0.0000000    -1.000000000     -1.000000000
## 61            0.0000000    -1.000000000     -1.000000000
## 63            0.3333333    -0.317255435     -0.317255435
## 65            0.2000000     1.000000000      1.000000000
## 67            0.2000000     1.000000000      1.000000000
## 69            0.2000000     0.320395119      0.320395119
## 71            0.5000000     0.573656595      0.297142516
## 73            0.3333333    -0.736976563     -0.808321192
## 75            0.2000000     0.000000000      0.000000000
## 77           -0.2000000    -0.423767301     -0.423767301
## 79           -0.5000000    -0.476598960     -0.718805592
## 81            0.0000000     0.000000000      0.000000000
## 83            0.0000000     0.000000000      0.000000000
## 85           -0.2000000     0.295025406      0.295025406
## 87            0.3333333    -1.000000000     -1.000000000
## 89           -0.2000000    -1.000000000     -1.000000000
## 91           -0.5000000    -1.000000000     -1.000000000
## 93            0.0000000    -0.174879890     -0.537295050
## 95            0.0000000     1.000000000      1.000000000
## 97            0.2000000    -1.000000000     -1.000000000
## 99            0.2000000    -1.000000000     -1.000000000
## 101          -0.2000000    -0.255797854     -0.255797854
## 103          -0.2000000     1.000000000      1.000000000
## 105           0.3333333     0.000000000      0.000000000
## 107          -0.2000000     0.226579594      0.392238985
## 109           0.2000000    -1.000000000     -1.000000000
## 111           0.0000000    -1.000000000     -1.000000000
## 113          -0.2000000     1.000000000      1.000000000
## 115           0.0000000    -0.063314857      0.138438182</code></pre>
<div class="sourceCode" id="cb646"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb646-1" title="1">rii.visits &lt;-<span class="st"> </span><span class="kw">rbind</span>(pre.visits, post.visits)</a>
<a class="sourceLine" id="cb646-2" title="2"></a>
<a class="sourceLine" id="cb646-3" title="3"></a>
<a class="sourceLine" id="cb646-4" title="4"></a>
<a class="sourceLine" id="cb646-5" title="5"><span class="co">#from melyridae excluded pan traps</span></a>
<a class="sourceLine" id="cb646-6" title="6"></a>
<a class="sourceLine" id="cb646-7" title="7">prepan &lt;-<span class="st"> </span><span class="kw">filter</span>(metadata, blooming <span class="op">==</span><span class="st"> &quot;pre&quot;</span>)</a>
<a class="sourceLine" id="cb646-8" title="8">prepan &lt;-<span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(prepan, date, mean.Solar, mean.Wind, mean.Temp, plant.id, treatment, blooming, abun, percent.cover)</a>
<a class="sourceLine" id="cb646-9" title="9"><span class="co">#split into 2 dataframes, rename the visitation columns and then rbind</span></a>
<a class="sourceLine" id="cb646-10" title="10"><span class="co">#there are 2 unmatched reps</span></a>
<a class="sourceLine" id="cb646-11" title="11">prepan &lt;-<span class="st"> </span><span class="kw">arrange</span>(prepan, plant.id)</a>
<a class="sourceLine" id="cb646-12" title="12"></a>
<a class="sourceLine" id="cb646-13" title="13"><span class="co">#prepan &lt;- filter(prepan, plant.id != 266 &amp; plant.id != 275 &amp; plant.id != 276 &amp; plant.id != 196)</span></a>
<a class="sourceLine" id="cb646-14" title="14"></a>
<a class="sourceLine" id="cb646-15" title="15">pre.pan &lt;-<span class="st"> </span><span class="kw">rii.m</span>(prepan, <span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">7</span>), <span class="dv">8</span><span class="op">:</span><span class="dv">9</span>)</a></code></pre></div>
<pre><code>##          date mean.Solar mean.Wind mean.Temp plant.id treatment blooming
## 1   4.16.2017    0.73875    5.1750   18.7500      146      open      pre
## 3   4.12.2017    0.75875    6.6625   18.6125      180      open      pre
## 5   4.20.2017    0.79875    6.1250   17.8625      181      open      pre
## 7   4.20.2017    0.79875    6.1250   17.8625      183      open      pre
## 9   4.10.2017    0.76250    5.1500   18.3500      184      open      pre
## 11  4.20.2017    0.79875    6.1250   17.8625      185      open      pre
## 13  4.15.2017    0.76875    5.1750   18.5000      186      open      pre
## 15  4.11.2017    0.61000    6.3250   18.5750      187      open      pre
## 17  4.16.2017    0.73875    5.1750   18.7500      188      open      pre
## 19  4.10.2017    0.76250    5.1500   18.3500      189      open      pre
## 21  4.13.2017    0.76000    6.1125   18.5625      190      open      pre
## 23  4.12.2017    0.75875    6.6625   18.6125      191      open      pre
## 25  4.10.2017    0.76250    5.1500   18.3500      192      open      pre
## 27  4.11.2017    0.61000    6.3250   18.5750      193      open      pre
## 29  4.10.2017    0.76250    5.1500   18.3500      194      open      pre
## 31  4.16.2017    0.73875    5.1750   18.7500      195      open      pre
## 33  4.12.2017    0.75875    6.6625   18.6125      196      open      pre
## 35  4.11.2017    0.61000    6.3250   18.5750      197      open      pre
## 37  4.12.2017    0.75875    6.6625   18.6125      198      open      pre
## 39  4.15.2017    0.76875    5.1750   18.5000      199      open      pre
## 41  4.15.2017    0.76875    5.1750   18.5000      262      open      pre
## 43  4.19.2017    0.77625    6.0250   17.9000      264      open      pre
## 45  4.12.2017    0.75875    6.6625   18.6125      265      open      pre
## 47  4.11.2017    0.61000    6.3250   18.5750      266      open      pre
## 49  4.13.2017    0.76000    6.1125   18.5625      267      open      pre
## 51  4.16.2017    0.73875    5.1750   18.7500      268      open      pre
## 53  4.15.2017    0.76875    5.1750   18.5000      269      open      pre
## 55  4.19.2017    0.77625    6.0250   17.9000      270      open      pre
## 57  4.16.2017    0.73875    5.1750   18.7500      271      open      pre
## 59  4.13.2017    0.76000    6.1125   18.5625      272      open      pre
## 61  4.11.2017    0.61000    6.3250   18.5750      273      open      pre
## 63  4.20.2017    0.79875    6.1250   17.8625      274      open      pre
## 65  4.10.2017    0.76250    5.1500   18.3500      275      open      pre
## 67  4.15.2017    0.76875    5.1750   18.5000      276      open      pre
## 69  4.17.2017    0.57375    5.5375   18.4125      278      open      pre
## 71  4.17.2017    0.57375    5.5375   18.4125      280      open      pre
## 73  4.20.2017    0.79875    6.1250   17.8625      281      open      pre
## 75  4.17.2017    0.57375    5.5375   18.4125      282      open      pre
## 77  4.19.2017    0.77625    6.0250   17.9000      283      open      pre
## 79  4.13.2017    0.76000    6.1125   18.5625      284      open      pre
## 81  4.19.2017    0.77625    6.0250   17.9000      286      open      pre
## 83  4.20.2017    0.79875    6.1250   17.8625      287      open      pre
## 85  4.11.2017    0.61000    6.3250   18.5750      288      open      pre
## 87  4.12.2017    0.75875    6.6625   18.6125      289      open      pre
## 89  4.19.2017    0.77625    6.0250   17.9000      290      open      pre
## 91  4.17.2017    0.57375    5.5375   18.4125      291      open      pre
## 93  4.13.2017    0.76000    6.1125   18.5625      293      open      pre
## 95  4.13.2017    0.76000    6.1125   18.5625      294      open      pre
## 97  4.17.2017    0.57375    5.5375   18.4125      295      open      pre
## 99  4.10.2017    0.76250    5.1500   18.3500      296      open      pre
## 101 4.19.2017    0.77625    6.0250   17.9000      297      open      pre
## 103 4.16.2017    0.73875    5.1750   18.7500      298      open      pre
## 105 4.17.2017    0.57375    5.5375   18.4125      299      open      pre
## 107 4.15.2017    0.76875    5.1750   18.5000      300      open      pre
##            abun percent.cover
## 1   -0.40000000     0.1428571
## 3   -0.08108108     0.7142857
## 5   -0.38461538     0.8918919
## 7    0.04761905     0.7500000
## 9    0.07692308     0.7500000
## 11   0.20000000     0.7333333
## 13   0.71428571     0.4285714
## 15   0.04347826     0.8181818
## 17   0.42857143     0.9718310
## 19  -0.05882353     0.8518519
## 21  -0.08571429     0.7777778
## 23   0.12000000     0.9047619
## 25   0.17647059     0.4545455
## 27   0.25000000     0.9444444
## 29  -0.08333333     0.8604651
## 31  -0.04347826     0.8181818
## 33  -0.08333333     0.8750000
## 35  -0.23809524     0.7777778
## 37   0.48148148     0.8181818
## 39   0.02325581     0.1578947
## 41   0.48717949     0.5555556
## 43   0.36842105     0.6363636
## 45   0.41176471     0.6666667
## 47   0.03225806     0.8750000
## 49   0.33333333     0.9047619
## 51   0.10000000     0.9230769
## 53   0.25000000     0.6923077
## 55   0.17647059     0.8518519
## 57   0.76470588     0.9230769
## 59   0.29411765     0.6666667
## 61   0.25000000     0.6000000
## 63   0.42857143     0.6000000
## 65   1.00000000     0.8181818
## 67   0.11111111     0.4285714
## 69   0.70000000    -0.2000000
## 71   0.46666667     0.5555556
## 73  -0.33333333     0.8750000
## 75   0.00000000    -0.1111111
## 77   0.42857143     0.7142857
## 79  -0.17647059     0.8750000
## 81   0.25000000     0.8750000
## 83  -0.06666667     0.8181818
## 85   0.42105263     0.9230769
## 87   0.04000000     0.9230769
## 89   0.37500000     0.6000000
## 91   0.21428571     0.9444444
## 93   0.35483871     0.6000000
## 95   0.47826087     0.9230769
## 97   0.30000000     0.7777778
## 99   0.04000000     0.6666667
## 101  0.00000000     0.8918919
## 103  0.45454545     0.4285714
## 105  0.33333333     0.2000000
## 107  0.05263158     0.8518519</code></pre>
<div class="sourceCode" id="cb648"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb648-1" title="1">postpan &lt;-<span class="st"> </span><span class="kw">filter</span>(metadata, blooming <span class="op">==</span><span class="st">&quot;post&quot;</span>)</a>
<a class="sourceLine" id="cb648-2" title="2">postpan &lt;-<span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(postpan, date, mean.Solar, mean.Wind, mean.Temp, plant.id, treatment, blooming, abun, percent.cover)</a>
<a class="sourceLine" id="cb648-3" title="3">postpan &lt;-<span class="st"> </span><span class="kw">arrange</span>(postpan, plant.id)</a>
<a class="sourceLine" id="cb648-4" title="4"><span class="co">#postpan &lt;- filter(post, PlantID != 198)</span></a>
<a class="sourceLine" id="cb648-5" title="5"><span class="co">#postpan &lt;- distinct(postpan)</span></a>
<a class="sourceLine" id="cb648-6" title="6">post.pan &lt;-<span class="st"> </span><span class="kw">rii.m</span>(postpan, <span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">7</span>), <span class="dv">8</span><span class="op">:</span><span class="dv">9</span>)</a></code></pre></div>
<pre><code>##          date mean.Solar mean.Wind mean.Temp plant.id treatment blooming
## 1   4.30.2017    0.80875    4.7875   17.5250      104      open     post
## 3   4.29.2017    0.81250    5.0000   17.2625      114      open     post
## 5   4.23.2017    0.77750    4.5750   17.1625      146      open     post
## 7   4.22.2017    0.77375    5.4250   17.2000      180      open     post
## 9   4.30.2017    0.80875    4.7875   17.5250      181      open     post
## 11  4.22.2017    0.77375    5.4250   17.2000      182      open     post
## 13   5.3.2017    0.78625    4.4750   17.5500      183      open     post
## 15   5.1.2017    0.80250    5.1375   17.4375      184      open     post
## 17   5.5.2017    0.66625    3.5250   28.5125      185      open     post
## 19  4.30.2017    0.80875    4.7875   17.5250      186      open     post
## 21   5.3.2017    0.78625    4.4750   17.5500      187      open     post
## 23  4.27.2017    0.66000    4.1250   17.3625      188      open     post
## 25  4.22.2017    0.77375    5.4250   17.2000      189      open     post
## 27  4.29.2017    0.81250    5.0000   17.2625      190      open     post
## 29   5.1.2017    0.80250    5.1375   17.4375      191      open     post
## 31  4.26.2017    0.65625    5.1875   17.4000      192      open     post
## 33   5.5.2017    0.66625    3.5250   28.5125      193      open     post
## 35  4.22.2017    0.77375    5.4250   17.2000      194      open     post
## 37  4.23.2017    0.77750    4.5750   17.1625      195      open     post
## 39  4.26.2017    0.65625    5.1875   17.4000      196      open     post
## 41  4.23.2017    0.77750    4.5750   17.1625      197      open     post
## 43   5.4.2017    0.80500    5.0625   17.7875      198      open     post
## 45   5.1.2017    0.80250    5.1375   17.4375      199      open     post
## 47   5.4.2017    0.80500    5.0625   17.7875      261      open     post
## 49  4.27.2017    0.66000    4.1250   17.3625      262      open     post
## 51   5.3.2017    0.78625    4.4750   17.5500      263      open     post
## 53  4.26.2017    0.65625    5.1875   17.4000      264      open     post
## 55  4.30.2017    0.80875    4.7875   17.5250      265      open     post
## 57  4.23.2017    0.77750    4.5750   17.1625      266      open     post
## 59  4.23.2017    0.77750    4.5750   17.1625      267      open     post
## 61  4.30.2017    0.80875    4.7875   17.5250      268      open     post
## 63  4.29.2017    0.81250    5.0000   17.2625      269      open     post
## 65  4.29.2017    0.81250    5.0000   17.2625      270      open     post
## 67   5.1.2017    0.80250    5.1375   17.4375      271      open     post
## 69  4.30.2017    0.80875    4.7875   17.5250      272      open     post
## 71   5.4.2017    0.80500    5.0625   17.7875      273      open     post
## 73   5.3.2017    0.78625    4.4750   17.5500      274      open     post
## 75  4.22.2017    0.77375    5.4250   17.2000      275      open     post
## 77  4.22.2017    0.77375    5.4250   17.2000      276      open     post
## 79   5.1.2017    0.80250    5.1375   17.4375      278      open     post
## 81   5.4.2017    0.80500    5.0625   17.7875      280      open     post
## 83   5.5.2017    0.66625    3.5250   28.5125      281      open     post
## 85  4.27.2017    0.66000    4.1250   17.3625      282      open     post
## 87   5.4.2017    0.80500    5.0625   17.7875      283      open     post
## 89   5.3.2017    0.78625    4.4750   17.5500      285      open     post
## 91  4.29.2017    0.81250    5.0000   17.2625      286      open     post
## 93  4.29.2017    0.81250    5.0000   17.2625      288      open     post
## 95  4.23.2017    0.77750    4.5750   17.1625      289      open     post
## 97   5.3.2017    0.78625    4.4750   17.5500      290      open     post
## 99   5.4.2017    0.80500    5.0625   17.7875      291      open     post
## 101 4.27.2017    0.66000    4.1250   17.3625      293      open     post
## 103 4.27.2017    0.66000    4.1250   17.3625      294      open     post
## 105 4.26.2017    0.65625    5.1875   17.4000      295      open     post
## 107  5.1.2017    0.80250    5.1375   17.4375      296      open     post
## 109 4.27.2017    0.66000    4.1250   17.3625      297      open     post
## 111 4.26.2017    0.65625    5.1875   17.4000      298      open     post
## 113  5.5.2017    0.66625    3.5250   28.5125      300      open     post
## 115 4.26.2017    0.65625    5.1875   17.4000      301      open     post
## 117  5.5.2017    0.66625    3.5250   28.5125      302      open     post
## 119  5.5.2017    0.66625    3.5250   28.5125      303      open     post
##            abun percent.cover
## 1   -0.33333333     0.6000000
## 3    0.10000000     0.4285714
## 5    0.00000000     0.8000000
## 7    0.41176471     0.9230769
## 9    0.36000000     0.9230769
## 11  -0.28571429     0.8000000
## 13  -0.20000000     0.6666667
## 15   1.00000000     0.9230769
## 17  -0.36842105     0.9736842
## 19  -0.26315789     0.6666667
## 21   0.53846154     0.9607843
## 23   0.60000000     0.8750000
## 25   0.00000000     0.8644068
## 27   0.16666667     0.7391304
## 29   0.33333333     0.8867925
## 31   0.37500000     0.9696970
## 33  -0.04347826     0.9607843
## 35  -0.23076923     0.9753086
## 37   0.11111111     0.8518519
## 39   0.06666667     0.9047619
## 41  -0.60000000     0.9672131
## 43  -0.20000000     0.9565217
## 45  -1.00000000     0.7142857
## 47   0.17647059    -0.3333333
## 49   1.00000000     0.7777778
## 51  -0.13043478     0.6000000
## 53  -0.11111111     0.9512195
## 55  -0.25000000     0.8750000
## 57  -0.09090909     0.9047619
## 59   0.00000000     0.9444444
## 61  -0.05263158     0.8750000
## 63   0.41176471     0.9047619
## 65   0.27272727     0.8518519
## 67   0.33333333     0.9230769
## 69  -0.60000000     0.5789474
## 71   0.14285714     0.9047619
## 73  -0.25000000     0.8518519
## 75   0.38461538     0.9696970
## 77   0.18181818     0.9047619
## 79  -1.00000000     0.3333333
## 81   0.05263158     0.1111111
## 83   0.33333333     0.9565217
## 85  -0.27272727     0.7391304
## 87   0.30000000     0.6666667
## 89   0.21739130     0.5789474
## 91   0.23076923     0.8750000
## 93   0.76470588     0.9047619
## 95   0.06666667     0.9565217
## 97  -0.42857143     0.9047619
## 99   0.41176471     0.9047619
## 101  0.33333333     0.7777778
## 103  0.50000000     0.9047619
## 105  0.33333333     0.9565217
## 107 -1.00000000     0.6666667
## 109  1.00000000     0.9230769
## 111  0.14285714     0.5151515
## 113 -0.11111111     0.5789474
## 115 -0.11111111     0.9565217
## 117  0.00000000     0.8518519
## 119  0.00000000     0.8867925</code></pre>
<div class="sourceCode" id="cb650"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb650-1" title="1">rii.pan &lt;-<span class="st"> </span><span class="kw">rbind</span>(pre.pan, post.pan)</a>
<a class="sourceLine" id="cb650-2" title="2"></a>
<a class="sourceLine" id="cb650-3" title="3"></a>
<a class="sourceLine" id="cb650-4" title="4">pre.beetle &lt;-<span class="st"> </span><span class="kw">filter</span>(yesbeetle, blooming <span class="op">==</span><span class="st"> &quot;pre&quot;</span>)</a>
<a class="sourceLine" id="cb650-5" title="5">pre.beetle &lt;-<span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(pre.beetle, date, mean.Solar, mean.Wind, mean.Temp, plant.id, treatment, blooming, Species)</a>
<a class="sourceLine" id="cb650-6" title="6"><span class="co">#split into 2 dataframes, rename the visitation columns and then rbind</span></a>
<a class="sourceLine" id="cb650-7" title="7"><span class="co">#there are 2 unmatched reps</span></a>
<a class="sourceLine" id="cb650-8" title="8">pre.beetle &lt;-<span class="st"> </span><span class="kw">arrange</span>(pre.beetle, plant.id)</a>
<a class="sourceLine" id="cb650-9" title="9"></a>
<a class="sourceLine" id="cb650-10" title="10"><span class="co">#prepan &lt;- filter(prepan, plant.id != 266 &amp; plant.id != 275 &amp; plant.id != 276 &amp; plant.id != 196)</span></a>
<a class="sourceLine" id="cb650-11" title="11">pre.beetle &lt;-<span class="st"> </span><span class="kw">rii.m</span>(pre.beetle, <span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">7</span>), <span class="dv">8</span>)</a></code></pre></div>
<pre><code>##          date mean.Solar mean.Wind mean.Temp plant.id treatment blooming
## 1   4.16.2017    0.73875    5.1750   18.7500      146      open      pre
## 3   4.12.2017    0.75875    6.6625   18.6125      180      open      pre
## 5   4.20.2017    0.79875    6.1250   17.8625      181      open      pre
## 7   4.20.2017    0.79875    6.1250   17.8625      183      open      pre
## 9   4.10.2017    0.76250    5.1500   18.3500      184      open      pre
## 11  4.20.2017    0.79875    6.1250   17.8625      185      open      pre
## 13  4.15.2017    0.76875    5.1750   18.5000      186      open      pre
## 15  4.11.2017    0.61000    6.3250   18.5750      187      open      pre
## 17  4.16.2017    0.73875    5.1750   18.7500      188      open      pre
## 19  4.10.2017    0.76250    5.1500   18.3500      189      open      pre
## 21  4.13.2017    0.76000    6.1125   18.5625      190      open      pre
## 23  4.12.2017    0.75875    6.6625   18.6125      191      open      pre
## 25  4.10.2017    0.76250    5.1500   18.3500      192      open      pre
## 27  4.11.2017    0.61000    6.3250   18.5750      193      open      pre
## 29  4.10.2017    0.76250    5.1500   18.3500      194      open      pre
## 31  4.16.2017    0.73875    5.1750   18.7500      195      open      pre
## 33  4.12.2017    0.75875    6.6625   18.6125      196      open      pre
## 35  4.11.2017    0.61000    6.3250   18.5750      197      open      pre
## 37  4.12.2017    0.75875    6.6625   18.6125      198      open      pre
## 39  4.15.2017    0.76875    5.1750   18.5000      199      open      pre
## 41  4.15.2017    0.76875    5.1750   18.5000      262      open      pre
## 43  4.19.2017    0.77625    6.0250   17.9000      264      open      pre
## 45  4.12.2017    0.75875    6.6625   18.6125      265      open      pre
## 47  4.11.2017    0.61000    6.3250   18.5750      266      open      pre
## 49  4.13.2017    0.76000    6.1125   18.5625      267      open      pre
## 51  4.16.2017    0.73875    5.1750   18.7500      268      open      pre
## 53  4.15.2017    0.76875    5.1750   18.5000      269      open      pre
## 55  4.19.2017    0.77625    6.0250   17.9000      270      open      pre
## 57  4.16.2017    0.73875    5.1750   18.7500      271      open      pre
## 59  4.13.2017    0.76000    6.1125   18.5625      272      open      pre
## 61  4.11.2017    0.61000    6.3250   18.5750      273      open      pre
## 63  4.20.2017    0.79875    6.1250   17.8625      274      open      pre
## 65  4.10.2017    0.76250    5.1500   18.3500      275      open      pre
## 67  4.15.2017    0.76875    5.1750   18.5000      276      open      pre
## 69  4.17.2017    0.57375    5.5375   18.4125      278      open      pre
## 71  4.17.2017    0.57375    5.5375   18.4125      280      open      pre
## 73  4.20.2017    0.79875    6.1250   17.8625      281      open      pre
## 75  4.17.2017    0.57375    5.5375   18.4125      282      open      pre
## 77  4.19.2017    0.77625    6.0250   17.9000      283      open      pre
## 79  4.13.2017    0.76000    6.1125   18.5625      284      open      pre
## 81  4.19.2017    0.77625    6.0250   17.9000      286      open      pre
## 83  4.20.2017    0.79875    6.1250   17.8625      287      open      pre
## 85  4.11.2017    0.61000    6.3250   18.5750      288      open      pre
## 87  4.12.2017    0.75875    6.6625   18.6125      289      open      pre
## 89  4.19.2017    0.77625    6.0250   17.9000      290      open      pre
## 91  4.17.2017    0.57375    5.5375   18.4125      291      open      pre
## 93  4.13.2017    0.76000    6.1125   18.5625      293      open      pre
## 95  4.13.2017    0.76000    6.1125   18.5625      294      open      pre
## 97  4.17.2017    0.57375    5.5375   18.4125      295      open      pre
## 99  4.10.2017    0.76250    5.1500   18.3500      296      open      pre
## 101 4.19.2017    0.77625    6.0250   17.9000      297      open      pre
## 103 4.16.2017    0.73875    5.1750   18.7500      298      open      pre
## 105 4.17.2017    0.57375    5.5375   18.4125      299      open      pre
## 107 4.15.2017    0.76875    5.1750   18.5000      300      open      pre
##         Species
## 1   -0.25000000
## 3   -0.04761905
## 5   -0.42857143
## 7   -0.17647059
## 9    0.00000000
## 11   0.09090909
## 13   0.38461538
## 15  -0.23076923
## 17   0.20000000
## 19  -0.21739130
## 21   0.00000000
## 23   0.00000000
## 25   0.20000000
## 27   0.22222222
## 29  -0.07692308
## 31  -0.05882353
## 33  -0.25000000
## 35   0.06666667
## 37   0.22222222
## 39   0.00000000
## 41   0.29411765
## 43   0.16666667
## 45   0.14285714
## 47   0.00000000
## 49   0.25000000
## 51   0.11111111
## 53   0.13043478
## 55   0.06666667
## 57   0.50000000
## 59   0.23076923
## 61   0.29411765
## 63   0.28000000
## 65   1.00000000
## 67   0.12500000
## 69   0.64705882
## 71   0.23809524
## 73  -0.42857143
## 75  -0.06666667
## 77   0.14285714
## 79  -0.07692308
## 81   0.06666667
## 83   0.00000000
## 85   0.20000000
## 87   0.15789474
## 89   0.33333333
## 91  -0.11111111
## 93   0.33333333
## 95   0.28571429
## 97   0.14285714
## 99  -0.04000000
## 101  0.00000000
## 103  0.33333333
## 105  0.28571429
## 107  0.00000000</code></pre>
<div class="sourceCode" id="cb652"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb652-1" title="1">post.beetle &lt;-<span class="st"> </span><span class="kw">filter</span>(yesbeetle, blooming <span class="op">==</span><span class="st"> &quot;post&quot;</span>)</a>
<a class="sourceLine" id="cb652-2" title="2">post.beetle &lt;-<span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(post.beetle, date, mean.Solar, mean.Wind, mean.Temp, plant.id, treatment, blooming, Species)</a>
<a class="sourceLine" id="cb652-3" title="3"><span class="co">#split into 2 dataframes, rename the visitation columns and then rbind</span></a>
<a class="sourceLine" id="cb652-4" title="4"><span class="co">#there are 2 unmatched reps</span></a>
<a class="sourceLine" id="cb652-5" title="5">post.beetle &lt;-<span class="st"> </span><span class="kw">arrange</span>(post.beetle, plant.id)</a>
<a class="sourceLine" id="cb652-6" title="6"></a>
<a class="sourceLine" id="cb652-7" title="7"><span class="co">#prepan &lt;- filter(prepan, plant.id != 266 &amp; plant.id != 275 &amp; plant.id != 276 &amp; plant.id != 196)</span></a>
<a class="sourceLine" id="cb652-8" title="8">post.beetle &lt;-<span class="st"> </span><span class="kw">rii.m</span>(post.beetle, <span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">7</span>), <span class="dv">8</span>)</a></code></pre></div>
<pre><code>##          date mean.Solar mean.Wind mean.Temp plant.id treatment blooming
## 1   4.30.2017    0.80875    4.7875   17.5250      104      open     post
## 3   4.29.2017    0.81250    5.0000   17.2625      114      open     post
## 5   4.23.2017    0.77750    4.5750   17.1625      146      open     post
## 7   4.22.2017    0.77375    5.4250   17.2000      180      open     post
## 9   4.30.2017    0.80875    4.7875   17.5250      181      open     post
## 11  4.22.2017    0.77375    5.4250   17.2000      182      open     post
## 13   5.3.2017    0.78625    4.4750   17.5500      183      open     post
## 15   5.1.2017    0.80250    5.1375   17.4375      184      open     post
## 17   5.5.2017    0.66625    3.5250   28.5125      185      open     post
## 19  4.30.2017    0.80875    4.7875   17.5250      186      open     post
## 21   5.3.2017    0.78625    4.4750   17.5500      187      open     post
## 23  4.27.2017    0.66000    4.1250   17.3625      188      open     post
## 25  4.22.2017    0.77375    5.4250   17.2000      189      open     post
## 27  4.29.2017    0.81250    5.0000   17.2625      190      open     post
## 29   5.1.2017    0.80250    5.1375   17.4375      191      open     post
## 31  4.26.2017    0.65625    5.1875   17.4000      192      open     post
## 33   5.5.2017    0.66625    3.5250   28.5125      193      open     post
## 35  4.22.2017    0.77375    5.4250   17.2000      194      open     post
## 37  4.23.2017    0.77750    4.5750   17.1625      195      open     post
## 39  4.26.2017    0.65625    5.1875   17.4000      196      open     post
## 41  4.23.2017    0.77750    4.5750   17.1625      197      open     post
## 43   5.4.2017    0.80500    5.0625   17.7875      198      open     post
## 45   5.1.2017    0.80250    5.1375   17.4375      199      open     post
## 47   5.4.2017    0.80500    5.0625   17.7875      261      open     post
## 49  4.27.2017    0.66000    4.1250   17.3625      262      open     post
## 51   5.3.2017    0.78625    4.4750   17.5500      263      open     post
## 53  4.26.2017    0.65625    5.1875   17.4000      264      open     post
## 55  4.30.2017    0.80875    4.7875   17.5250      265      open     post
## 57  4.23.2017    0.77750    4.5750   17.1625      266      open     post
## 59  4.23.2017    0.77750    4.5750   17.1625      267      open     post
## 61  4.30.2017    0.80875    4.7875   17.5250      268      open     post
## 63  4.29.2017    0.81250    5.0000   17.2625      269      open     post
## 65  4.29.2017    0.81250    5.0000   17.2625      270      open     post
## 67   5.1.2017    0.80250    5.1375   17.4375      271      open     post
## 69  4.30.2017    0.80875    4.7875   17.5250      272      open     post
## 71   5.4.2017    0.80500    5.0625   17.7875      273      open     post
## 73   5.3.2017    0.78625    4.4750   17.5500      274      open     post
## 75  4.22.2017    0.77375    5.4250   17.2000      275      open     post
## 77  4.22.2017    0.77375    5.4250   17.2000      276      open     post
## 79   5.1.2017    0.80250    5.1375   17.4375      278      open     post
## 81   5.4.2017    0.80500    5.0625   17.7875      280      open     post
## 83   5.5.2017    0.66625    3.5250   28.5125      281      open     post
## 85  4.27.2017    0.66000    4.1250   17.3625      282      open     post
## 87   5.4.2017    0.80500    5.0625   17.7875      283      open     post
## 89   5.3.2017    0.78625    4.4750   17.5500      285      open     post
## 91  4.29.2017    0.81250    5.0000   17.2625      286      open     post
## 93  4.29.2017    0.81250    5.0000   17.2625      288      open     post
## 95  4.23.2017    0.77750    4.5750   17.1625      289      open     post
## 97   5.3.2017    0.78625    4.4750   17.5500      290      open     post
## 99   5.4.2017    0.80500    5.0625   17.7875      291      open     post
## 101 4.27.2017    0.66000    4.1250   17.3625      293      open     post
## 103 4.27.2017    0.66000    4.1250   17.3625      294      open     post
## 105 4.26.2017    0.65625    5.1875   17.4000      295      open     post
## 107  5.1.2017    0.80250    5.1375   17.4375      296      open     post
## 109 4.27.2017    0.66000    4.1250   17.3625      297      open     post
## 111 4.26.2017    0.65625    5.1875   17.4000      298      open     post
## 113  5.5.2017    0.66625    3.5250   28.5125      300      open     post
## 115 4.26.2017    0.65625    5.1875   17.4000      301      open     post
## 117  5.5.2017    0.66625    3.5250   28.5125      302      open     post
## 119  5.5.2017    0.66625    3.5250   28.5125      303      open     post
##         Species
## 1   -0.06666667
## 3   -0.05263158
## 5   -0.06666667
## 7    0.29411765
## 9   -0.07692308
## 11  -0.07692308
## 13  -0.14285714
## 15   0.50000000
## 17  -0.30000000
## 19   0.00000000
## 21   0.33333333
## 23  -0.20000000
## 25   0.23809524
## 27   0.14285714
## 29   0.20000000
## 31   0.23076923
## 33  -0.04761905
## 35  -0.33333333
## 37   0.11111111
## 39  -0.06666667
## 41  -0.33333333
## 43  -0.06666667
## 45  -0.71428571
## 47   0.17647059
## 49   0.50000000
## 51  -0.12500000
## 53   0.00000000
## 55  -0.06666667
## 57  -0.07692308
## 59  -0.11111111
## 61   0.05882353
## 63   0.37500000
## 65   0.16666667
## 67   0.14285714
## 69  -0.33333333
## 71   0.20000000
## 73  -0.25000000
## 75   0.09090909
## 77   0.15789474
## 79  -0.33333333
## 81   0.15789474
## 83   0.33333333
## 85  -0.33333333
## 87   0.25000000
## 89   0.11111111
## 91   0.09090909
## 93   0.71428571
## 95   0.07692308
## 97  -0.50000000
## 99   0.28571429
## 101  0.20000000
## 103  0.60000000
## 105  0.16666667
## 107 -0.33333333
## 109  1.00000000
## 111  0.07692308
## 113 -0.20000000
## 115 -0.33333333
## 117  0.14285714
## 119  0.00000000</code></pre>
<div class="sourceCode" id="cb654"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb654-1" title="1"><span class="co">#blooming contrast</span></a>
<a class="sourceLine" id="cb654-2" title="2">shrub.visits &lt;-<span class="st"> </span><span class="kw">filter</span>(byrep, treatment <span class="op">==</span><span class="st"> &quot;shrub&quot;</span>)</a>
<a class="sourceLine" id="cb654-3" title="3">shrub.visits &lt;-<span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(shrub.visits, Date, mean.Solar, mean.Wind, mean.Temp, PlantID, treatment, flowering, understory.richness, visits.per.hour, flowers.per.hour)</a>
<a class="sourceLine" id="cb654-4" title="4"><span class="co">#split into 2 dataframes, rename the visitation columns and then rbind</span></a>
<a class="sourceLine" id="cb654-5" title="5"><span class="co">#there are 2 unmatched reps</span></a>
<a class="sourceLine" id="cb654-6" title="6">shrub.visits &lt;-<span class="st"> </span><span class="kw">arrange</span>(shrub.visits, PlantID)</a>
<a class="sourceLine" id="cb654-7" title="7">shrub.visits &lt;-<span class="st"> </span><span class="kw">filter</span>(shrub.visits, PlantID <span class="op">!=</span><span class="st"> </span><span class="dv">196</span> <span class="op">&amp;</span><span class="st"> </span>PlantID <span class="op">!=</span><span class="st"> &quot;new1&quot;</span> <span class="op">&amp;</span><span class="st"> </span>PlantID <span class="op">!=</span><span class="st"> </span><span class="dv">303</span> <span class="op">&amp;</span><span class="st"> </span>PlantID <span class="op">!=</span><span class="st"> </span><span class="dv">299</span>)</a>
<a class="sourceLine" id="cb654-8" title="8">shrub.visits &lt;-<span class="st"> </span><span class="kw">subset</span>(shrub.visits[<span class="op">-</span><span class="dv">43</span>,])</a>
<a class="sourceLine" id="cb654-9" title="9"></a>
<a class="sourceLine" id="cb654-10" title="10">open.visits &lt;-<span class="st"> </span><span class="kw">filter</span>(byrep, treatment <span class="op">==</span><span class="st"> &quot;open&quot;</span>)</a>
<a class="sourceLine" id="cb654-11" title="11">open.visits &lt;-<span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(open.visits, Date, mean.Solar, mean.Wind, mean.Temp, PlantID, treatment, flowering, understory.richness, visits.per.hour, flowers.per.hour)</a>
<a class="sourceLine" id="cb654-12" title="12">open.visits &lt;-<span class="st"> </span><span class="kw">arrange</span>(open.visits, PlantID)</a>
<a class="sourceLine" id="cb654-13" title="13">open.visits &lt;-<span class="st"> </span><span class="kw">filter</span>(open.visits, PlantID <span class="op">!=</span><span class="st"> </span><span class="dv">266</span> <span class="op">&amp;</span><span class="st"> </span>PlantID <span class="op">!=</span><span class="st"> &quot;new1&quot;</span> <span class="op">&amp;</span><span class="st"> </span>PlantID <span class="op">!=</span><span class="st"> </span><span class="dv">303</span> <span class="op">&amp;</span><span class="st"> </span>PlantID <span class="op">!=</span><span class="st"> </span><span class="dv">299</span> <span class="op">&amp;</span><span class="st"> </span>PlantID <span class="op">!=</span><span class="st"> </span><span class="dv">275</span> <span class="op">&amp;</span><span class="st"> </span>PlantID <span class="op">!=</span><span class="st"> </span><span class="dv">276</span>)</a>
<a class="sourceLine" id="cb654-14" title="14"><span class="co">#open.visits &lt;- subset(open.visits[-43,]) </span></a>
<a class="sourceLine" id="cb654-15" title="15"></a>
<a class="sourceLine" id="cb654-16" title="16">rii.shrub.visits &lt;-<span class="st"> </span><span class="kw">rii.b</span>(shrub.visits, <span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">7</span>), <span class="dv">8</span><span class="op">:</span><span class="dv">10</span>)</a></code></pre></div>
<pre><code>##          Date mean.Solar mean.Wind mean.Temp PlantID treatment flowering
## 1   4.20.2017  0.7987500  6.125000  17.86250     104     shrub       pre
## 3   4.19.2017  0.7762500  6.025000  17.90000     114     shrub       pre
## 5   4.10.2017  0.7625000  5.150000  18.35000     146     shrub       pre
## 7   4.13.2017  0.7600000  6.112500  18.56250     180     shrub       pre
## 9   4.19.2017  0.7762500  6.025000  17.90000     181     shrub       pre
## 11  4.16.2017  0.7387500  5.175000  18.75000     182     shrub       pre
## 13  4.19.2017  0.7762500  6.025000  17.90000     183     shrub       pre
## 15  4.14.2017  0.7671429  6.242857  15.88571     184     shrub       pre
## 17  4.16.2017  0.7387500  5.175000  18.75000     185     shrub       pre
## 19  4.13.2017  0.7600000  6.112500  18.56250     186     shrub       pre
## 21  4.10.2017  0.7625000  5.150000  18.35000     187     shrub       pre
## 23  4.14.2017  0.7671429  6.242857  15.88571     188     shrub       pre
## 25  4.12.2017  0.7587500  6.662500  18.61250     189     shrub       pre
## 27  4.12.2017  0.7587500  6.662500  18.61250     190     shrub       pre
## 29  4.11.2017  0.6100000  6.325000  18.57500     191     shrub       pre
## 31  4.13.2017  0.7600000  6.112500  18.56250     192     shrub       pre
## 33  4.10.2017  0.7625000  5.150000  18.35000     193     shrub       pre
## 35  4.11.2017  0.6100000  6.325000  18.57500     194     shrub       pre
## 37  4.14.2017  0.7671429  6.242857  15.88571     195     shrub       pre
## 39  4.14.2017  0.7671429  6.242857  15.88571     197     shrub       pre
## 41  4.19.2017  0.7762500  6.025000  17.90000     198     shrub       pre
## 44  4.13.2017  0.7600000  6.112500  18.56250     199     shrub       pre
## 46  4.20.2017  0.7987500  6.125000  17.86250     261     shrub       pre
## 48  4.13.2017  0.7600000  6.112500  18.56250     262     shrub       pre
## 50  4.12.2017  0.7587500  6.662500  18.61250     263     shrub       pre
## 52  4.16.2017  0.7387500  5.175000  18.75000     264     shrub       pre
## 54  4.11.2017  0.6100000  6.325000  18.57500     265     shrub       pre
## 56  4.10.2017  0.7625000  5.150000  18.35000     266     shrub       pre
## 58  4.14.2017  0.7671429  6.242857  15.88571     268     shrub       pre
## 60  4.14.2017  0.7671429  6.242857  15.88571     269     shrub       pre
## 62  4.18.2017  0.6685714  6.014286  16.25714     270     shrub       pre
## 64  4.18.2017  0.6685714  6.014286  16.25714     271     shrub       pre
## 66  4.12.2017  0.7587500  6.662500  18.61250     272     shrub       pre
## 68  4.10.2017  0.7625000  5.150000  18.35000     273     shrub       pre
## 70  4.19.2017  0.7762500  6.025000  17.90000     274     shrub       pre
## 72  4.11.2017  0.6100000  6.325000  18.57500     275     shrub       pre
## 74  4.16.2017  0.7387500  5.175000  18.75000     276     shrub       pre
## 76  4.15.2017  0.7687500  5.175000  18.50000     278     shrub       pre
## 78  4.15.2017  0.7687500  5.175000  18.50000     280     shrub       pre
## 80  4.19.2017  0.7762500  6.025000  17.90000     281     shrub       pre
## 82  4.15.2017  0.7687500  5.175000  18.50000     282     shrub       pre
## 84  4.18.2017  0.6685714  6.014286  16.25714     283     shrub       pre
## 86  4.20.2017  0.7987500  6.125000  17.86250     285     shrub       pre
## 88  4.16.2017  0.7387500  5.175000  18.75000     286     shrub       pre
## 90  4.10.2017  0.7625000  5.150000  18.35000     288     shrub       pre
## 92  4.11.2017  0.6100000  6.325000  18.57500     289     shrub       pre
## 94  4.18.2017  0.6685714  6.014286  16.25714     290     shrub       pre
## 96  4.16.2017  0.7387500  5.175000  18.75000     291     shrub       pre
## 98  4.12.2017  0.7587500  6.662500  18.61250     293     shrub       pre
## 100 4.15.2017  0.7687500  5.175000  18.50000     294     shrub       pre
## 102 4.15.2017  0.7687500  5.175000  18.50000     295     shrub       pre
## 104 4.12.2017  0.7587500  6.662500  18.61250     296     shrub       pre
## 106 4.18.2017  0.6685714  6.014286  16.25714     297     shrub       pre
## 108 4.18.2017  0.6685714  6.014286  16.25714     298     shrub       pre
## 110 4.13.2017  0.7600000  6.112500  18.56250     300     shrub       pre
## 112 4.20.2017  0.7987500  6.125000  17.86250     301     shrub       pre
## 114 4.20.2017  0.7987500  6.125000  17.86250     302     shrub       pre
##     understory.richness visits.per.hour flowers.per.hour
## 1             0.0000000     1.000000000       1.00000000
## 3            -0.3333333    -0.280883780      -0.28088378
## 5            -0.2000000    -1.000000000      -1.00000000
## 7            -0.6000000     0.037331753      -0.10609119
## 9             0.0000000     0.301857273       0.52343548
## 11            0.0000000     0.468538012       0.26659404
## 13           -0.2000000    -0.501320720      -0.50132072
## 15           -0.2000000    -1.000000000      -1.00000000
## 17           -0.3333333     0.130513870       0.32210601
## 19           -0.1428571    -0.255636837      -0.11705447
## 21           -0.3333333    -0.837710332      -0.83771033
## 23            0.2000000    -1.000000000      -1.00000000
## 25            0.0000000    -1.000000000      -1.00000000
## 27           -0.3333333    -1.000000000      -1.00000000
## 29           -0.3333333    -1.000000000      -1.00000000
## 31            0.0000000     0.005522209       0.20529547
## 33           -0.1428571    -1.000000000      -1.00000000
## 35           -0.2000000    -1.000000000      -1.00000000
## 37            0.0000000     0.065558130       0.06555813
## 39            0.3333333    -0.673317328      -0.82213207
## 41            0.0000000    -1.000000000      -1.00000000
## 44            0.5000000    -1.000000000      -1.00000000
## 46           -0.6000000    -1.000000000      -1.00000000
## 48            0.2000000    -0.666190422      -0.66619042
## 50            0.0000000    -0.368031515      -0.52908735
## 52           -0.3333333    -0.601130290      -0.65618030
## 54            0.0000000    -1.000000000      -1.00000000
## 56            0.2000000     0.210141084       0.21014108
## 58            0.0000000    -1.000000000      -1.00000000
## 60            0.5000000    -1.000000000      -1.00000000
## 62           -0.2000000    -1.000000000      -1.00000000
## 64           -0.2000000     0.017896336       0.01789634
## 66            0.0000000    -0.314693295      -0.31469330
## 68            0.0000000    -0.487906315      -0.48790631
## 70            0.0000000    -0.442881816      -0.44288182
## 72            0.0000000    -0.092159662      -0.09215966
## 74            0.0000000    -0.465366451      -0.46536645
## 76            0.0000000    -1.000000000      -1.00000000
## 78            0.0000000    -0.195342820      -0.57571623
## 80            0.0000000     1.000000000       1.00000000
## 82            0.0000000    -1.000000000      -1.00000000
## 84            0.0000000    -1.000000000      -1.00000000
## 86            0.0000000     0.033123978       0.03312398
## 88            0.3333333    -1.000000000      -1.00000000
## 90           -0.2000000    -1.000000000      -1.00000000
## 92           -0.6666667    -1.000000000      -1.00000000
## 94           -0.2000000     1.000000000       1.00000000
## 96            0.0000000    -0.327678871      -0.13663324
## 98            0.0000000     0.000000000       0.00000000
## 100           0.0000000    -1.000000000      -1.00000000
## 102          -0.3333333    -0.091718825      -0.09171883
## 104          -0.2000000    -0.896781141      -0.91531520
## 106           0.6000000     0.000000000       0.00000000
## 108           0.0000000     1.000000000       1.00000000
## 110           0.2000000    -1.000000000      -1.00000000
## 112          -1.0000000     0.000000000       0.00000000
## 114           0.3333333    -0.242510699      -0.24251070</code></pre>
<div class="sourceCode" id="cb656"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb656-1" title="1">rii.open.visits &lt;-<span class="st"> </span><span class="kw">rii.b</span>(open.visits, <span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">7</span>), <span class="dv">8</span><span class="op">:</span><span class="dv">10</span>)</a></code></pre></div>
<pre><code>##          Date mean.Solar mean.Wind mean.Temp PlantID treatment flowering
## 1   4.20.2017  0.7987500  6.125000  17.86250     104      open       pre
## 3   4.19.2017  0.7762500  6.025000  17.90000     114      open       pre
## 5   4.10.2017  0.7625000  5.150000  18.35000     146      open       pre
## 7   4.13.2017  0.7600000  6.112500  18.56250     180      open       pre
## 9   4.19.2017  0.7762500  6.025000  17.90000     181      open       pre
## 11  4.16.2017  0.7387500  5.175000  18.75000     182      open       pre
## 13  4.19.2017  0.7762500  6.025000  17.90000     183      open       pre
## 15  4.14.2017  0.7671429  6.242857  15.88571     184      open       pre
## 17  4.16.2017  0.7387500  5.175000  18.75000     185      open       pre
## 19  4.13.2017  0.7600000  6.112500  18.56250     186      open       pre
## 21  4.10.2017  0.7625000  5.150000  18.35000     187      open       pre
## 23  4.14.2017  0.7671429  6.242857  15.88571     188      open       pre
## 25  4.12.2017  0.7587500  6.662500  18.61250     189      open       pre
## 27  4.12.2017  0.7587500  6.662500  18.61250     190      open       pre
## 29  4.11.2017  0.6100000  6.325000  18.57500     191      open       pre
## 31  4.13.2017  0.7600000  6.112500  18.56250     192      open       pre
## 33  4.10.2017  0.7625000  5.150000  18.35000     193      open       pre
## 35  4.11.2017  0.6100000  6.325000  18.57500     194      open       pre
## 37  4.14.2017  0.7671429  6.242857  15.88571     195      open       pre
## 39  4.11.2017  0.6100000  6.325000  18.57500     196      open       pre
## 41  4.14.2017  0.7671429  6.242857  15.88571     197      open       pre
## 43  4.19.2017  0.7762500  6.025000  17.90000     198      open       pre
## 45  4.13.2017  0.7600000  6.112500  18.56250     199      open       pre
## 47  4.20.2017  0.7987500  6.125000  17.86250     261      open       pre
## 49  4.13.2017  0.7600000  6.112500  18.56250     262      open       pre
## 51  4.12.2017  0.7587500  6.662500  18.61250     263      open       pre
## 53  4.16.2017  0.7387500  5.175000  18.75000     264      open       pre
## 55  4.11.2017  0.6100000  6.325000  18.57500     265      open       pre
## 57  4.14.2017  0.7671429  6.242857  15.88571     268      open       pre
## 59  4.14.2017  0.7671429  6.242857  15.88571     269      open       pre
## 61  4.18.2017  0.6685714  6.014286  16.25714     270      open       pre
## 63  4.18.2017  0.6685714  6.014286  16.25714     271      open       pre
## 65  4.12.2017  0.7587500  6.662500  18.61250     272      open       pre
## 67  4.10.2017  0.7625000  5.150000  18.35000     273      open       pre
## 69  4.19.2017  0.7762500  6.025000  17.90000     274      open       pre
## 71  4.15.2017  0.7687500  5.175000  18.50000     278      open       pre
## 73  4.15.2017  0.7687500  5.175000  18.50000     280      open       pre
## 75  4.19.2017  0.7762500  6.025000  17.90000     281      open       pre
## 77  4.15.2017  0.7687500  5.175000  18.50000     282      open       pre
## 79  4.18.2017  0.6685714  6.014286  16.25714     283      open       pre
## 81  4.20.2017  0.7987500  6.125000  17.86250     285      open       pre
## 83  4.16.2017  0.7387500  5.175000  18.75000     286      open       pre
## 85  4.10.2017  0.7625000  5.150000  18.35000     288      open       pre
## 87  4.11.2017  0.6100000  6.325000  18.57500     289      open       pre
## 89  4.18.2017  0.6685714  6.014286  16.25714     290      open       pre
## 91  4.16.2017  0.7387500  5.175000  18.75000     291      open       pre
## 93  4.12.2017  0.7587500  6.662500  18.61250     293      open       pre
## 95  4.15.2017  0.7687500  5.175000  18.50000     294      open       pre
## 97  4.15.2017  0.7687500  5.175000  18.50000     295      open       pre
## 99  4.12.2017  0.7587500  6.662500  18.61250     296      open       pre
## 101 4.18.2017  0.6685714  6.014286  16.25714     297      open       pre
## 103 4.18.2017  0.6685714  6.014286  16.25714     298      open       pre
## 105 4.13.2017  0.7600000  6.112500  18.56250     300      open       pre
## 107 4.20.2017  0.7987500  6.125000  17.86250     301      open       pre
## 109 4.20.2017  0.7987500  6.125000  17.86250     302      open       pre
##     understory.richness visits.per.hour flowers.per.hour
## 1            -0.2000000       1.0000000        1.0000000
## 3             0.0000000      -0.7575297       -0.8061906
## 5            -0.4285714      -0.5638517       -0.7133025
## 7             0.0000000      -0.4040460       -0.1713548
## 9             0.2000000      -0.3341714       -0.1437809
## 11            0.0000000       0.3970570        0.3970570
## 13           -0.2000000       1.0000000        1.0000000
## 15            0.0000000       1.0000000        1.0000000
## 17           -0.3333333      -1.0000000       -1.0000000
## 19           -0.6000000      -1.0000000       -1.0000000
## 21           -0.6000000      -0.4043977       -0.1631613
## 23            0.2000000      -1.0000000       -1.0000000
## 25            0.0000000      -1.0000000       -1.0000000
## 27           -0.2000000      -1.0000000       -1.0000000
## 29           -0.3333333      -0.6440033       -0.7476991
## 31            0.0000000      -0.4654393       -0.5130157
## 33           -0.2000000      -0.8421419       -0.8826684
## 35            0.0000000      -1.0000000       -1.0000000
## 37            0.0000000      -0.3557713       -0.3557713
## 39           -0.2000000      -0.5858139       -0.3137462
## 41           -0.2000000       1.0000000        1.0000000
## 43           -0.3333333      -1.0000000       -1.0000000
## 45            0.2000000      -0.8271642       -0.8271642
## 47            0.0000000       0.0000000        0.0000000
## 49            0.0000000      -1.0000000       -1.0000000
## 51            0.3333333      -0.4396668       -0.6251664
## 53            0.0000000      -0.7451054       -0.5478377
## 55           -0.5000000      -1.0000000       -1.0000000
## 57           -0.2000000      -0.9221091       -0.9221091
## 59            0.5000000       0.2934029        0.2934029
## 61            0.0000000      -0.3061285       -0.3061285
## 63           -0.3333333       0.2741935        0.2741935
## 65            0.0000000      -1.0000000       -1.0000000
## 67            0.0000000      -1.0000000       -1.0000000
## 69            0.0000000      -0.1217297       -0.1217297
## 71           -0.2000000      -1.0000000       -1.0000000
## 73            0.0000000      -0.5413985       -0.5413985
## 75            0.5000000       0.5861390        0.7850350
## 77            0.2000000      -1.0000000       -1.0000000
## 79            0.3333333      -1.0000000       -1.0000000
## 81            0.0000000       1.0000000        1.0000000
## 83           -0.3333333      -0.6559877       -0.5248462
## 85            0.0000000      -0.6121301       -0.5375824
## 87            0.2000000       1.0000000        1.0000000
## 89           -0.2000000       1.0000000        1.0000000
## 91            0.0000000      -1.0000000       -1.0000000
## 93           -0.3333333      -0.5878263       -0.5878263
## 95           -0.2000000      -0.6436425       -0.7202714
## 97            0.2000000       0.5426894        0.5426894
## 99            0.5000000      -1.0000000       -1.0000000
## 101          -0.2000000      -1.0000000       -1.0000000
## 103           0.2000000       1.0000000        1.0000000
## 105           0.0000000      -0.6793431       -0.6793431
## 107          -1.0000000       0.2686780        0.2686780
## 109           0.5000000      -1.0000000       -1.0000000</code></pre>
<div class="sourceCode" id="cb658"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb658-1" title="1"><span class="co">## calculate separate visitation pre/post by microsite bootstrapped</span></a>
<a class="sourceLine" id="cb658-2" title="2"></a>
<a class="sourceLine" id="cb658-3" title="3"><span class="co">#annuals percent cover</span></a>
<a class="sourceLine" id="cb658-4" title="4"></a>
<a class="sourceLine" id="cb658-5" title="5">rii.pre.pan.dat &lt;-<span class="st"> </span><span class="kw">filter</span>(rii.pan, blooming <span class="op">==</span><span class="st"> &quot;pre&quot;</span>)</a>
<a class="sourceLine" id="cb658-6" title="6">pre.percent.cover.rii &lt;-<span class="st"> </span><span class="kw">boot</span>(rii.pre.pan.dat<span class="op">$</span>percent.cover, bootmean, <span class="dt">R=</span><span class="dv">10000</span>, <span class="dt">stype =</span><span class="st">&quot;i&quot;</span>)</a>
<a class="sourceLine" id="cb658-7" title="7"></a>
<a class="sourceLine" id="cb658-8" title="8">ci.pre.percent.cover &lt;-<span class="st"> </span><span class="kw">boot.ci</span>(pre.percent.cover.rii)</a>
<a class="sourceLine" id="cb658-9" title="9">bca.pre.percent.cover &lt;-<span class="st"> </span>ci.pre.percent.cover<span class="op">$</span>bca</a>
<a class="sourceLine" id="cb658-10" title="10"></a>
<a class="sourceLine" id="cb658-11" title="11">rii.post.pan &lt;-<span class="st"> </span><span class="kw">filter</span>(rii.pan, blooming <span class="op">==</span><span class="st"> &quot;post&quot;</span>)</a>
<a class="sourceLine" id="cb658-12" title="12">post.percent.cover.rii &lt;-<span class="st"> </span><span class="kw">boot</span>(rii.post.pan<span class="op">$</span>percent.cover, bootmean, <span class="dt">R=</span><span class="dv">10000</span>, <span class="dt">stype =</span> <span class="st">&quot;i&quot;</span>)</a>
<a class="sourceLine" id="cb658-13" title="13">ci.post.percent.cover &lt;-<span class="st"> </span><span class="kw">boot.ci</span>(post.percent.cover.rii)</a>
<a class="sourceLine" id="cb658-14" title="14">bca.post.percent.cover &lt;-<span class="st"> </span>ci.post.percent.cover<span class="op">$</span>bca</a>
<a class="sourceLine" id="cb658-15" title="15"></a>
<a class="sourceLine" id="cb658-16" title="16"><span class="kw">t.test</span>(rii.pan<span class="op">$</span>percent.cover <span class="op">~</span><span class="st"> </span>rii.pan<span class="op">$</span>blooming)</a></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  rii.pan$percent.cover by rii.pan$blooming
## t = 2.108, df = 106.01, p-value = 0.03739
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  0.005806593 0.189479015
## sample estimates:
## mean in group post  mean in group pre 
##          0.7960921          0.6984493</code></pre>
<div class="sourceCode" id="cb660"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb660-1" title="1"><span class="co">#annual species richness</span></a>
<a class="sourceLine" id="cb660-2" title="2">pre.ann.rich.rii &lt;-<span class="st"> </span><span class="kw">boot</span>(pre.visits<span class="op">$</span>understory.richness, bootmean, <span class="dt">R=</span><span class="dv">10000</span>, <span class="dt">stype =</span> <span class="st">&quot;i&quot;</span>)</a>
<a class="sourceLine" id="cb660-3" title="3">ci.ann.rich.rii &lt;-<span class="st"> </span><span class="kw">boot.ci</span>(pre.ann.rich.rii)</a>
<a class="sourceLine" id="cb660-4" title="4">bca.pre.ann.rich.rii &lt;-<span class="st"> </span>ci.ann.rich.rii<span class="op">$</span>bca</a>
<a class="sourceLine" id="cb660-5" title="5"></a>
<a class="sourceLine" id="cb660-6" title="6"></a>
<a class="sourceLine" id="cb660-7" title="7">post.ann.rich.rii &lt;-<span class="st"> </span><span class="kw">boot</span>(post.visits<span class="op">$</span>understory.richness, bootmean, <span class="dt">R=</span><span class="dv">10000</span>, <span class="dt">stype =</span> <span class="st">&quot;i&quot;</span>)</a>
<a class="sourceLine" id="cb660-8" title="8">ci.post.ann.rich.rii &lt;-<span class="st"> </span><span class="kw">boot.ci</span>(post.ann.rich.rii)</a>
<a class="sourceLine" id="cb660-9" title="9">bca.post.ann.rich.rii &lt;-<span class="st"> </span>ci.post.ann.rich.rii<span class="op">$</span>bca</a>
<a class="sourceLine" id="cb660-10" title="10"></a>
<a class="sourceLine" id="cb660-11" title="11"></a>
<a class="sourceLine" id="cb660-12" title="12"><span class="co">#arthropod abundance</span></a>
<a class="sourceLine" id="cb660-13" title="13">post.abun.rii &lt;-<span class="st"> </span><span class="kw">boot</span>(rii.post.pan<span class="op">$</span>abun, bootmean, <span class="dt">R=</span><span class="dv">10000</span>, <span class="dt">stype =</span> <span class="st">&quot;i&quot;</span>)</a>
<a class="sourceLine" id="cb660-14" title="14">ci.post.abun &lt;-<span class="st"> </span><span class="kw">boot.ci</span>(post.abun.rii)</a>
<a class="sourceLine" id="cb660-15" title="15">bca.post.abun &lt;-<span class="st"> </span>ci.post.abun<span class="op">$</span>bca</a>
<a class="sourceLine" id="cb660-16" title="16"></a>
<a class="sourceLine" id="cb660-17" title="17">pre.abun.rii &lt;-<span class="st"> </span><span class="kw">boot</span>(rii.pre.pan.dat<span class="op">$</span>abun, bootmean, <span class="dt">R=</span><span class="dv">10000</span>, <span class="dt">stype =</span> <span class="st">&quot;i&quot;</span>)</a>
<a class="sourceLine" id="cb660-18" title="18">ci.pre.abun &lt;-<span class="st"> </span><span class="kw">boot.ci</span>(pre.abun.rii)</a>
<a class="sourceLine" id="cb660-19" title="19">bca.pre.abun &lt;-<span class="st"> </span>ci.pre.abun<span class="op">$</span>bca</a>
<a class="sourceLine" id="cb660-20" title="20"></a>
<a class="sourceLine" id="cb660-21" title="21"></a>
<a class="sourceLine" id="cb660-22" title="22"><span class="co">#arthropod richness</span></a>
<a class="sourceLine" id="cb660-23" title="23"></a>
<a class="sourceLine" id="cb660-24" title="24"><span class="co">#pre.beetle &lt;- filter(rii.beetle, blooming == &quot;pre&quot;)</span></a>
<a class="sourceLine" id="cb660-25" title="25"><span class="co">#post.beetle &lt;- filter(rii.beetle, blooming ==&quot;post&quot;)</span></a>
<a class="sourceLine" id="cb660-26" title="26"></a>
<a class="sourceLine" id="cb660-27" title="27">pre.rich.rii &lt;-<span class="st"> </span><span class="kw">boot</span>(pre.beetle<span class="op">$</span>Species, bootmean, <span class="dt">R=</span><span class="dv">10000</span>, <span class="dt">stype =</span> <span class="st">&quot;i&quot;</span>)</a>
<a class="sourceLine" id="cb660-28" title="28">ci.pre.rich.rii &lt;-<span class="st"> </span><span class="kw">boot.ci</span>(pre.rich.rii)</a>
<a class="sourceLine" id="cb660-29" title="29">bca.pre.rich &lt;-<span class="st"> </span>ci.pre.rich.rii<span class="op">$</span>bca</a>
<a class="sourceLine" id="cb660-30" title="30"></a>
<a class="sourceLine" id="cb660-31" title="31"></a>
<a class="sourceLine" id="cb660-32" title="32">post.rich.rii &lt;-<span class="st"> </span><span class="kw">boot</span>(post.beetle<span class="op">$</span>Species, bootmean, <span class="dt">R=</span><span class="dv">10000</span>, <span class="dt">stype =</span> <span class="st">&quot;i&quot;</span>)</a>
<a class="sourceLine" id="cb660-33" title="33">ci.post.rich.rii &lt;-<span class="st"> </span><span class="kw">boot.ci</span>(post.rich.rii)</a>
<a class="sourceLine" id="cb660-34" title="34">bca.post.rich &lt;-<span class="st"> </span>ci.post.rich.rii<span class="op">$</span>bca</a>
<a class="sourceLine" id="cb660-35" title="35"></a>
<a class="sourceLine" id="cb660-36" title="36"></a>
<a class="sourceLine" id="cb660-37" title="37"></a>
<a class="sourceLine" id="cb660-38" title="38"></a>
<a class="sourceLine" id="cb660-39" title="39">means.all &lt;-<span class="st"> </span><span class="kw">rbind</span>(pre.percent.cover.rii<span class="op">$</span>t0, post.percent.cover.rii<span class="op">$</span>t0, pre.ann.rich.rii<span class="op">$</span>t0, post.ann.rich.rii<span class="op">$</span>t0, pre.abun.rii<span class="op">$</span>t0, post.abun.rii<span class="op">$</span>t0, pre.rich.rii<span class="op">$</span>t0, post.rich.rii<span class="op">$</span>t0)</a>
<a class="sourceLine" id="cb660-40" title="40"></a>
<a class="sourceLine" id="cb660-41" title="41"></a>
<a class="sourceLine" id="cb660-42" title="42"><span class="kw">colnames</span>(means.all) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;means&quot;</span>)</a>
<a class="sourceLine" id="cb660-43" title="43"></a>
<a class="sourceLine" id="cb660-44" title="44">ci.all &lt;-<span class="st"> </span><span class="kw">rbind</span>(bca.pre.percent.cover, bca.post.percent.cover, bca.pre.ann.rich.rii, bca.post.ann.rich.rii, bca.pre.abun, bca.post.abun, bca.pre.rich, bca.post.rich)</a>
<a class="sourceLine" id="cb660-45" title="45"></a>
<a class="sourceLine" id="cb660-46" title="46"></a>
<a class="sourceLine" id="cb660-47" title="47"></a>
<a class="sourceLine" id="cb660-48" title="48">all.new &lt;-<span class="st"> </span><span class="kw">cbind</span>(means.all, ci.all)</a>
<a class="sourceLine" id="cb660-49" title="49">all.new &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(all.new)</a>
<a class="sourceLine" id="cb660-50" title="50"></a>
<a class="sourceLine" id="cb660-51" title="51">all.new<span class="op">$</span>bloom &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;pre&quot;</span>, <span class="st">&quot;post&quot;</span>, <span class="st">&quot;pre&quot;</span>, <span class="st">&quot;post&quot;</span>,<span class="st">&quot;pre&quot;</span>, <span class="st">&quot;post&quot;</span>,<span class="st">&quot;pre&quot;</span>, <span class="st">&quot;post&quot;</span>)</a>
<a class="sourceLine" id="cb660-52" title="52">all.new<span class="op">$</span>metric &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;percent.cover&quot;</span>, <span class="st">&quot;percent.cover&quot;</span>, <span class="st">&quot;annual.richness&quot;</span>, <span class="st">&quot;annual.richness&quot;</span>, <span class="st">&quot;arth.abundance&quot;</span>, <span class="st">&quot;arth.abundance&quot;</span>, <span class="st">&quot;arth.richness&quot;</span>, <span class="st">&quot;arth.richness&quot;</span>)</a>
<a class="sourceLine" id="cb660-53" title="53"></a>
<a class="sourceLine" id="cb660-54" title="54"></a>
<a class="sourceLine" id="cb660-55" title="55">all.new<span class="op">$</span>metric &lt;-<span class="st"> </span><span class="kw">as.factor</span>(all.new<span class="op">$</span>metric)</a>
<a class="sourceLine" id="cb660-56" title="56">all.new<span class="op">$</span>bloom &lt;-<span class="st"> </span><span class="kw">as.factor</span>(all.new<span class="op">$</span>bloom)</a>
<a class="sourceLine" id="cb660-57" title="57"></a>
<a class="sourceLine" id="cb660-58" title="58">all.new<span class="op">$</span>bloom &lt;-<span class="st"> </span><span class="kw">relevel</span>(all.new<span class="op">$</span>bloom, <span class="st">&quot;post&quot;</span>, <span class="st">&quot;pre&quot;</span>)</a>
<a class="sourceLine" id="cb660-59" title="59">all.new<span class="op">$</span>metric &lt;-<span class="st"> </span><span class="kw">factor</span>(all.new<span class="op">$</span>metric, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;arth.richness&quot;</span>, <span class="st">&quot;arth.abundance&quot;</span>, <span class="st">&quot;annual.richness&quot;</span>, <span class="st">&quot;percent.cover&quot;</span>))</a>
<a class="sourceLine" id="cb660-60" title="60">                         </a>
<a class="sourceLine" id="cb660-61" title="61"></a>
<a class="sourceLine" id="cb660-62" title="62"></a>
<a class="sourceLine" id="cb660-63" title="63"><span class="kw">str</span>(all.new)</a></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    8 obs. of  8 variables:
##  $ means : num  0.6984 0.7961 0.0432 0.0299 0.1934 ...
##  $ conf  : num  0.95 0.95 0.95 0.95 0.95 0.95 0.95 0.95
##  $ V3    : num  136.8 93.3 218.7 258.5 273.2 ...
##  $ V4    : num  9599 9504 9717 9759 9773 ...
##  $ V5    : num  0.6181 0.7212 -0.0194 -0.0276 0.1195 ...
##  $ V6    : num  0.7562 0.8411 0.1004 0.0897 0.2716 ...
##  $ bloom : Factor w/ 2 levels &quot;post&quot;,&quot;pre&quot;: 2 1 2 1 2 1 2 1
##  $ metric: Factor w/ 4 levels &quot;arth.richness&quot;,..: 4 4 3 3 2 2 1 1</code></pre>
<div class="sourceCode" id="cb662"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb662-1" title="1">all.new<span class="op">$</span>metric</a></code></pre></div>
<pre><code>## [1] percent.cover   percent.cover   annual.richness annual.richness
## [5] arth.abundance  arth.abundance  arth.richness   arth.richness  
## Levels: arth.richness arth.abundance annual.richness percent.cover</code></pre>
<div class="sourceCode" id="cb664"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb664-1" title="1">metrics &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Arthropod </span><span class="ch">\n</span><span class="st"> Richness&quot;</span>, <span class="st">&quot;Arthropod </span><span class="ch">\n</span><span class="st"> Abundance&quot;</span>, <span class="st">&quot;Annual Species </span><span class="ch">\n</span><span class="st"> Richness&quot;</span>, <span class="st">&quot;Annual Percent Cover&quot;</span>)</a>
<a class="sourceLine" id="cb664-2" title="2"></a>
<a class="sourceLine" id="cb664-3" title="3"><span class="co">#write.csv(all.boot, &quot;Output Data/allboot.csv&quot;)</span></a>
<a class="sourceLine" id="cb664-4" title="4"><span class="co">#write.csv(all.new, &quot;Output Data/allnewboot.csv&quot;)</span></a></code></pre></div>
<div class="sourceCode" id="cb665"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb665-1" title="1">sizes &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;Clean Data/video_larreadimensions.csv&quot;</span>)</a>
<a class="sourceLine" id="cb665-2" title="2">sizes<span class="op">$</span>PlantID &lt;-<span class="st"> </span>sizes<span class="op">$</span>plant.id</a>
<a class="sourceLine" id="cb665-3" title="3"><span class="kw">mean</span>(sizes<span class="op">$</span>width)</a></code></pre></div>
<pre><code>## [1] NA</code></pre>
<div class="sourceCode" id="cb667"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb667-1" title="1">h &lt;-<span class="st"> </span><span class="kw">left_join</span>(byrep, sizes, <span class="dt">by =</span> <span class="st">&quot;PlantID&quot;</span>)</a></code></pre></div>
<pre><code>## Warning: Column `PlantID` joining factors with different levels, coercing
## to character vector</code></pre>
<div class="sourceCode" id="cb669"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb669-1" title="1">h &lt;-<span class="st"> </span><span class="kw">filter</span>(h, treatment <span class="op">==</span><span class="st"> &quot;shrub&quot;</span> <span class="op">&amp;</span><span class="st"> </span>flowering <span class="op">==</span><span class="st"> &quot;pre&quot;</span>)</a>
<a class="sourceLine" id="cb669-2" title="2"><span class="kw">mean</span>(h<span class="op">$</span>width, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 342.5965</code></pre>
<div class="sourceCode" id="cb671"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb671-1" title="1"><span class="kw">sd</span>(h<span class="op">$</span>width, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 103.9497</code></pre>
<div class="sourceCode" id="cb673"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb673-1" title="1"><span class="kw">mean</span>(h<span class="op">$</span>height, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 211.7895</code></pre>
<div class="sourceCode" id="cb675"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb675-1" title="1"><span class="kw">sd</span>(h<span class="op">$</span>height, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 46.2388</code></pre>
</div>
</div>
<div id="figures" class="section level2">
<h2>Figures</h2>
<div class="sourceCode" id="cb677"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb677-1" title="1">data &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;Output Data/rtu_by_rep.csv&quot;</span>)</a>
<a class="sourceLine" id="cb677-2" title="2">summary &lt;-<span class="st"> </span>data <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(rtu, treatment, flowering) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarise</span>(<span class="dt">mean.visits =</span> <span class="kw">mean</span>(visits.per.hour), <span class="dt">se.visits =</span> <span class="kw">se</span>(visits.per.hour), <span class="dt">mean.flowers =</span> <span class="kw">mean</span>(flowers.per.hour), <span class="dt">se.flowers =</span> <span class="kw">se</span>(flowers.per.hour))</a>
<a class="sourceLine" id="cb677-3" title="3"></a>
<a class="sourceLine" id="cb677-4" title="4">summary<span class="op">$</span>t &lt;-<span class="st"> </span><span class="kw">paste</span>(summary<span class="op">$</span>treatment, summary<span class="op">$</span>flowering)</a>
<a class="sourceLine" id="cb677-5" title="5">summary<span class="op">$</span>t &lt;-<span class="st"> </span><span class="kw">as.factor</span>(summary<span class="op">$</span>t)</a>
<a class="sourceLine" id="cb677-6" title="6">summary<span class="op">$</span>t &lt;-<span class="st"> </span><span class="kw">factor</span>(summary<span class="op">$</span>t, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;shrub pre&quot;</span>, <span class="st">&quot;open pre&quot;</span>, <span class="st">&quot;shrub bloom&quot;</span>, <span class="st">&quot;open bloom&quot;</span>))</a>
<a class="sourceLine" id="cb677-7" title="7"></a>
<a class="sourceLine" id="cb677-8" title="8">summary<span class="op">$</span>flowering &lt;-<span class="st"> </span><span class="kw">relevel</span>(summary<span class="op">$</span>flowering, <span class="st">&quot;pre&quot;</span>)</a>
<a class="sourceLine" id="cb677-9" title="9">labels &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dt">pre =</span> <span class="st">&quot;Pre-blooming&quot;</span>, <span class="dt">post =</span> <span class="st">&quot;Blooming&quot;</span>, <span class="dt">bloom =</span> <span class="st">&quot;Blooming&quot;</span>)</a>
<a class="sourceLine" id="cb677-10" title="10"></a>
<a class="sourceLine" id="cb677-11" title="11"></a>
<a class="sourceLine" id="cb677-12" title="12"><span class="kw">ggplot</span>(summary, <span class="kw">aes</span>(rtu, mean.visits, <span class="dt">group =</span> t)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>(<span class="kw">aes</span> (<span class="dt">fill =</span> t), <span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="dt">position =</span> <span class="st">&quot;dodge&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> mean.visits <span class="op">-</span><span class="st"> </span>se.visits, <span class="dt">ymax =</span> mean.visits <span class="op">+</span><span class="st"> </span>se.visits), <span class="dt">width =</span> <span class="fl">0.2</span>, <span class="dt">position =</span> <span class="kw">position_dodge</span>(<span class="fl">0.9</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">theme_Publication</span>()  <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Mean foraging bouts/hr &quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_x_discrete</span>(<span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Solitary Bee&quot;</span>, <span class="st">&quot;Bombyliidae&quot;</span>, <span class="st">&quot;Honeybee&quot;</span>, <span class="st">&quot;Lepidoptera&quot;</span>, <span class="st">&quot;Other&quot;</span>, <span class="st">&quot;Syrphidae&quot;</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">vjust =</span> <span class="fl">0.2</span>), <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_manual</span>(<span class="st">&quot;&quot;</span>, <span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;shrub pre&quot;</span> =<span class="st">&quot;black&quot;</span>, <span class="st">&quot;open pre&quot;</span>=<span class="st"> &quot;white&quot;</span>, <span class="st">&quot;shrub bloom&quot;</span>=<span class="st"> &quot;black&quot;</span>, <span class="st">&quot;open bloom&quot;</span>=<span class="st"> &quot;white&quot;</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>, <span class="dt">legend.title =</span> <span class="kw">element_blank</span>(),<span class="dt">axis.title.x=</span><span class="kw">element_blank</span>(),<span class="dt">axis.text.x=</span><span class="kw">element_blank</span>(),<span class="dt">axis.ticks.x=</span><span class="kw">element_blank</span>()) <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">facet_grid</span>(<span class="op">~</span>flowering, <span class="dt">labeller=</span><span class="kw">labeller</span>(<span class="dt">flowering =</span> labels)) </a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<div class="sourceCode" id="cb678"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb678-1" title="1"><span class="kw">ggplot</span>(summary, <span class="kw">aes</span>(rtu, mean.flowers, <span class="dt">group =</span> t)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>(<span class="kw">aes</span> (<span class="dt">fill =</span> t), <span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="dt">position =</span> <span class="st">&quot;dodge&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> mean.flowers <span class="op">-</span><span class="st"> </span>se.flowers, <span class="dt">ymax =</span> mean.flowers <span class="op">+</span><span class="st"> </span>se.flowers), <span class="dt">width =</span> <span class="fl">0.2</span>, <span class="dt">position =</span> <span class="kw">position_dodge</span>(<span class="fl">0.9</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">theme_Publication</span>() <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Mean flowers visited/hr&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_x_discrete</span>(<span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Solitary bees&quot;</span>, <span class="st">&quot;Bee flies&quot;</span>, <span class="st">&quot;Honeybees&quot;</span>, <span class="st">&quot;Butterflies and </span><span class="ch">\n</span><span class="st"> sphinx moths&quot;</span>, <span class="st">&quot;Other&quot;</span>, <span class="st">&quot;Hoverflies&quot;</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">vjust =</span> <span class="fl">0.2</span>, <span class="dt">hjust =</span> <span class="dv">1</span>), <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_manual</span>(<span class="st">&quot;&quot;</span>, <span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;shrub pre&quot;</span> =<span class="st">&quot;black&quot;</span>, <span class="st">&quot;open pre&quot;</span>=<span class="st"> &quot;white&quot;</span>, <span class="st">&quot;shrub bloom&quot;</span>=<span class="st"> &quot;black&quot;</span>, <span class="st">&quot;open bloom&quot;</span>=<span class="st"> &quot;white&quot;</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">facet_grid</span>(<span class="op">~</span>flowering) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">strip.background =</span> <span class="kw">element_blank</span>(), <span class="dt">strip.text =</span> <span class="kw">element_blank</span>()) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-3-2.png" width="672" /></p>
<div class="sourceCode" id="cb679"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb679-1" title="1">visits &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;Output Data/byrep_cleaned.csv&quot;</span>)</a>
<a class="sourceLine" id="cb679-2" title="2">metadata &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;Output Data/metadata_nobeetle.csv&quot;</span>)</a>
<a class="sourceLine" id="cb679-3" title="3">nobeetle &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;Output Data/metadata_nobeetle.csv&quot;</span>)</a>
<a class="sourceLine" id="cb679-4" title="4">incbeetle &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;Output Data/metadata_yesbeetle.csv&quot;</span>)</a>
<a class="sourceLine" id="cb679-5" title="5">onlybeetle &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;Output Data/metadata_onlybeetle.csv&quot;</span>)</a>
<a class="sourceLine" id="cb679-6" title="6"></a>
<a class="sourceLine" id="cb679-7" title="7">labels &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dt">pre =</span> <span class="st">&quot;Pre-blooming&quot;</span>, <span class="dt">post =</span> <span class="st">&quot;Blooming&quot;</span>, <span class="dt">bloom =</span> <span class="st">&quot;Blooming&quot;</span>)</a>
<a class="sourceLine" id="cb679-8" title="8">visits<span class="op">$</span>flowering &lt;-<span class="st"> </span><span class="kw">relevel</span>(visits<span class="op">$</span>flowering, <span class="st">&quot;pre&quot;</span>)</a>
<a class="sourceLine" id="cb679-9" title="9">metadata<span class="op">$</span>blooming &lt;-<span class="st"> </span><span class="kw">relevel</span>(metadata<span class="op">$</span>blooming, <span class="st">&quot;pre&quot;</span>)</a>
<a class="sourceLine" id="cb679-10" title="10">metadata<span class="op">$</span>treatment &lt;-<span class="st"> </span><span class="kw">relevel</span>(metadata<span class="op">$</span>treatment, <span class="st">&quot;shrub&quot;</span>)</a>
<a class="sourceLine" id="cb679-11" title="11">visits<span class="op">$</span>treatment &lt;-<span class="st"> </span><span class="kw">relevel</span>(visits<span class="op">$</span>treatment, <span class="st">&quot;shrub&quot;</span>)</a>
<a class="sourceLine" id="cb679-12" title="12">incbeetle<span class="op">$</span>treatment &lt;-<span class="st"> </span><span class="kw">relevel</span>(incbeetle<span class="op">$</span>treatment, <span class="st">&quot;shrub&quot;</span>)</a>
<a class="sourceLine" id="cb679-13" title="13">incbeetle<span class="op">$</span>blooming &lt;-<span class="st"> </span><span class="kw">relevel</span>(incbeetle<span class="op">$</span>blooming, <span class="st">&quot;pre&quot;</span>)</a>
<a class="sourceLine" id="cb679-14" title="14">onlybeetle<span class="op">$</span>blooming &lt;-<span class="st"> </span><span class="kw">relevel</span>(onlybeetle<span class="op">$</span>blooming, <span class="st">&quot;pre&quot;</span>)</a>
<a class="sourceLine" id="cb679-15" title="15">byrtu<span class="op">$</span>flowering &lt;-<span class="st"> </span><span class="kw">relevel</span>(byrtu<span class="op">$</span>flowering, <span class="st">&quot;pre&quot;</span>)</a>
<a class="sourceLine" id="cb679-16" title="16"></a>
<a class="sourceLine" id="cb679-17" title="17">a &lt;-<span class="st"> </span><span class="kw">ggplot</span>(metadata, <span class="kw">aes</span>(treatment, percent.cover)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb679-18" title="18"><span class="st">  </span><span class="kw">stat_boxplot</span>(<span class="dt">geom =</span><span class="st">&#39;errorbar&#39;</span>, <span class="dt">width =</span> <span class="fl">0.2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_boxplot</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> treatment)) <span class="op">+</span><span class="st"> </span><span class="kw">theme_Publication</span>() <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Percent Annual Cover&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">facet_grid</span>(<span class="op">~</span>blooming,<span class="dt">labeller=</span><span class="kw">labeller</span>(<span class="dt">blooming =</span> labels))  <span class="op">+</span><span class="kw">theme</span>(<span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> (<span class="dv">10</span>)))<span class="op">+</span><span class="st"> </span><span class="kw">facet_grid</span>(<span class="op">~</span>blooming,<span class="dt">labeller=</span><span class="kw">labeller</span>(<span class="dt">blooming =</span> labels)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_manual</span>(<span class="st">&quot;&quot;</span>, <span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;shrub&quot;</span> =<span class="st">&quot;black&quot;</span>, <span class="st">&quot;open&quot;</span>=<span class="st"> &quot;white&quot;</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">stat_summary</span>(<span class="dt">fun.y=</span>mean, <span class="dt">colour=</span><span class="st">&quot;red&quot;</span>, <span class="dt">geom=</span><span class="st">&quot;point&quot;</span>, <span class="dt">shape=</span><span class="dv">18</span>, <span class="dt">size=</span><span class="dv">3</span>,<span class="dt">show_guide =</span> <span class="ot">FALSE</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">plot.margin=</span><span class="kw">unit</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="fl">0.1</span>,<span class="dv">0</span>,<span class="dv">1</span>), <span class="st">&quot;cm&quot;</span>), ,<span class="dt">axis.title.x=</span><span class="kw">element_blank</span>(),<span class="dt">axis.text.x=</span><span class="kw">element_blank</span>(),<span class="dt">axis.ticks.x=</span><span class="kw">element_blank</span>())</a>
<a class="sourceLine" id="cb679-19" title="19"></a>
<a class="sourceLine" id="cb679-20" title="20">b &lt;-<span class="st"> </span><span class="kw">ggplot</span>(visits, <span class="kw">aes</span>(treatment, understory.richness)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb679-21" title="21"><span class="st">  </span><span class="kw">stat_boxplot</span>(<span class="dt">geom =</span><span class="st">&#39;errorbar&#39;</span>, <span class="dt">width =</span> <span class="fl">0.2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_boxplot</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> treatment)) <span class="op">+</span><span class="st"> </span><span class="kw">theme_Publication</span>() <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Annual Richness&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;&quot;</span>)  <span class="op">+</span><span class="kw">theme</span>(<span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> (<span class="dv">10</span>)))<span class="op">+</span><span class="st"> </span><span class="kw">facet_grid</span>(<span class="op">~</span>flowering,<span class="dt">labeller=</span><span class="kw">labeller</span>(<span class="dt">flowering =</span> labels)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_manual</span>(<span class="st">&quot;&quot;</span>, <span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;shrub&quot;</span> =<span class="st">&quot;black&quot;</span>, <span class="st">&quot;open&quot;</span>=<span class="st"> &quot;white&quot;</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">stat_summary</span>(<span class="dt">fun.y=</span>mean, <span class="dt">colour=</span><span class="st">&quot;red&quot;</span>, <span class="dt">geom=</span><span class="st">&quot;point&quot;</span>, <span class="dt">shape=</span><span class="dv">18</span>, <span class="dt">size=</span><span class="dv">3</span>,<span class="dt">show_guide =</span> <span class="ot">FALSE</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">plot.margin=</span><span class="kw">unit</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="fl">0.1</span>), <span class="st">&quot;cm&quot;</span>),<span class="dt">axis.title.x=</span><span class="kw">element_blank</span>(),<span class="dt">axis.text.x=</span><span class="kw">element_blank</span>(),<span class="dt">axis.ticks.x=</span><span class="kw">element_blank</span>())</a>
<a class="sourceLine" id="cb679-22" title="22"></a>
<a class="sourceLine" id="cb679-23" title="23">c &lt;-<span class="st"> </span><span class="kw">ggplot</span>(metadata, <span class="kw">aes</span>(treatment, abun)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb679-24" title="24"><span class="st">  </span><span class="kw">stat_boxplot</span>(<span class="dt">geom =</span><span class="st">&#39;errorbar&#39;</span>, <span class="dt">width =</span> <span class="fl">0.2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_boxplot</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> treatment)) <span class="op">+</span><span class="st"> </span><span class="kw">theme_Publication</span>() <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Arthropod Abundance&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">facet_grid</span>(<span class="op">~</span>blooming,<span class="dt">labeller=</span><span class="kw">labeller</span>(<span class="dt">blooming =</span> labels))  <span class="op">+</span><span class="kw">theme</span>(<span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> (<span class="dv">10</span>)))<span class="op">+</span><span class="st"> </span><span class="kw">facet_grid</span>(<span class="op">~</span>blooming,<span class="dt">labeller=</span><span class="kw">labeller</span>(<span class="dt">blooming =</span> labels)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_manual</span>(<span class="st">&quot;&quot;</span>, <span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;shrub&quot;</span> =<span class="st">&quot;black&quot;</span>, <span class="st">&quot;open&quot;</span>=<span class="st"> &quot;white&quot;</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">stat_summary</span>(<span class="dt">fun.y=</span>mean, <span class="dt">colour=</span><span class="st">&quot;red&quot;</span>, <span class="dt">geom=</span><span class="st">&quot;point&quot;</span>, <span class="dt">shape=</span><span class="dv">18</span>, <span class="dt">size=</span><span class="dv">3</span>,<span class="dt">show_guide =</span> <span class="ot">FALSE</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">strip.background =</span> <span class="kw">element_blank</span>(), <span class="dt">strip.text =</span> <span class="kw">element_blank</span>()) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">plot.margin=</span><span class="kw">unit</span>(<span class="kw">c</span>(<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="st">&quot;cm&quot;</span>),<span class="dt">axis.title.x=</span><span class="kw">element_blank</span>(),<span class="dt">axis.text.x=</span><span class="kw">element_blank</span>(),<span class="dt">axis.ticks.x=</span><span class="kw">element_blank</span>())</a>
<a class="sourceLine" id="cb679-25" title="25"></a>
<a class="sourceLine" id="cb679-26" title="26"></a>
<a class="sourceLine" id="cb679-27" title="27">d &lt;-<span class="st"> </span><span class="kw">ggplot</span>(incbeetle, <span class="kw">aes</span>(treatment, Species)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb679-28" title="28"><span class="st">  </span><span class="kw">stat_boxplot</span>(<span class="dt">geom =</span><span class="st">&#39;errorbar&#39;</span>, <span class="dt">width =</span> <span class="fl">0.2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_boxplot</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> treatment)) <span class="op">+</span><span class="st"> </span><span class="kw">theme_Publication</span>() <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Arthropod Richness&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">facet_grid</span>(<span class="op">~</span>blooming,<span class="dt">labeller=</span><span class="kw">labeller</span>(<span class="dt">blooming =</span> labels))  <span class="op">+</span><span class="kw">theme</span>(<span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> (<span class="dv">10</span>)))<span class="op">+</span><span class="st"> </span><span class="kw">facet_grid</span>(<span class="op">~</span>blooming,<span class="dt">labeller=</span><span class="kw">labeller</span>(<span class="dt">blooming =</span> labels)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_manual</span>(<span class="st">&quot;&quot;</span>, <span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;shrub&quot;</span> =<span class="st">&quot;black&quot;</span>, <span class="st">&quot;open&quot;</span>=<span class="st"> &quot;white&quot;</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">stat_summary</span>(<span class="dt">fun.y=</span>mean, <span class="dt">colour=</span><span class="st">&quot;red&quot;</span>, <span class="dt">geom=</span><span class="st">&quot;point&quot;</span>, <span class="dt">shape=</span><span class="dv">18</span>, <span class="dt">size=</span><span class="dv">3</span>,<span class="dt">show_guide =</span> <span class="ot">FALSE</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">strip.background =</span> <span class="kw">element_blank</span>(), <span class="dt">strip.text =</span> <span class="kw">element_blank</span>()) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">plot.margin=</span><span class="kw">unit</span>(<span class="kw">c</span>(<span class="fl">0.1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>), <span class="st">&quot;cm&quot;</span>),<span class="dt">axis.title.x=</span><span class="kw">element_blank</span>(),<span class="dt">axis.text.x=</span><span class="kw">element_blank</span>(),<span class="dt">axis.ticks.x=</span><span class="kw">element_blank</span>())</a>
<a class="sourceLine" id="cb679-29" title="29"></a>
<a class="sourceLine" id="cb679-30" title="30"><span class="kw">library</span>(cowplot)</a>
<a class="sourceLine" id="cb679-31" title="31"><span class="kw">plot_grid</span>(a,b,c,d)</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-3-3.png" width="672" /></p>
<div class="sourceCode" id="cb680"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb680-1" title="1"><span class="kw">ggplot</span>(all.new, <span class="kw">aes</span>(<span class="dt">x=</span>metric, <span class="dt">y=</span>means)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymin=</span>V5, <span class="dt">ymax=</span>V6, <span class="dt">fill =</span> bloom), <span class="dt">width=</span>.<span class="dv">1</span>, <span class="dt">position=</span><span class="kw">position_dodge</span>(<span class="dt">width=</span><span class="fl">0.5</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> bloom),<span class="dt">position=</span><span class="kw">position_dodge</span>(<span class="dt">width=</span><span class="fl">0.5</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> bloom), <span class="dt">position=</span><span class="kw">position_dodge</span>(<span class="dt">width=</span><span class="fl">0.5</span>), <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>,<span class="dt">pch=</span><span class="dv">21</span>, <span class="dt">size=</span><span class="dv">5</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylim</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>) <span class="op">+</span><span class="st">  </span><span class="kw">theme_Publication</span>() <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text.x=</span><span class="kw">element_text</span>(<span class="dt">angle=</span><span class="dv">90</span>, <span class="dt">vjust=</span>.<span class="dv">5</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_hline</span>(<span class="kw">aes</span>(<span class="dt">yintercept=</span><span class="dv">0</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_x_discrete</span>(<span class="dt">limits=</span><span class="kw">levels</span>(all.new<span class="op">$</span>metric), <span class="dt">labels =</span> metrics)<span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_manual</span>(<span class="st">&quot;&quot;</span>,<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;lightgray&quot;</span>), <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Full bloom&quot;</span>, <span class="st">&quot;Pre-bloom&quot;</span>))  <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="kw">c</span>(<span class="fl">0.8</span>, <span class="fl">0.1</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">coord_flip</span>() <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;RII Microsite&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">size =</span><span class="dv">11</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">guides</span>(<span class="dt">fill =</span> <span class="kw">guide_legend</span>(<span class="dt">nrow =</span> <span class="dv">2</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>)) </a></code></pre></div>
<pre><code>## geom_path: Each group consists of only one observation. Do you need to
## adjust the group aesthetic?</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-3-4.png" width="672" /></p>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
